[{"path":"https://sj-cmpb-se.github.io/XploR/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2025 Meiling Jin Permission hereby granted, free charge, person obtaining copy software associated documentation files (‚ÄúSoftware‚Äù), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED ‚Äú‚Äù, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Meiling Jin. Maintainer.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Jin M (2025). XploR: Large-Scale Allele-Specific CNV Detection Using Coverage Allelic Imbalance WES data. https://sj-cmpb-se.github.io/XploR/, https://github.com/sj-cmpb-se/XploR.","code":"@Manual{,   title = {XploR: Large-Scale Allele-Specific CNV Detection Using Coverage and Allelic Imbalance in WES data},   author = {Meiling Jin},   year = {2025},   note = {https://sj-cmpb-se.github.io/XploR/, https://github.com/sj-cmpb-se/XploR}, }"},{"path":"https://sj-cmpb-se.github.io/XploR/index.html","id":"id_-project-status","dir":"","previous_headings":"","what":"üöß Project Status","title":"Large-Scale Allele-Specific CNV Detection Using Coverage and Allelic Imbalance in WES data","text":"Note: XploR actively development. features may evolve refined. greatly appreciate bug reports, feature suggestions, user feedback. Please open issue encounter problems.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/index.html","id":"contents","dir":"","previous_headings":"","what":"Contents","title":"Large-Scale Allele-Specific CNV Detection Using Coverage and Allelic Imbalance in WES data","text":"Features Installation Test Run Prepare input files Prepare reference files Algorithm Output Model selection rerun Full function parameter list","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/index.html","id":"features","dir":"","previous_headings":"","what":"Features","title":"Large-Scale Allele-Specific CNV Detection Using Coverage and Allelic Imbalance in WES data","text":"BAF coverage denoise, smoothing, binning, quality control Exome-wide copy number segmentation allelic imbalance detection Purity ploidy estimation model selection Rerun based chromosome region, purity diploid coverage Cytoband gene annotation CNV segments Visualization","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Large-Scale Allele-Specific CNV Detection Using Coverage and Allelic Imbalance in WES data","text":"Install latest version GitHub using devtools:","code":"install.packages(\"devtools\") devtools::install_github(\"sj-cmpb-se/XploR\")"},{"path":"https://sj-cmpb-se.github.io/XploR/index.html","id":"quick-test-run","dir":"","previous_headings":"","what":"Quick Test run","title":"Large-Scale Allele-Specific CNV Detection Using Coverage and Allelic Imbalance in WES data","text":"files needed test run placed inst/extdata folder. RunExamplePipeline() use files inst/exdata test run. Panel normal generation included test run. Details build panel normals please refer Prepare reference files","code":"library(XploR) RunExamplePipeline( out_dir = \"/path_to_output_dir\" )"},{"path":[]},{"path":"https://sj-cmpb-se.github.io/XploR/index.html","id":"id_1-run-segmentation-based-on-allelic-imbalance-information-the-example-used-cbs-segmentation-method","dir":"","previous_headings":"Quick Test run > Running this function is same with running the steps separately like:","what":"1. Run segmentation based on Allelic imbalance information. The example used ‚Äúcbs‚Äù segmentation method.","title":"Large-Scale Allele-Specific CNV Detection Using Coverage and Allelic Imbalance in WES data","text":"","code":"RunAIsegmentation(     seg = seg,     cov = cov,     ai = ai,     gender = gender,     out_dir = out_dir,     prefix = prefix,     ai_pon = ai_pon,     aitype = \"dragen\"   )"},{"path":"https://sj-cmpb-se.github.io/XploR/index.html","id":"parameters-for-runaisegmentation","dir":"","previous_headings":"Quick Test run > Running this function is same with running the steps separately like: > 1. Run segmentation based on Allelic imbalance information. The example used ‚Äúcbs‚Äù segmentation method.","what":"Parameters for RunAIsegmentation","title":"Large-Scale Allele-Specific CNV Detection Using Coverage and Allelic Imbalance in WES data","text":"Note aitype column requirements: - \"gatk\" \"\": input must include columns CONTIG, POSITION, ALT_COUNT, REF_COUNT, REF_NUCLEOTIDE, ALT_NUCLEOTIDE. - \"dragen\": input must include columns contig, start, stop, refAllele, allele1, allele2, allele1Count, allele2Count, allele1AF, allele2AF.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/index.html","id":"id_2-run-model-likelihood-calculation-and-selection","dir":"","previous_headings":"Quick Test run > Running this function is same with running the steps separately like:","what":"2. Run model likelihood calculation and selection.","title":"Large-Scale Allele-Specific CNV Detection Using Coverage and Allelic Imbalance in WES data","text":"","code":"RunModelLikelihood(     seg = paste0(out_dir,\"/\",prefix,\"_GATK_AI_segment.tsv\"),     out_dir = out_dir,     prefix = prefix,     gender = gender,     modelminprobes = 20,     modelminAIsize = 5000000,     minsf = 0.4,     callcov = 0.3,     thread = 6)"},{"path":"https://sj-cmpb-se.github.io/XploR/index.html","id":"parameters-for-runmodellikelihood","dir":"","previous_headings":"Quick Test run > Running this function is same with running the steps separately like: > 2. Run model likelihood calculation and selection.","what":"Parameters for RunModelLikelihood","title":"Large-Scale Allele-Specific CNV Detection Using Coverage and Allelic Imbalance in WES data","text":"Notes: - Parameters marked (Optional) can omitted defaults. - full description arguments advanced options, see function reference ?RunModelLikelihood R.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/index.html","id":"id_3-run-annotation-segments","dir":"","previous_headings":"Quick Test run > Running this function is same with running the steps separately like:","what":"3. Run annotation segments.","title":"Large-Scale Allele-Specific CNV Detection Using Coverage and Allelic Imbalance in WES data","text":"","code":"AnnotateSegments(     input = paste0(out_dir,\"/\",prefix,\"_final_calls.tsv\"),     out_dir = out_dir,     prefix = prefix,     cytoband = cytoband,     whitelist_edge = whitelist_edge,     gene = gene)"},{"path":[]},{"path":"https://sj-cmpb-se.github.io/XploR/index.html","id":"id_4-generating-cnv-plot","dir":"","previous_headings":"Quick Test run > Running this function is same with running the steps separately like:","what":"4. Generating CNV plot","title":"Large-Scale Allele-Specific CNV Detection Using Coverage and Allelic Imbalance in WES data","text":"","code":"RunPlotCNV(     seg = paste0(out_dir,\"/\",prefix,\"_CNV_annotation.tsv\"),     cr =cr,     ballele = ai,     ai_binsize = 100000,     cov_binsize = 100000,     whitelist = whitelist_bed,     gender = gender,     out_dir = out_dir,     prefix = prefix,     aitype = \"dragen\"   )"},{"path":[]},{"path":"https://sj-cmpb-se.github.io/XploR/index.html","id":"id_5-generating-ai-segment-quality-file","dir":"","previous_headings":"Quick Test run > Running this function is same with running the steps separately like:","what":"5. Generating AI segment quality file.","title":"Large-Scale Allele-Specific CNV Detection Using Coverage and Allelic Imbalance in WES data","text":"","code":"BafQC(     annofile = paste0(out_dir,\"/\",prefix,\"_CNV_annotation.tsv\"),     out_dir = out_dir,     prefix = prefix)"},{"path":[]},{"path":"https://sj-cmpb-se.github.io/XploR/index.html","id":"prepare-input-files","dir":"","previous_headings":"","what":"Prepare input files","title":"Large-Scale Allele-Specific CNV Detection Using Coverage and Allelic Imbalance in WES data","text":"Run GATK tumor-mode default parameters. summary GATK tumor-mode command used pipeline. Please see GATK website details. Files used XploR sample.counts, sample.called.seg, sample.allelic_counts sample.denoisedCR.tsv. allelic count file also generate software like DRAGEN samtools.","code":""},{"path":[]},{"path":[]},{"path":"https://sj-cmpb-se.github.io/XploR/index.html","id":"panel-of-normal-reference","dir":"","previous_headings":"Prepare Reference Files","what":"Panel of normal reference","title":"Large-Scale Allele-Specific CNV Detection Using Coverage and Allelic Imbalance in WES data","text":"Panel Normals (PON) required generated using GATK, DRAGEN, software capable producing allelic count files. Note: Male female PON files need generated separately.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/index.html","id":"a-whitelist-blacklist-and-detectable-boundary-files","dir":"","previous_headings":"Prepare Reference Files > Panel of normal reference","what":"A. Whitelist, Blacklist, and Detectable Boundary Files","title":"Large-Scale Allele-Specific CNV Detection Using Coverage and Allelic Imbalance in WES data","text":"files generated PON HD5 file (GATK), cytoband file, gender information. essential downstream processing include: Blacklist BED: Regions exclude Whitelist BED: Regions include Detectable Edge File: Defines detectable boundaries files created based GATK Panel Normals. See function documentation R: ?PonProcess help(\"PonProcess\", package = \"XploR\"). Example usage:","code":"PonProcess(   pon_file = pon_hdh5_file,   blacklist_bed = output_blacklist_bed,   whitelist_bed = output_whitelist_bed,   cytoband = cytoband,   detectable_edge = output_detectable_edge,   gender = gender )"},{"path":"https://sj-cmpb-se.github.io/XploR/index.html","id":"bpanel-of-normals-based-on-allelic-count-files","dir":"","previous_headings":"Prepare Reference Files > Panel of normal reference","what":"B.Panel of Normals Based on Allelic Count Files","title":"Large-Scale Allele-Specific CNV Detection Using Coverage and Allelic Imbalance in WES data","text":"ai_pon_file text file listing paths normal allelic count files generated GATK, DRAGEN, software. can process files generate PON reference allelic imbalance using:","code":"PONAIprocess(   ai_pon_file = ai_pon_file,   aitype = \"GATK\",   minsnpcov = 20,   output = \"/Pathtoresults\",   prefix = \"PONAI\",   maxgap = 2000000,   maxbinsize = 5000000,   minbinsize = 500000,   snpnum = 30,   gender = \"female\" )"},{"path":[]},{"path":"https://sj-cmpb-se.github.io/XploR/index.html","id":"gene-annotation-reference","dir":"","previous_headings":"Prepare Reference Files > Panel of normal reference","what":"Gene annotation reference:","title":"Large-Scale Allele-Specific CNV Detection Using Coverage and Allelic Imbalance in WES data","text":"Gene annotation can obtained various sources (e.g., Ensembl, UCSC, Gencode, RefSeq). example file included package:","code":"gene <- system.file(\"extdata\", \"RefSeqCurated.genePred.gene_region.txt\", package = \"XploR\") head(read.table(gene, header = TRUE, sep = \"\\t\"))"},{"path":"https://sj-cmpb-se.github.io/XploR/index.html","id":"cytoband-annotation-reference","dir":"","previous_headings":"Prepare Reference Files > Panel of normal reference","what":"Cytoband annotation reference:","title":"Large-Scale Allele-Specific CNV Detection Using Coverage and Allelic Imbalance in WES data","text":"Cytoband annotation files typically downloaded UCSC. example file included:","code":"cytoband <- system.file(\"extdata\", \"hg19_cytoBand.dat\", package = \"XploR\") head(read.table(cytoband, header = TRUE, sep = \"\\t\"))"},{"path":[]},{"path":"https://sj-cmpb-se.github.io/XploR/index.html","id":"binning-strategy-for-allelic-count-data","dir":"","previous_headings":"Algorithm","what":"Binning Strategy for allelic count Data","title":"Large-Scale Allele-Specific CNV Detection Using Coverage and Allelic Imbalance in WES data","text":"BinMaf function implements flexible binning strategy minor allele frequency (MAF) data, supporting tumor samples panels normal (PoN) samples. binning can performed using either fixed number SNPs per bin additional criteria handle genomic gaps bin size limits. Within bin, Gaussian mixture modeling (GMM) applied identify clusters MAF distribution. Key features: number SNPs bin reaches specified target (e.g., 20 SNPs per bin). genomic span bin exceeds maximum bin size (e.g., 2,000,000 bp). gap consecutive SNPs exceeds maximum allowed gap (e.g., 1,000,000 bp). bin size least specified minimum size (e.g., 500,000 bp). strategy ensures bins consistent size SNP content, avoiding inclusion widely separated SNPs bin, robust tumor normal samples.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/index.html","id":"segmentation-of-maf-track","dir":"","previous_headings":"Algorithm","what":"Segmentation of MAF track","title":"Large-Scale Allele-Specific CNV Detection Using Coverage and Allelic Imbalance in WES data","text":"addition CBS (Circular Binary Segmentation), pipeline supports ‚Äúmerge‚Äù mode segmentation based minor allele frequency (MAF) values. CBS default recommended strategy, ‚Äúmerge‚Äù mode offers step-wise, rule-based approach combine adjacent MAF segments. Step-wise Merging Strategy: process begins minimal SNP counts, incrementally increased reaching final SNP count defined ‚Äúsnpmin‚Äù. Remove Small Segments: Discard segments smaller current minimum SNP count. Merge Adjacent Segments: Evaluate merge adjacent segments difference segment MAF values less equal mergeai parameter (user-specified MAF difference threshold). Note: - CBS segmentation remains default generally recommended workflows. - ‚Äúmerge‚Äù mode useful certain applications rule-based, stepwise merging MAF segments preferred.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/index.html","id":"maf-bias-correction-using-panel-of-normal-pon-allelic-counts","dir":"","previous_headings":"Algorithm","what":"MAF Bias Correction Using Panel of Normal (PoN) Allelic Counts","title":"Large-Scale Allele-Specific CNV Detection Using Coverage and Allelic Imbalance in WES data","text":"address systematic MAF bias, XploR incorporates locus-specific reference built panel normal (PoN) allelic count files. tumor segment, per-SNP BAF values within segment extracted, segment overlapped PoN obtain corresponding distribution normal MAFs. combined information used evaluate whether segment behaves like balanced diploid region reflects true allelic imbalance. tumor BAF distribution assessed using mixture-model density-based framework, distinguishes single-peak, near-0.5 distributions segments showing clear deviation multiple peaks. segments classified balanced undergo correction: segment mean MAF transformed onto logit scale, centered using median MAF PoN locus, transformed back, values capped 0.5. Segments demonstrating allelic imbalance retain original MAF true biological signal preserved.","code":""},{"path":[]},{"path":"https://sj-cmpb-se.github.io/XploR/index.html","id":"estimate-a-betabinomial-over-dispersion-parameter-theta-from-a-panel-of-normals-pon","dir":"","previous_headings":"Algorithm > Purity and diploid coverage scale factor estimation","what":"Estimate a Beta‚ÄìBinomial Over-Dispersion Parameter Œ∏\\theta from a Panel of Normals (PoN)","title":"Large-Scale Allele-Specific CNV Detection Using Coverage and Allelic Imbalance in WES data","text":"accurately model -dispersion minor allele frequency (MAF) data, estimate beta-binomial dispersion parameter (Œ∏\\theta) using panel normal (PoN) samples. allows us account extra-binomial variation improves likelihood calculation segment. bin bb depth stratum: Observed variance across normals: vb=Vars(psb)   v_b = \\mathrm{Var}_s(p_{sb})  - Binomial expectation: mb=ùîºs[p0b(1‚àíp0b)Dsb]‚âàp0b(1‚àíp0b)‚ãÖmeans(1Dsb)   m_b = \\mathbb{E}_s\\left[\\frac{p_{0b}(1-p_{0b})}{D_{sb}}\\right]       \\approx p_{0b}(1-p_{0b}) \\cdot \\mathrm{mean}_s\\left(\\frac{1}{D_{sb}}\\right) Representative depth (bin, stratum): dÃÉb=medians(Dsb)   \\tilde d_b = \\mathrm{median}_s(D_{sb}) Moment estimator Œ∏\\theta per (bin, stratum): Œ∏ÃÇb=max(vb/mb‚àí1dÃÉb‚àí1,0)   \\widehat{\\theta}_{b} = \\max\\left(\\frac{v_b/m_b - 1}{\\tilde d_b - 1},\\ 0\\right) Within depth stratum, take robust center (median) Œ∏ÃÇb\\widehat{\\theta}_b obtain Œ∏\\theta stratum. : psbp_{sb}: MAFs per sample ss per bin bb p0bp_{0b}: Reference (PoN) mean MAF bin bb DsbD_{sb}: Median depth sample ss bin bb vbv_b: Observed variance MAF across samples bin bb mbm_b: Expected binomial variance bin bb dÃÉb\\tilde d_b: Representative (median) depth bin bb Œ∏ÃÇb\\widehat{\\theta}_b: Estimated -dispersion bin bb Œ∏\\theta: Final -dispersion parameter depth stratum","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/index.html","id":"prior-assignment-based-on-parsimony-principle","dir":"","previous_headings":"Algorithm > Purity and diploid coverage scale factor estimation","what":"Prior assignment based on parsimony principle","title":"Large-Scale Allele-Specific CNV Detection Using Coverage and Allelic Imbalance in WES data","text":"Priors assigned potential copy number combination based principle parsimony, favors simpler (biologically less complex) allele configurations. biological difficulty level reflects number steps required reach given allele combination baseline diploid state (1,1), step represents either gain loss one allele. Baseline State: diploid state (1,1) assigned difficulty level 1. Single-Step Changes: Combinations reachable (1,1) one step (single gain loss) assigned difficulty level 2. Two-Step Changes: Combinations requiring two steps (e.g., loss gain, two sequential gains) receive difficulty level 3. Three-, Four-, Five-Step Changes: Difficulty levels increase number steps, 6 complex. Whole Chromosome Duplication: Combinations like (2,2) assigned higher difficulty due rarity. Sequential Gains: Combinations sequential gains chromosome (e.g., (3,1)) considered less difficult involving loss followed gain (e.g., (2,0)). prior allele combination calculated using exponential decay function controlled decay rate parameter Œª. prior = exp(-Œª √ó Bio_diff) Bio_diff assigned biological difficulty score copy number configuration.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/index.html","id":"tumor-copy-number-estimation","dir":"","previous_headings":"Algorithm > Purity and diploid coverage scale factor estimation","what":"Tumor Copy Number Estimation","title":"Large-Scale Allele-Specific CNV Detection Using Coverage and Allelic Imbalance in WES data","text":"genomic segment, model computes range possible tumor-specific copy numbers (CN_tumor) result observed data different cancer cell fractions (ccf): Tumor Copy Number Formula: CNtumor=Ci√ó2/(Œº√ó100)‚àí(1‚àíœÅ)√ó2‚àíœÅ√ó(1‚àíccf)√ó2œÅ√óccf CN_{tumor} = \\frac{C_i \\times 2 / (\\mu \\times 100) - (1 - \\rho) \\times 2 - \\rho \\times (1 - ccf) \\times 2}{\\rho \\times ccf} : CiC_i: Observed segment copy number Œº\\mu: Diploid coverage scale factor œÅ\\rho: Tumor purity ccfccf: Cancer cell fraction Combination Generation: potential tumor CN, feasible major minor allele combinations generated filtered based biological plausibility. CCF Value Calculation: non-diploid segments, CCF calculated; diploid segments, set NA.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/index.html","id":"likelihood-calculation","dir":"","previous_headings":"Algorithm > Purity and diploid coverage scale factor estimation","what":"Likelihood Calculation","title":"Large-Scale Allele-Specific CNV Detection Using Coverage and Allelic Imbalance in WES data","text":"MAF Likelihood: combination, B allele frequency likelihood computed using beta distribution, parameterized Œ±\\alpha Œ≤\\beta, derived expected MAF: Beta(Œ±,Œ≤) \\mathrm{Beta}(\\alpha, \\beta) : Œ±=K√óBAF+œµ\\alpha = K \\times \\mathrm{BAF} + \\epsilon Œ≤=K√ó(1‚àíBAF)+œµ\\beta = K \\times (1 - \\mathrm{BAF}) + \\epsilon KK: Beta-binomial precision parameter, estimated segment based local read depth -dispersion parameter (see ). œµ\\epsilon: Small positive value numerical stability Estimation KK: segment, KK calculated : K=depth1+(depth‚àí1)‚ãÖŒ∏‚àí1 K = \\frac{\\text{depth}}{1 + (\\text{depth} - 1) \\cdot \\theta} - 1 : depth\\text{depth}: Median SNP depth segment Œ∏\\theta: Beta-binomial -dispersion parameter, estimated panel normals (PoN) corresponding depth stratum Posterior Likelihood: posterior likelihood combination incorporates BAF likelihood prior, weighted factor Œ≥\\gamma: Posterior Likelihood=MAF Likelihood√ó(Prior)Œ≥ \\text{Posterior Likelihood} = \\text{MAF Likelihood} \\times (\\text{Prior})^\\gamma : MAF Likelihood\\text{MAF Likelihood}: Likelihood observed minor frequency current model Prior\\text{Prior}: Prior probability assigned allele combination based biological plausibility Œ≥\\gamma: Weighting factor controlling influence prior posterior calculation","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/index.html","id":"assigning-calls-for-each-segment","dir":"","previous_headings":"Algorithm > Purity and diploid coverage scale factor estimation","what":"Assigning Calls for Each Segment","title":"Large-Scale Allele-Specific CNV Detection Using Coverage and Allelic Imbalance in WES data","text":"SelectCallpersegment() function refines selects likely allele combinations genomic segment, handling clonal subclonal events, incorporates coverage differences prior knowledge. Replace zero BAF likelihoods minimum likelihood value ensure terms contribute meaningfully. Compute expected coverage model difference (cov_diff) observed coverage. segment, identify top two models highest MAF likelihoods. subclonal event likely (e.g., second-ranked model ccf > 0.3 comparable likelihood), select subclonal event. major minor copy numbers equal, selection based cov_diff. segments minor = 0, MAF likelihood unreliable, select model smallest cov_diff. Ensure consistency selection minor = 0 minor ‚â† 0 cases. Calculate store log-transformed likelihood value (log_MAF_likelihood) selected model.","code":""},{"path":[]},{"path":"https://sj-cmpb-se.github.io/XploR/index.html","id":"segmentation-output","dir":"","previous_headings":"Output","what":"Segmentation output","title":"Large-Scale Allele-Specific CNV Detection Using Coverage and Allelic Imbalance in WES data","text":"sample_GATK_AI_segment.tsv ( Generared ?RunAIsegmentation function)","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/index.html","id":"raw-likelihood-results-under-each-configuration","dir":"","previous_headings":"Output","what":"Raw likelihood results under each configuration","title":"Large-Scale Allele-Specific CNV Detection Using Coverage and Allelic Imbalance in WES data","text":"sample_likelihood_raw.tsv (Generated ?RunModelLikelihood() function)","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/index.html","id":"allelic-combiantion-ressult-with-maximum-likelihood-under-each-configuration","dir":"","previous_headings":"Output","what":"Allelic combiantion ressult with maximum likelihood under each configuration","title":"Large-Scale Allele-Specific CNV Detection Using Coverage and Allelic Imbalance in WES data","text":"sample_top_likelihood_calls.tsv ( Generated ?SelectCallpersegment() function ) format simillar sample_likelihood_raw.tsv, best allelic combiantion selected segment diploid coverage scale factor tumor purity configuration.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/index.html","id":"likelihood-for-each-combination-of-diploid-coverage-scale-factor-and-tumor-purity","dir":"","previous_headings":"Output","what":"Likelihood for each combination of diploid coverage scale factor and tumor purity","title":"Large-Scale Allele-Specific CNV Detection Using Coverage and Allelic Imbalance in WES data","text":"sample_Models_likelihood.tsv ( Generated ?SelectFinalModel() function )","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/index.html","id":"final-output-of-cnv-calling","dir":"","previous_headings":"Output","what":"Final output of CNV calling","title":"Large-Scale Allele-Specific CNV Detection Using Coverage and Allelic Imbalance in WES data","text":"sample_final_calls.tsv (Generated ?RunModelLikelihood() function)","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/index.html","id":"model-selection-plots","dir":"","previous_headings":"Output","what":"Model selection plots","title":"Large-Scale Allele-Specific CNV Detection Using Coverage and Allelic Imbalance in WES data","text":"Likelihood dot plot:  plot displays likelihood ranking combinations diploid coverage scale factor tumor purity. vertical dashed line indicates likelihood cutoff used define Tier 1 models. Model plot:  model plot displays likelihood values different models, calculated based potential combinations diploid coverage scale factor tumor purity. plot, red indicates higher likelihood, blue signifies lower likelihood. light blue dot indicates final model selected XploR. Tier1 Models Overall:  plot shows copy number calls combination diploid coverage scale factor tumor purity. Red indicates gain, blue indicates loss, white indicates change. configuration labeled y-axis. evaluating coverage allelic imbalance patterns overview, can identify reasonable range diploid coverage scale factors tumor purity values. helps guide reruns optimized parameter ranges needed. Tier1 Models Zoom :  zoomed-view makes y-axis configurations visible detailed inspection.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/index.html","id":"qc-summary-table","dir":"","previous_headings":"Output","what":"QC Summary Table","title":"Large-Scale Allele-Specific CNV Detection Using Coverage and Allelic Imbalance in WES data","text":"sample_PASS_STAT_chr.txt ( Generated ?BafQC() function )","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/index.html","id":"annotation-file","dir":"","previous_headings":"Output","what":"Annotation file","title":"Large-Scale Allele-Specific CNV Detection Using Coverage and Allelic Imbalance in WES data","text":"sample_CNV_annotation.tsv ( Generated ?AnnotateSegments() function, unique columns listed ). ISCN calculation rules: 1. segments reported start end cytoband ISCN format. however certain considerations made position centromere: . metacentric chromosomes, segment crosses centromere gaps segment telomere sides less 5MB, chromosome number reported. b. metacentric chromosomes, segment cross centromere, gaps segment centromere telomere less 5MB, chromosome number followed ‚Äòp‚Äô ‚Äòq‚Äô reported. c.¬†acrocentric chromosomes, segment fulfills rule ‚Äòb‚Äô , chromosome number reported.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/index.html","id":"cnv-plot","dir":"","previous_headings":"Output","what":"CNV plot","title":"Large-Scale Allele-Specific CNV Detection Using Coverage and Allelic Imbalance in WES data","text":"sample_CNV_plot.png ( Generated ?RunPlotCNV() function).  CNV Plot shows genome-wide summary copy number (top track), B-allele frequency (BAF, second track) data, tumor fraction( ccf, third tract ) quality segment ( bottom track). Copy Number (CN), Y-axis, linear count number copies chromosome tumor cells, taking tumor purity tumor fraction account. chromosome plotted set dots collectively show estimated sequence coverage chromosome, narrow turquoise line shows final CN call chromosome. BAF plot shows variant allele fraction SNPs across genome coloration used Copy Number plot. copy number chromosome changes, BAF plot affected chromosome splits due imbalance chromosome counts. variance B-allele frequencies quite high splitting BAF may difficult discern. assist interpreting BAF plot, turquoise line drawn median level show imbalance.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/index.html","id":"model-selection-and-rerun","dir":"","previous_headings":"","what":"Model selection and rerun","title":"Large-Scale Allele-Specific CNV Detection Using Coverage and Allelic Imbalance in WES data","text":"XploR allows users rerun copy number variant (CNV) calling custom purity scale factor (size factor) ranges, specifying diploid region normalization. function supports ‚Äúmodel‚Äù ‚Äúregion‚Äù rerun modes outputs refined CNV calls. diploid coverage region can specified using three parameters: chromosome, start, end. chromosome provided, entire chromosome used. chromosome start provided, region start end chromosome considered. chromosome end provided, region start chromosome end used. three parameters specified, defined region start end selected chromosome used.","code":"# Rerun using specific purity and scale factor ranges RerunCNV(   seg = \"results/Sample1_GATK_AI_segment.tsv\",   input = \"results/Sample1_top_likelihood_calls.tsv\",   models = \"results/Sample1_Models_likelihood.tsv\",   call = \"results/Sample1_final_call.tsv\",   gender = \"female\",   dicovsf = \"0.95:1.05\",   purity = \"0.6:0.8\",   mode = \"model\",   out_file = \"results/Sample1_final_call_refined.tsv\" )  # Rerun using a user-defined diploid region RerunCNV(   seg = \"results/Sample1_GATK_AI_segment.tsv\",   input = \"results/Sample1_top_likelihood_calls.tsv\",   models = \"results/Sample1_Models_likelihood.tsv\",   call = \"results/Sample1_final_call.tsv\",   gender = \"male\",   chromosome = \"3\",   start = 1000000,   end = 50000000,   mode = \"region\",   out_file = \"results/Sample1_final_call_refined.tsv\" )"},{"path":"https://sj-cmpb-se.github.io/XploR/index.html","id":"parameters-for-reruncnv","dir":"","previous_headings":"Model selection and rerun","what":"Parameters for RerunCNV","title":"Large-Scale Allele-Specific CNV Detection Using Coverage and Allelic Imbalance in WES data","text":"Note: rerunning, resulting file can used downstream steps‚Äîplotting annotation‚Äîjust like files generated prior rerun.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/index.html","id":"full-function-and-parameter-list","dir":"","previous_headings":"","what":"Full function and parameter list","title":"Large-Scale Allele-Specific CNV Detection Using Coverage and Allelic Imbalance in WES data","text":"complete list functions parameters, please visit XploR function reference. function page includes detailed parameter descriptions, usage examples, links related documentation.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/AIbinSmooth.html","id":null,"dir":"Reference","previous_headings":"","what":"Smooth AI Bin Values by Downsampling ‚Äî AIbinSmooth","title":"Smooth AI Bin Values by Downsampling ‚Äî AIbinSmooth","text":"length input vector greater 30, returns vector 30 values sampled according observed frequency unique value. Otherwise, returns vector unchanged.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/AIbinSmooth.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Smooth AI Bin Values by Downsampling ‚Äî AIbinSmooth","text":"","code":"AIbinSmooth(baf)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/AIbinSmooth.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Smooth AI Bin Values by Downsampling ‚Äî AIbinSmooth","text":"baf Numeric character vector. Typically vector rounded AI (e.g., BAF) values.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/AIbinSmooth.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Smooth AI Bin Values by Downsampling ‚Äî AIbinSmooth","text":"numeric vector, either unchanged (length <= 30) length <= 30, values sampled according observed frequencies.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/AIbinSmooth.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Smooth AI Bin Values by Downsampling ‚Äî AIbinSmooth","text":"","code":"set.seed(1) x <- sample(c(0.1, 0.2, 0.3, 0.4), 100, replace = TRUE) AIbinSmooth(baf = x) #>  [1] 0.2 0.2 0.2 0.2 0.2 0.2 0.2 0.2 0.2 0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.3 0.3 #> [20] 0.3 0.3 0.3 0.3 0.3 0.4 0.4 0.4 0.4 0.4 0.4"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/AddQualTag.html","id":null,"dir":"Reference","previous_headings":"","what":"Assign Quality Tag to a Segment Based on maf GMM Metrics ‚Äî AddQualTag","title":"Assign Quality Tag to a Segment Based on maf GMM Metrics ‚Äî AddQualTag","text":"Assigns quality tag (\"PASS\" \"FAILED\") segment based maf GMM weight probe count thresholds.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/AddQualTag.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Assign Quality Tag to a Segment Based on maf GMM Metrics ‚Äî AddQualTag","text":"","code":"AddQualTag(Chromosome, MAF_gmm_weight, MAF_Probes, MAF_gmm_G, snpmin)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/AddQualTag.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Assign Quality Tag to a Segment Based on maf GMM Metrics ‚Äî AddQualTag","text":"Chromosome Character. MAF_gmm_weight Numeric. mixture weight prominent maf GMM cluster. MAF_Probes Integer. number nonzero maf probes segment. MAF_gmm_G Integer. Number maf GMM clusters. snpmin Integer. minimum nonzero SNP count.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/AddQualTag.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Assign Quality Tag to a Segment Based on maf GMM Metrics ‚Äî AddQualTag","text":"Character. \"PASS\" segment passes quality checks, \"FAILED\" otherwise.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/AddQualTag.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Assign Quality Tag to a Segment Based on maf GMM Metrics ‚Äî AddQualTag","text":"segment marked \"PASS\" maf GMM weight least 0.35 probe count least twice minimum SNP count (snpmin). Otherwise, marked \"FAILED\".","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/AddQualTag.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Assign Quality Tag to a Segment Based on maf GMM Metrics ‚Äî AddQualTag","text":"","code":"AddQualTag(Chromosome = \"1\", MAF_gmm_weight = 0.4, MAF_Probes = 20, MAF_gmm_G = 2, snpmin = 7) #> [1] \"PASS\" AddQualTag(Chromosome = \"X\", MAF_gmm_weight = 0.2, MAF_Probes = 10, MAF_gmm_G = 1, snpmin = 7) #> [1] \"Exclude\""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/AnnotateGene.html","id":null,"dir":"Reference","previous_headings":"","what":"Annotate Segments with Overlapping Genes ‚Äî AnnotateGene","title":"Annotate Segments with Overlapping Genes ‚Äî AnnotateGene","text":"segment, identifies overlapping genes adds gene names number overlapping genes segment data.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/AnnotateGene.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Annotate Segments with Overlapping Genes ‚Äî AnnotateGene","text":"","code":"AnnotateGene(gene, segment)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/AnnotateGene.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Annotate Segments with Overlapping Genes ‚Äî AnnotateGene","text":"gene Character. Path gene annotation file (tab-delimited, columns: chrom, loc.start, loc.end, Gene). segment Data frame. Segment data columns chrom, loc.start, loc.end.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/AnnotateGene.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Annotate Segments with Overlapping Genes ‚Äî AnnotateGene","text":"data frame original segment columns plus Gene (comma-separated gene names) Gene_count.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/AnnotateGene.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Annotate Segments with Overlapping Genes ‚Äî AnnotateGene","text":"","code":"# segment <- data.frame(chrom = \"1\", loc.start = 1000, loc.end = 2000) # AnnotateGene(\"genes.txt\", segment)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/AnnotateSegments.html","id":null,"dir":"Reference","previous_headings":"","what":"Annotate CNV Segments with Cytoband and Gene Information ‚Äî AnnotateSegments","title":"Annotate CNV Segments with Cytoband and Gene Information ‚Äî AnnotateSegments","text":"Annotates CNV segments cytoband gene overlap information.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/AnnotateSegments.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Annotate CNV Segments with Cytoband and Gene Information ‚Äî AnnotateSegments","text":"","code":"AnnotateSegments(input, out_dir, prefix, cytoband, whitelist_edge, gene)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/AnnotateSegments.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Annotate CNV Segments with Cytoband and Gene Information ‚Äî AnnotateSegments","text":"input Path merged segment file (TSV). out_dir Output directory. prefix Output file prefix. cytoband Path cytoband annotation file (TSV). whitelist_edge Path detectable edge file cytoband annotation. gene Path gene annotation file.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/AnnotateSegments.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Annotate CNV Segments with Cytoband and Gene Information ‚Äî AnnotateSegments","text":"Invisibly returns annotated data frame cytoband gene annotation columns.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/AnnotateSegments.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Annotate CNV Segments with Cytoband and Gene Information ‚Äî AnnotateSegments","text":"segment, function calculates gaps segment boundaries detectable p q arm region start/end sites (using cytoband whitelist edge files). acrocentric chromosomes, q arm boundaries considered. Based size gaps, function determines event type returns: cytoband range (combination start stop cytoband), p-arm q-arm event, , event spans whole chromosome, just chromosome name (chromosome-level event). Gene overlap information also added segment.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/AnnotateSegments.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Annotate CNV Segments with Cytoband and Gene Information ‚Äî AnnotateSegments","text":"","code":"AnnotateSegments(   input = \"sample_CNV_final.tsv\",   out_dir = \"results/\",   prefix = \"Sample1\",   cytoband = \"data/cytoBand.txt\",   whitelist_edge = \"data/whitelist.txt\",   gene = \"data/gene_anno.txt\" ) #> Warning: cannot open file 'data/whitelist.txt': No such file or directory #> Error in file(file, \"rt\"): cannot open the connection"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/AssignPriors.html","id":null,"dir":"Reference","previous_headings":"","what":"Assign Priors to Major/Minor Allele Combinations Based on Biological Difficulty ‚Äî AssignPriors","title":"Assign Priors to Major/Minor Allele Combinations Based on Biological Difficulty ‚Äî AssignPriors","text":"Assigns prior probabilities major/minor allele combinations using exponential decay model incorporates biological plausibility.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/AssignPriors.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Assign Priors to Major/Minor Allele Combinations Based on Biological Difficulty ‚Äî AssignPriors","text":"","code":"AssignPriors(combinations, lambda)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/AssignPriors.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Assign Priors to Major/Minor Allele Combinations Based on Biological Difficulty ‚Äî AssignPriors","text":"combinations Data frame. Output GenerateCombinations(), columns major, minor, CN. lambda Numeric. Decay rate parameter exponential prior.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/AssignPriors.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Assign Priors to Major/Minor Allele Combinations Based on Biological Difficulty ‚Äî AssignPriors","text":"data frame input columns plus: Bio\\_diff Assigned biological difficulty score prior Normalized prior probability combination","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/AssignPriors.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Assign Priors to Major/Minor Allele Combinations Based on Biological Difficulty ‚Äî AssignPriors","text":"function assigns biological difficulty score combination. unlisted combinations, score set according rules based CN, major, minor. prior calculated \\(\\exp(-\\lambda \\times \\text{Bio\\_diff})\\) normalized sum 1.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/AssignPriors.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Assign Priors to Major/Minor Allele Combinations Based on Biological Difficulty ‚Äî AssignPriors","text":"","code":"combos <- GenerateCombinations(3) AssignPriors(combos, lambda = 0.5) #> # A tibble: 2 √ó 5 #>   major minor    CN Bio_diff prior #>   <dbl> <dbl> <int>    <dbl> <dbl> #> 1     3     0     3        4 0.269 #> 2     2     1     3        2 0.731"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/BafQC.html","id":null,"dir":"Reference","previous_headings":"","what":"Summarise BAF QC from CNV Segment Annotation ‚Äî BafQC","title":"Summarise BAF QC from CNV Segment Annotation ‚Äî BafQC","text":"Summarises number size \"PASS\" segments per chromosome CNV annotation file.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/BafQC.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summarise BAF QC from CNV Segment Annotation ‚Äî BafQC","text":"","code":"BafQC(annofile, out_dir, prefix)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/BafQC.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Summarise BAF QC from CNV Segment Annotation ‚Äî BafQC","text":"annofile Path CNV annotation file (e.g., *_CNV_annotation.tsv). out_dir Path QC output file. prefix Prefix QC output file.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/BafQC.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Summarise BAF QC from CNV Segment Annotation ‚Äî BafQC","text":"Invisibly returns summary data frame.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/BinMaf.html","id":null,"dir":"Reference","previous_headings":"","what":"Bin MAF Data and Estimate MAF Metrics per Bin ‚Äî BinMaf","title":"Bin MAF Data and Estimate MAF Metrics per Bin ‚Äî BinMaf","text":"Bins input MAF data fixed-size windows fixed-snp-count window calculates summary metrics (e.g., estimated MAF, nonzero counts) bin.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/BinMaf.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Bin MAF Data and Estimate MAF Metrics per Bin ‚Äî BinMaf","text":"","code":"BinMaf(   data,   datatype,   maxgap = 2e+06,   snpnum = 20,   maxbinsize = 1e+06,   minbinsize = 5e+05,   minsnpcov = 20 )"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/BinMaf.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Bin MAF Data and Estimate MAF Metrics per Bin ‚Äî BinMaf","text":"data data frame tibble containing least Chromosome, Pos, Start, End maf columns. datatype individual tumor data choose \"tumor\", aggregated panel normal samples choose \"pon\". maxgap Maximum gap size inside bin. exceed start another bin.( default: 2000000) snpnum SNP number bin.( default: 20 ) maxbinsize Maximum bin size.( default: 1000000 ) minbinsize Minimum bin size.( default: 500000 ) minsnpcov Minimum coverage SNP sites included. ( default: 20 )","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/BinMaf.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Bin MAF Data and Estimate MAF Metrics per Bin ‚Äî BinMaf","text":"tibble one row per bin columns: Chromosome Chromosome identifier. bin Bin start coordinate. Start Minimum End value bin. End Maximum End value bin. nonzero_count Number nonzero maf values bin. each_maf Semicolon-separated string nonzero maf values bin. gmm_mean, gmm_weight, gmm_G Unnested maf BAF metrics.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CRCorrectPurity.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate CNF based on purity and diploid coverage size factor ‚Äî CRCorrectPurity","title":"Calculate CNF based on purity and diploid coverage size factor ‚Äî CRCorrectPurity","text":"Adjusts log2 copy ratio computes copy number fraction (CNF) region, given sample purity scale factor.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CRCorrectPurity.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate CNF based on purity and diploid coverage size factor ‚Äî CRCorrectPurity","text":"","code":"CRCorrectPurity(cr, gender, purity, sf)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CRCorrectPurity.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate CNF based on purity and diploid coverage size factor ‚Äî CRCorrectPurity","text":"cr Data frame tibble. Coverage data, must include columns CONTIG LOG2_COPY_RATIO. gender Character. Sample gender (\"male\" \"female\"). purity Numeric. Tumor purity (fraction 0 1). sf Numeric. Scale factor diploid coverage.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CRCorrectPurity.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate CNF based on purity and diploid coverage size factor ‚Äî CRCorrectPurity","text":"coverage data frame tibble additional columns Segcov, updated LOG2_COPY_RATIO, CNF.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CRCorrectPurity.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Calculate CNF based on purity and diploid coverage size factor ‚Äî CRCorrectPurity","text":"Adjusts log2 copy ratio using scale factor. Calculates CNF based purity scale factor.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CRCorrectPurity.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Calculate CNF based on purity and diploid coverage size factor ‚Äî CRCorrectPurity","text":"","code":"# CRCorrectPurity(cr, gender = \"female\", purity = 0.7, sf = 1)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CalMedian.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate Median Coverage for a Genomic Region ‚Äî CalMedian","title":"Calculate Median Coverage for a Genomic Region ‚Äî CalMedian","text":"Calculate Median Coverage Genomic Region","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CalMedian.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate Median Coverage for a Genomic Region ‚Äî CalMedian","text":"","code":"CalMedian(chrom, start, end, cov)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CalMedian.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate Median Coverage for a Genomic Region ‚Äî CalMedian","text":"chrom Chromosome name (character) start Start position (numeric) end End position (numeric) cov Data frame recording coverage columns CONTIG, START, END, COUNT","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CalMedian.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate Median Coverage for a Genomic Region ‚Äî CalMedian","text":"Median coverage (numeric)","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CalSM.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate Segment Mean Adjusted by Scale Factor ‚Äî CalSM","title":"Calculate Segment Mean Adjusted by Scale Factor ‚Äî CalSM","text":"Calculate Segment Mean Adjusted Scale Factor","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CalSM.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate Segment Mean Adjusted by Scale Factor ‚Äî CalSM","text":"","code":"CalSM(Segcov, max_L_mu, gender, Chromosome)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CalSM.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate Segment Mean Adjusted by Scale Factor ‚Äî CalSM","text":"Segcov Numeric. observed segment coverage. max_L_mu Numeric. scale factor (mu). gender Character. \"male\" \"female\". Chromosome Character. Chromosome name (e.g., \"1\", \"X\", \"Y\").","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CalSM.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate Segment Mean Adjusted by Scale Factor ‚Äî CalSM","text":"Numeric. adjusted segment mean (log2 ratio).","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CalSM.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Calculate Segment Mean Adjusted by Scale Factor ‚Äî CalSM","text":"","code":"CalSM(Segcov = 150, max_L_mu = 1, gender = \"female\", Chromosome = \"1\") #> [1] 0.5849625"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CalSegmentLikelihood.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate Marginal Likelihood for a Single Segment ‚Äî CalSegmentLikelihood","title":"Calculate Marginal Likelihood for a Single Segment ‚Äî CalSegmentLikelihood","text":"Computes marginal likelihood segment given copy number, MAF, purity, model parameters.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CalSegmentLikelihood.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate Marginal Likelihood for a Single Segment ‚Äî CalSegmentLikelihood","text":"","code":"CalSegmentLikelihood(C_i, B_i, mu, rho, sigma_C, k, lambda, gamma, epsilon)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CalSegmentLikelihood.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate Marginal Likelihood for a Single Segment ‚Äî CalSegmentLikelihood","text":"C_i Numeric. Integer copy number segment. B_i Numeric. Observed B-allele frequency (MAF) segment. mu Numeric. Diploid coverage scale factor (e.g. value 1 indicates segment mean GATK require adjustment. Additionally, pseudo-diploid coverage set 100.). rho Numeric. Tumor purity (fraction 0 1). sigma_C Numeric. directly used function, included compatibility. k Numeric. Beta distribution concentration parameter. lambda Numeric. Exponential decay parameter prior. gamma Numeric. Weight prior likelihood calculation. epsilon Numeric. Small value avoid log(0) zero parameters beta.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CalSegmentLikelihood.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate Marginal Likelihood for a Single Segment ‚Äî CalSegmentLikelihood","text":"data frame columns: major, minor, CN, ccf, Bio_diff, prior, expected_MAF, MAF_ll, weighted_prior, exp_MAF_ll, exp_prior, MAF_likelihood, Segcov, MAF, mu, rho.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CalSegmentLikelihood.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Calculate Marginal Likelihood for a Single Segment ‚Äî CalSegmentLikelihood","text":"returned data frame contains following columns: major: Major allele count minor: Minor allele count CN: Total copy number ccf: Cancer cell fraction Bio_diff: Biological difference prior: Prior probability expected_MAF: Expected MAF MAF_ll: MAF log-likelihood weighted_prior: Weighted prior exp_MAF_ll: Expected MAF log-likelihood exp_prior: Expected prior MAF_likelihood: MAF likelihood Segcov: Segment coverage MAF: Observed MAF mu: Mutation multiplicity rho: Tumor purity","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CalbaselineCov.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate Baseline Coverage ‚Äî CalbaselineCov","title":"Calculate Baseline Coverage ‚Äî CalbaselineCov","text":"Calculate Baseline Coverage","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CalbaselineCov.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate Baseline Coverage ‚Äî CalbaselineCov","text":"","code":"CalbaselineCov(chrom, cr, count)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CalbaselineCov.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate Baseline Coverage ‚Äî CalbaselineCov","text":"chrom Chromosome cr Segment mean count Coverage count","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CalbaselineCov.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate Baseline Coverage ‚Äî CalbaselineCov","text":"Baseline coverage (numeric)","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/Calccf.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate Cancer Cell Fraction (CCF) ‚Äî Calccf","title":"Calculate Cancer Cell Fraction (CCF) ‚Äî Calccf","text":"Computes cancer cell fraction (CCF) based total copy number, mutation multiplicity, tumor purity, integer copy number.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/Calccf.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate Cancer Cell Fraction (CCF) ‚Äî Calccf","text":"","code":"Calccf(CN, mu, rho, C_i)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/Calccf.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate Cancer Cell Fraction (CCF) ‚Äî Calccf","text":"CN Numeric. total copy number segment. mu Numeric. Diploid coverage scale factor (e.g. value 1 indicates segment mean GATK require adjustment. Additionally, pseudo-diploid coverage set 100.). rho Numeric. Tumor purity (fraction 0 1). C_i Numeric. Integer copy number mutation.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/Calccf.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate Cancer Cell Fraction (CCF) ‚Äî Calccf","text":"Numeric. estimated cancer cell fraction (CCF), Inf -Inf values capped 1 0.01, respectively.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/Calccf.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Calculate Cancer Cell Fraction (CCF) ‚Äî Calccf","text":"formula : ccf = ((C_i * 2 / (mu * 100)) - ((1 - rho) * 2) - (rho * 2)) / (rho * (CN - 2))  CCF -Inf, returns 0.01; Inf, returns 1; otherwise returns computed value.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/Calccf.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Calculate Cancer Cell Fraction (CCF) ‚Äî Calccf","text":"","code":"Calccf(CN = 4, mu = 100, rho = 0.6, C_i = 2) #> [1] -1.666333"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CalculateGaps.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate Gaps Between Segment and Cytoband-Defined Chromosome Landmarks ‚Äî CalculateGaps","title":"Calculate Gaps Between Segment and Cytoband-Defined Chromosome Landmarks ‚Äî CalculateGaps","text":"Calculates distances (gaps) segment's start end positions defined start end sites p q arms chromosome. acrocentric chromosomes, q arm start end sites considered.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CalculateGaps.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate Gaps Between Segment and Cytoband-Defined Chromosome Landmarks ‚Äî CalculateGaps","text":"","code":"CalculateGaps(   Chrom,   Start,   End,   p_chromStart,   p_chromEnd,   q_chromStart,   q_chromEnd )"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CalculateGaps.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate Gaps Between Segment and Cytoband-Defined Chromosome Landmarks ‚Äî CalculateGaps","text":"Chrom Character. Chromosome name (e.g., \"1\", \"X\"). Start Numeric. Segment start position (base pair). End Numeric. Segment end position (base pair). p_chromStart Numeric. Start position p arm detectable region. p_chromEnd Numeric. End position p arm detectable region. q_chromStart Numeric. Start position q arm detectable region. q_chromEnd Numeric. End position q arm detectable region.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CalculateGaps.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate Gaps Between Segment and Cytoband-Defined Chromosome Landmarks ‚Äî CalculateGaps","text":"named list elements: p_gap_to_tel Gap segment start p arm telomere (NA). p_gap_to_cen Gap segment end p arm centromere (NA). q_gap_to_tel Gap segment end q arm telomere (NA). q_gap_to_cen Gap segment start q arm centromere (NA).","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CalculateGaps.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Calculate Gaps Between Segment and Cytoband-Defined Chromosome Landmarks ‚Äî CalculateGaps","text":"acrocentric chromosomes, p arm calculations omitted q arm start/end sites considered.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CalculateGaps.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Calculate Gaps Between Segment and Cytoband-Defined Chromosome Landmarks ‚Äî CalculateGaps","text":"","code":"# CalculateGaps(\"1\", 10000, 50000, 0, 25000, 25001, 100000)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CallMerge.html","id":null,"dir":"Reference","previous_headings":"","what":"Merge Segments or AI Rows by Chromosome ‚Äî CallMerge","title":"Merge Segments or AI Rows by Chromosome ‚Äî CallMerge","text":"function splits input data chromosome merges segments AI rows within chromosome using either MergeAIRow MergeSegRow.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CallMerge.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Merge Segments or AI Rows by Chromosome ‚Äî CallMerge","text":"","code":"CallMerge(data, AIorSeg, tmp_maf, snpmin, mergeai, mergecov)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CallMerge.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Merge Segments or AI Rows by Chromosome ‚Äî CallMerge","text":"data data frame tibble containing segment AI information. Must include Chromosome column. AIorSeg Character string, either \"AI\" merge AI rows \"Seg\" merge segments. tmp_maf data frame use MergeAIRow. used AIorSeg == \"Seg\". snpmin Numeric. Minimum SNP count required segment considered separate segment. mergeai Numeric. Threshold difference MAF (gmm_mean) adjacent segments allow merging. merge_cov Numeric. Threshold difference segment mean (gmm_mean) adjacent segments allow merging.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CallMerge.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Merge Segments or AI Rows by Chromosome ‚Äî CallMerge","text":"data frame tibble merged segments AI rows chromosome.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CallMerge.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Merge Segments or AI Rows by Chromosome ‚Äî CallMerge","text":"Uses MergeAIRow AIorSeg == \"AI\", otherwise MergeSegRow.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CallWTModel.html","id":null,"dir":"Reference","previous_headings":"","what":"Assign Copy Number Call With Model (Major/Minor) ‚Äî CallWTModel","title":"Assign Copy Number Call With Model (Major/Minor) ‚Äî CallWTModel","text":"Assign Copy Number Call Model (Major/Minor)","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CallWTModel.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Assign Copy Number Call With Model (Major/Minor) ‚Äî CallWTModel","text":"","code":"CallWTModel(minor, major, CNF_correct, Chromosome, gender)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CallWTModel.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Assign Copy Number Call With Model (Major/Minor) ‚Äî CallWTModel","text":"minor Integer. Minor allele copy number. major Integer. Major allele copy number. CNF_correct Numeric. Corrected CNF. Chromosome Character. Chromosome name. gender Character. \"male\" \"female\".","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CallWTModel.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Assign Copy Number Call With Model (Major/Minor) ‚Äî CallWTModel","text":"Character. Copy number call: \"GAIN\", \"LOSS\", \"REF\", \"GAINLOH\", \"CNLOH\".","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/Callikelihood.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate Likelihood for Each \\(\\mu\\) and \\(\\rho\\) Combination ‚Äî Callikelihood","title":"Calculate Likelihood for Each \\(\\mu\\) and \\(\\rho\\) Combination ‚Äî Callikelihood","text":"segment data, computes MAF likelihood across major/minor allele combinations given mutation multiplicity (\\(\\mu\\)) tumor purity (\\(\\rho\\)).","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/Callikelihood.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate Likelihood for Each \\(\\mu\\) and \\(\\rho\\) Combination ‚Äî Callikelihood","text":"","code":"Callikelihood(mu, rho, data, sigma_C, lambda, gamma, epsilon)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/Callikelihood.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate Likelihood for Each \\(\\mu\\) and \\(\\rho\\) Combination ‚Äî Callikelihood","text":"mu Numeric. Diploid coverage scale factor (e.g. value 1 indicates segment mean GATK require adjustment. Additionally, pseudo-diploid coverage set 100.). rho Numeric. Tumor purity (fraction 0 1). data Data frame tibble. Must include columns: Segcov, MAF, index, Tag, k. sigma_C Numeric. Parameter segment likelihood (passed CalSegmentLikelihood). lambda Numeric. Exponential decay parameter prior. gamma Numeric. Weight prior likelihood calculation. epsilon Numeric. Small value avoid log(0) zero parameters beta.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/Callikelihood.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate Likelihood for Each \\(\\mu\\) and \\(\\rho\\) Combination ‚Äî Callikelihood","text":"data frame segment likelihoods columns CalSegmentLikelihood, plus index Tag.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/Callikelihood.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Calculate Likelihood for Each \\(\\mu\\) and \\(\\rho\\) Combination ‚Äî Callikelihood","text":"segment, calls CalSegmentLikelihood filters combinations ccf > 1.2. one combination major minor zero, sets MAF_likelihood 1.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CallwoModel.html","id":null,"dir":"Reference","previous_headings":"","what":"Assign Copy Number Call Without Model ‚Äî CallwoModel","title":"Assign Copy Number Call Without Model ‚Äî CallwoModel","text":"Assigns copy number call (\"GAIN\", \"LOSS\", \"REF\", \"GAINLOH\", \"CNLOH\") segment based corrected copy number fraction (CNF), minor allele frequency (MAF), probe characteristics, using user-defined thresholds.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CallwoModel.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Assign Copy Number Call Without Model ‚Äî CallwoModel","text":"","code":"CallwoModel(   chromosome,   CNF_correct,   MAF_correct,   MAF_gmm_G,   MAF_Probes,   MAF_gmm_weight,   callcovcutoff = 0.3,   callaicutoff = 0.3,   minsnpcallaicutoff = 10,   gender )"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CallwoModel.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Assign Copy Number Call Without Model ‚Äî CallwoModel","text":"chromosome Character. Chromosome name (e.g., \"1\", \"X\", \"Y\"). CNF_correct Numeric. Corrected copy number fraction (CNF). MAF_correct Numeric. Corrected minor allele frequency (MAF). MAF_gmm_G Integer. Number GMM clusters (directly used logic, included compatibility). MAF_Probes Integer. Number probes used MAF estimation. MAF_gmm_weight Numeric. GMM weight (directly used logic, included compatibility). callcovcutoff Numeric. Threshold CNF call gain loss (default: 0.3). callaicutoff Numeric. Threshold MAF call gain loss heterozygosity (GAINLOH) (default: 0.3). minsnpcallaicutoff Integer. Minimum number SNP probes call CNLOH (default: 10). gender Character. Gender information \"male\" \"female\".","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CallwoModel.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Assign Copy Number Call Without Model ‚Äî CallwoModel","text":"Character. Copy number call: one \"GAIN\", \"LOSS\", \"REF\", \"GAINLOH\", \"CNLOH\".","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CallwoModel.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Assign Copy Number Call Without Model ‚Äî CallwoModel","text":"Calls made according CNF MAF thresholds: sex chromosomes males, thresholds adjusted haploid status. \"GAINLOH\" called CNF high MAF dynamic cutoff. \"CNLOH\" called MAF low probe count meets minimum threshold.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CallwoModel.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Assign Copy Number Call Without Model ‚Äî CallwoModel","text":"","code":"CallwoModel(\"1\", CNF_correct = 2.8, MAF_correct = 0.1, MAF_gmm_G = 2, MAF_Probes = 15, MAF_gmm_weight = 0.5, gender = \"female\") #> [1] \"GAINLOH\""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CategorizeK.html","id":null,"dir":"Reference","previous_headings":"","what":"Categorize Beta Distribution K Values ‚Äî CategorizeK","title":"Categorize Beta Distribution K Values ‚Äî CategorizeK","text":"Categorizes numeric K value (e.g., beta distribution) bins based sample quantiles.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CategorizeK.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Categorize Beta Distribution K Values ‚Äî CategorizeK","text":"","code":"CategorizeK(K)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CategorizeK.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Categorize Beta Distribution K Values ‚Äî CategorizeK","text":"K Numeric vector. K values categorize.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CategorizeK.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Categorize Beta Distribution K Values ‚Äî CategorizeK","text":"Integer vector categories, possible values 50, 100, 200, 300, corresponding increasing quantile bins.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CategorizeK.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Categorize Beta Distribution K Values ‚Äî CategorizeK","text":"function computes quantiles K (using default quartiles), assigns value category: 50: lowest quantile 100: 2nd quantile 200: 3rd quantile 300: highest quantile","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CategorizeK.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Categorize Beta Distribution K Values ‚Äî CategorizeK","text":"","code":"set.seed(1) K <- rbeta(100, 2, 5) CategorizeK(K) #>   [1]  50 200  50 200  50 200 300 100 300 200  50  50 300 100 100 300 300 300 #>  [19] 300 300 200  50 300 100 100  50 100 200 300 100 200 100  50 100 100 100 #>  [37] 300 100 100 300 200  50  50 200 300 100 300 200 200  50 100  50 300 100 #>  [55] 100 300 200  50 200  50 200 200  50 300  50  50 200 100 200 200  50 100 #>  [73] 100 300  50 300 200 300 100 200 200 100 300 300 300 200  50 100  50 100 #>  [91]  50 200  50 200  50 300 300 200  50 100"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CcfLOH.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate Cancer Cell Fraction (CCF) from Allelic Imbalance (LOH) ‚Äî CcfLOH","title":"Calculate Cancer Cell Fraction (CCF) from Allelic Imbalance (LOH) ‚Äî CcfLOH","text":"Estimates cancer cell fraction (CCF) based minor major allele copy numbers, tumor purity, observed minor-allele frequency (MAF).","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CcfLOH.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate Cancer Cell Fraction (CCF) from Allelic Imbalance (LOH) ‚Äî CcfLOH","text":"","code":"CcfLOH(minor, major, rho, MAF)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CcfLOH.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate Cancer Cell Fraction (CCF) from Allelic Imbalance (LOH) ‚Äî CcfLOH","text":"minor Numeric. Minor allele copy number. major Numeric. Major allele copy number. rho Numeric. Tumor purity (fraction 0 1). MAF Numeric. Observed B-allele frequency.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CcfLOH.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate Cancer Cell Fraction (CCF) from Allelic Imbalance (LOH) ‚Äî CcfLOH","text":"Numeric. estimated cancer cell fraction (CCF), Inf replaced 1, -Inf NA replaced 0.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CcfLOH.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Calculate Cancer Cell Fraction (CCF) from Allelic Imbalance (LOH) ‚Äî CcfLOH","text":"expected MAF calculated MAF_ex = minor / (minor + major). formula CCF : ccf = (MAF - 0.5) / ((MAF_ex - 0.5) * rho)  CCF Inf, returns 1; -Inf NA, returns 0.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CcfLOH.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Calculate Cancer Cell Fraction (CCF) from Allelic Imbalance (LOH) ‚Äî CcfLOH","text":"","code":"CcfLOH(minor = 1, major = 2, rho = 0.7, MAF = 0.6) #> [1] -0.8571429"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CheckGender.html","id":null,"dir":"Reference","previous_headings":"","what":"Check and Adjust Gender in GATK Segmentation Data ‚Äî CheckGender","title":"Check and Adjust Gender in GATK Segmentation Data ‚Äî CheckGender","text":"Check Adjust Gender GATK Segmentation Data","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CheckGender.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Check and Adjust Gender in GATK Segmentation Data ‚Äî CheckGender","text":"","code":"CheckGender(cov, seg, gender)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CheckGender.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Check and Adjust Gender in GATK Segmentation Data ‚Äî CheckGender","text":"cov Coverage data frame seg Segmentation data frame gender Gender clinical information (character, \"male\", \"female\" \"unknown\")","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CheckGender.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Check and Adjust Gender in GATK Segmentation Data ‚Äî CheckGender","text":"Modified segmentation seg data frame gender information","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/Checkmode.html","id":null,"dir":"Reference","previous_headings":"","what":"Check and Set Mode-Specific Parameters for CNV Calling ‚Äî Checkmode","title":"Check and Set Mode-Specific Parameters for CNV Calling ‚Äî Checkmode","text":"Checks sets required parameters \"model\" \"region\" mode CNV calling, ensuring user input sufficient filling missing values possible.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/Checkmode.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Check and Set Mode-Specific Parameters for CNV Calling ‚Äî Checkmode","text":"","code":"Checkmode(mode, purity, dicovsf, chromosome, start, end, call)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/Checkmode.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Check and Set Mode-Specific Parameters for CNV Calling ‚Äî Checkmode","text":"mode Character. Mode operation; either \"model\" \"region\". purity Numeric NULL. Tumor purity value range (required \"model\" mode dicovsf provided). dicovsf Numeric NULL. Size factor (diploid coverage scale factor) range (required \"model\" mode purity provided). chromosome Character NULL. Chromosome number diploid region (required \"region\" mode). start Numeric NULL. Start coordinate diploid region. set \"region\" mode, program use first nucleotide detectable region chromosome. end Numeric NULL. End coordinate diploid region. set \"region\" mode, program use last nucleotide detectable region chromosome. call Data frame tibble. Segment call data, required estimating dicovsf \"region\" mode.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/Checkmode.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Check and Set Mode-Specific Parameters for CNV Calling ‚Äî Checkmode","text":"named list updated parameters: mode, dicovsf, purity.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/Checkmode.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Check and Set Mode-Specific Parameters for CNV Calling ‚Äî Checkmode","text":"\"model\" mode, least one purity dicovsf must provided. \"region\" mode, chromosome must provided; dicovsf missing, estimated using EstimateCovSF() specified region.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/Checkmode.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Check and Set Mode-Specific Parameters for CNV Calling ‚Äî Checkmode","text":"","code":"Checkmode(\"model\", purity = 0.7, dicovsf = NULL, chromosome = NULL, start = NULL, end = NULL, call = call_df) #> $mode #> [1] \"model\" #>  #> $dicovsf #> NULL #>  #> $purity #> [1] 0.7 #>  Checkmode(\"region\", purity = NULL, dicovsf = NULL, chromosome = \"1\", start = 100000, end = 200000, call = call_df) #> Error: object 'call_df' not found"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/ChooseNbins.html","id":null,"dir":"Reference","previous_headings":"","what":"Choose Optimal Number of Depth Strata (Bins) for Panel of Normals ‚Äî ChooseNbins","title":"Choose Optimal Number of Depth Strata (Bins) for Panel of Normals ‚Äî ChooseNbins","text":"Determines optimal number bins (strata) grouping samples SNP median depth, ensuring bin sufficiently populated diverse downstream modeling.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/ChooseNbins.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Choose Optimal Number of Depth Strata (Bins) for Panel of Normals ‚Äî ChooseNbins","text":"","code":"ChooseNbins(   normals_dt,   target_bins = 8,   min_rows_per_stratum = 2000,   min_unique_bins = 100,   max_bins = 10,   min_bins = 3 )"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/ChooseNbins.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Choose Optimal Number of Depth Strata (Bins) for Panel of Normals ‚Äî ChooseNbins","text":"normals_dt Data frame data.table. Must depth information bin.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/ChooseNbins.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Choose Optimal Number of Depth Strata (Bins) for Panel of Normals ‚Äî ChooseNbins","text":"Integer. chosen number bins satisfies population diversity constraints.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/ChooseNbins.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Choose Optimal Number of Depth Strata (Bins) for Panel of Normals ‚Äî ChooseNbins","text":"function iteratively tests different bin (strata) numbers find optimal value based SNP counts sequencing depth.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CleanHomalt.html","id":null,"dir":"Reference","previous_headings":"","what":"Clean Homozygous AI Bins Based on LOH Segments ‚Äî CleanHomalt","title":"Clean Homozygous AI Bins Based on LOH Segments ‚Äî CleanHomalt","text":"Removes homozygous allelic imbalance (AI) bins overlap LOH (loss heterozygosity) segments.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CleanHomalt.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Clean Homozygous AI Bins Based on LOH Segments ‚Äî CleanHomalt","text":"","code":"CleanHomalt(rounded_ai, call_seg)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CleanHomalt.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Clean Homozygous AI Bins Based on LOH Segments ‚Äî CleanHomalt","text":"rounded_ai Data frame tibble. AI data, must include columns contig, start, stop, allele1Count, allele2Count. call_seg Data frame tibble. Segment calls, must include columns chrom, loc.start, loc.end, MAF.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CleanHomalt.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Clean Homozygous AI Bins Based on LOH Segments ‚Äî CleanHomalt","text":"data frame AI bins, homozygous bins outside LOH regions removed.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CleanHomalt.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Clean Homozygous AI Bins Based on LOH Segments ‚Äî CleanHomalt","text":"","code":"# CleanHomalt(rounded_ai, call_seg)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/ClusterAdjacent.html","id":null,"dir":"Reference","previous_headings":"","what":"Cluster Adjacent Values Based on a Threshold ‚Äî ClusterAdjacent","title":"Cluster Adjacent Values Based on a Threshold ‚Äî ClusterAdjacent","text":"Groups adjacent values clusters difference less specified threshold, computes mean total weight cluster.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/ClusterAdjacent.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Cluster Adjacent Values Based on a Threshold ‚Äî ClusterAdjacent","text":"","code":"ClusterAdjacent(values, weights, threshold = 0.01)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/ClusterAdjacent.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Cluster Adjacent Values Based on a Threshold ‚Äî ClusterAdjacent","text":"values Numeric vector values cluster (e.g., means GMM components). weights Numeric vector weights corresponding values. threshold Numeric value specifying maximum allowed difference adjacent values grouped cluster. Default 0.01.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/ClusterAdjacent.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Cluster Adjacent Values Based on a Threshold ‚Äî ClusterAdjacent","text":"list two elements: means Numeric vector cluster means. weights Numeric vector aggregated cluster weights.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/ClusterAdjacent.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Cluster Adjacent Values Based on a Threshold ‚Äî ClusterAdjacent","text":"","code":"ClusterAdjacent(c(0.1, 0.11, 0.5), c(0.3, 0.4, 0.3)) #> $means #> [1] 0.105 0.500 #>  #> $weights #> [1] 0.7 0.3 #>"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/ClusterModels.html","id":null,"dir":"Reference","previous_headings":"","what":"Cluster and Select the Best Models Based on Likelihood and Copy Number Distance ‚Äî ClusterModels","title":"Cluster and Select the Best Models Based on Likelihood and Copy Number Distance ‚Äî ClusterModels","text":"Clusters models total likelihood, diploid nondiploid distance integer copy number, selects best (mu, rho) model.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/ClusterModels.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Cluster and Select the Best Models Based on Likelihood and Copy Number Distance ‚Äî ClusterModels","text":"","code":"ClusterModels(models_dis)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/ClusterModels.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Cluster and Select the Best Models Based on Likelihood and Copy Number Distance ‚Äî ClusterModels","text":"models_dis data frame tibble model metrics, including columns: total_log_likelihood, diploid_distance_to_integer, nondiploid_distance_to_integer, ploidy, mu, rho, diploid_n, etc.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/ClusterModels.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Cluster and Select the Best Models Based on Likelihood and Copy Number Distance ‚Äî ClusterModels","text":"list : Final_mu Best model's mutation multiplicity. Final_rho Best model's tumor purity. total_distance_to_integer Total distance integer copy number best model. total_likelihood Total log-likelihood best model. models full, clustered, sorted model data frame.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/ClusterModels.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Cluster and Select the Best Models Based on Likelihood and Copy Number Distance ‚Äî ClusterModels","text":"Models clustered using change point detection likelihood distance metrics. best model selected series sort criteria.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/ClusterModels.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Cluster and Select the Best Models Based on Likelihood and Copy Number Distance ‚Äî ClusterModels","text":"","code":"# models_dis <- ... # output from SelectModelByDis # ClusterModels(models_dis)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CorrectBAF.html","id":null,"dir":"Reference","previous_headings":"","what":"Correct MAF Values Using a Scaling Factor ‚Äî CorrectBAF","title":"Correct MAF Values Using a Scaling Factor ‚Äî CorrectBAF","text":"Applies scaling factor MAF values.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CorrectBAF.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Correct MAF Values Using a Scaling Factor ‚Äî CorrectBAF","text":"","code":"CorrectBAF(baf, baf_scale)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CorrectBAF.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Correct MAF Values Using a Scaling Factor ‚Äî CorrectBAF","text":"baf data frame tibble numeric column named baf. baf_scale Numeric. scaling factor applied MAF values.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CorrectBAF.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Correct MAF Values Using a Scaling Factor ‚Äî CorrectBAF","text":"data frame tibble corrected baf column.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CorrectBias.html","id":null,"dir":"Reference","previous_headings":"","what":"Correct MAF Bias in Segments Using Panel of Normal Reference ‚Äî CorrectBias","title":"Correct MAF Bias in Segments Using Panel of Normal Reference ‚Äî CorrectBias","text":"Adjusts minor allele frequency (MAF) values segment systematic bias using panel normal (PoN) reference. segment, compares segment MAF PoN MAF distribution, applies logit-based correction segment MAF significantly different PoN. segment MAF significantly different, retains original value.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CorrectBias.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Correct MAF Bias in Segments Using Panel of Normal Reference ‚Äî CorrectBias","text":"","code":"CorrectBias(tmp_seg, pon_ref, tmp_maf)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CorrectBias.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Correct MAF Bias in Segments Using Panel of Normal Reference ‚Äî CorrectBias","text":"tmp_seg Data frame data.table. Segmented data corrected, must include columns: Chromosome, Start, End, Sample, Num_Probes, Segment_Mean, gatk_SM_raw, gatk_count, gatk_baselinecov, gatk_gender, pipeline_gender, MAF, MAF_Probes, MAF_gmm_G, MAF_gmm_weight, size. pon_ref Data frame data.table. Panel normal reference, must include columns: Chromosome, Start, End, pon_mafs (comma-separated string PoN MAF values). tmp_maf Data frame data.table. Per-SNP MAF data, must include columns: Pos, maf.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CorrectBias.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Correct MAF Bias in Segments Using Panel of Normal Reference ‚Äî CorrectBias","text":"data frame bias-corrected MAF values segment. MAF column updated corrected value, columns gmm_mean_corr, each_mafs, pon_mafs removed.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CorrectBias.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Correct MAF Bias in Segments Using Panel of Normal Reference ‚Äî CorrectBias","text":"segment, function performs interval join PoN reference obtain PoN MAF distribution. segment MAF significantly different PoN (Wilcoxon test threshold), applies logit-based correction. Otherwise, original segment MAF retained. function uses panel median MAF centering clamps corrected values 0, 0.5.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CorrectGender.html","id":null,"dir":"Reference","previous_headings":"","what":"Correct Copy Ratio File if GATK and Pipeline Gender Disagree ‚Äî CorrectGender","title":"Correct Copy Ratio File if GATK and Pipeline Gender Disagree ‚Äî CorrectGender","text":"Adjusts X chromosome log2 copy ratio coverage data gender assigned GATK pipeline match.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CorrectGender.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Correct Copy Ratio File if GATK and Pipeline Gender Disagree ‚Äî CorrectGender","text":"","code":"CorrectGender(cov, seg)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CorrectGender.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Correct Copy Ratio File if GATK and Pipeline Gender Disagree ‚Äî CorrectGender","text":"cov Data frame tibble. Coverage data, must include columns CONTIG LOG2_COPY_RATIO. seg Data frame tibble. Segmentation data, must include columns gatk_gender pipeline_gender.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CorrectGender.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Correct Copy Ratio File if GATK and Pipeline Gender Disagree ‚Äî CorrectGender","text":"corrected coverage data frame tibble.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CorrectGender.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Correct Copy Ratio File if GATK and Pipeline Gender Disagree ‚Äî CorrectGender","text":"GATK gender \"male\" pipeline gender \"female\", subtracts 1 X chromosome log2 copy ratio. GATK gender \"female\" pipeline gender \"male\", adds 1 X chromosome log2 copy ratio. Otherwise, returns input coverage unchanged.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CorrectGender.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Correct Copy Ratio File if GATK and Pipeline Gender Disagree ‚Äî CorrectGender","text":"","code":"# CorrectGender(cov, seg)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CorrectMAF.html","id":null,"dir":"Reference","previous_headings":"","what":"Correct MAF Values Using a Scaling Factor ‚Äî CorrectMAF","title":"Correct MAF Values Using a Scaling Factor ‚Äî CorrectMAF","text":"Applies scaling factor MAF values.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CorrectMAF.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Correct MAF Values Using a Scaling Factor ‚Äî CorrectMAF","text":"","code":"CorrectMAF(maf, maf_scale)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CorrectMAF.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Correct MAF Values Using a Scaling Factor ‚Äî CorrectMAF","text":"maf data frame tibble numeric column named maf. maf_scale Numeric. scaling factor applied MAF values.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CorrectMAF.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Correct MAF Values Using a Scaling Factor ‚Äî CorrectMAF","text":"data frame tibble corrected maf column.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CorrectPurity.html","id":null,"dir":"Reference","previous_headings":"","what":"Correct CNF and MAF According to Purity ‚Äî CorrectPurity","title":"Correct CNF and MAF According to Purity ‚Äî CorrectPurity","text":"Correct CNF MAF According Purity","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CorrectPurity.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Correct CNF and MAF According to Purity ‚Äî CorrectPurity","text":"","code":"CorrectPurity(chromosome, cov_segmentmean, MAF_observe, gender, purity)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CorrectPurity.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Correct CNF and MAF According to Purity ‚Äî CorrectPurity","text":"chromosome Character. Chromosome name. cov_segmentmean Numeric. Segment mean (log2 ratio). MAF_observe Numeric. Observed minor allele frequency. gender Character. \"male\" \"female\". purity Numeric. Tumor purity (fraction 0 1).","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CorrectPurity.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Correct CNF and MAF According to Purity ‚Äî CorrectPurity","text":"list CNF_correct MAF_correct.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CovBin.html","id":null,"dir":"Reference","previous_headings":"","what":"Bin and Smooth Copy Number Data from Coverage File ‚Äî CovBin","title":"Bin and Smooth Copy Number Data from Coverage File ‚Äî CovBin","text":"Splits coverage data chromosome, bins 300bp windows, computes smoothed copy number values using larger window size.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CovBin.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Bin and Smooth Copy Number Data from Coverage File ‚Äî CovBin","text":"","code":"CovBin(cov, cov_binsize)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CovBin.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Bin and Smooth Copy Number Data from Coverage File ‚Äî CovBin","text":"cov Data frame tibble. Must include columns CONTIG, START, END, CNF. cov_binsize Numeric. Bin size (bases) smoothing (e.g., 10000 10kb).","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CovBin.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Bin and Smooth Copy Number Data from Coverage File ‚Äî CovBin","text":"data frame columns: CONTIG, bin_start, bin_norm_id, smoothed CNF values.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CovBin.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Bin and Smooth Copy Number Data from Coverage File ‚Äî CovBin","text":"Bins generated every 300bp within region. Smoothed copy number computed median CNF within larger (cov_binsize) window.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CovBin.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Bin and Smooth Copy Number Data from Coverage File ‚Äî CovBin","text":"","code":"# CovBin(cov, cov_binsize = 10000)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CoverageQC.html","id":null,"dir":"Reference","previous_headings":"","what":"Summarise BAF QC from CNV Segment Annotation ‚Äî CoverageQC","title":"Summarise BAF QC from CNV Segment Annotation ‚Äî CoverageQC","text":"Summarises number size \"PASS\" segments per chromosome CNV annotation file.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CoverageQC.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summarise BAF QC from CNV Segment Annotation ‚Äî CoverageQC","text":"","code":"CoverageQC(annofile)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CoverageQC.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Summarise BAF QC from CNV Segment Annotation ‚Äî CoverageQC","text":"annofile Path CNV annotation file (e.g., *_CNV_annotation.tsv).","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CoverageQC.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Summarise BAF QC from CNV Segment Annotation ‚Äî CoverageQC","text":"Invisibly returns summary data frame.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/EstimateBAFbyGMM.html","id":null,"dir":"Reference","previous_headings":"","what":"Estimate BAF Cluster Mean and Weight Using Gaussian Mixture Modeling ‚Äî EstimateBAFbyGMM","title":"Estimate BAF Cluster Mean and Weight Using Gaussian Mixture Modeling ‚Äî EstimateBAFbyGMM","text":"Fits Gaussian mixture model (GMM) B-allele frequency (BAF) values returns prominent cluster's mean weight. Clusters similar means (within threshold) merged. insufficient values nearly variance, simple mean returned.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/EstimateBAFbyGMM.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Estimate BAF Cluster Mean and Weight Using Gaussian Mixture Modeling ‚Äî EstimateBAFbyGMM","text":"","code":"EstimateBAFbyGMM(baf_values)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/EstimateBAFbyGMM.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Estimate BAF Cluster Mean and Weight Using Gaussian Mixture Modeling ‚Äî EstimateBAFbyGMM","text":"baf_values Numeric vector BAF values.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/EstimateBAFbyGMM.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Estimate BAF Cluster Mean and Weight Using Gaussian Mixture Modeling ‚Äî EstimateBAFbyGMM","text":"Named numeric vector elements: gmm_mean mean prominent cluster (capped 0.5). gmm_weight mixture weight prominent cluster. gmm_G Number clusters merging adjacent means.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/EstimateBAFbyGMM.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Estimate BAF Cluster Mean and Weight Using Gaussian Mixture Modeling ‚Äî EstimateBAFbyGMM","text":"Uses Mclust Gaussian mixture modeling ClusterAdjacent merge similar clusters.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/EstimateBAFshift.html","id":null,"dir":"Reference","previous_headings":"","what":"Estimate MAF Shift Scaling Factor ‚Äî EstimateBAFshift","title":"Estimate MAF Shift Scaling Factor ‚Äî EstimateBAFshift","text":"Estimates scaling factor correct MAF shift.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/EstimateBAFshift.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Estimate MAF Shift Scaling Factor ‚Äî EstimateBAFshift","text":"","code":"EstimateBAFshift(baf)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/EstimateBAFshift.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Estimate MAF Shift Scaling Factor ‚Äî EstimateBAFshift","text":"baf data frame tibble least baf column (numeric MAF values).","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/EstimateBAFshift.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Estimate MAF Shift Scaling Factor ‚Äî EstimateBAFshift","text":"Numeric. estimated MAF scaling factor, NA enough SNPs.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/EstimateBAFshift.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Estimate MAF Shift Scaling Factor ‚Äî EstimateBAFshift","text":"Uses Mclust Gaussian mixture modeling.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/EstimateCovSF.html","id":null,"dir":"Reference","previous_headings":"","what":"Estimate Coverage Scale Factor for a Chromosome or Region ‚Äî EstimateCovSF","title":"Estimate Coverage Scale Factor for a Chromosome or Region ‚Äî EstimateCovSF","text":"Estimates coverage scale factor (covsf) specified chromosome subregion, based segment mean probe count.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/EstimateCovSF.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Estimate Coverage Scale Factor for a Chromosome or Region ‚Äî EstimateCovSF","text":"","code":"EstimateCovSF(chromosome, start, end, seg)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/EstimateCovSF.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Estimate Coverage Scale Factor for a Chromosome or Region ‚Äî EstimateCovSF","text":"chromosome Character. Chromosome name (e.g., \"1\", \"X\"). start Numeric NULL. Start coordinate region. NULL, uses first segment start chromosome. end Numeric NULL. End coordinate region. NULL, uses last segment end chromosome. seg Data frame tibble. Segment data, must include columns Chromosome, Start, End, Segment_Mean, Num_Probes.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/EstimateCovSF.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Estimate Coverage Scale Factor for a Chromosome or Region ‚Äî EstimateCovSF","text":"Numeric. estimated coverage scale factor (covsf) specified region.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/EstimateCovSF.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Estimate Coverage Scale Factor for a Chromosome or Region ‚Äî EstimateCovSF","text":"function calculates weighted mean coverage based segment means probe counts within specified region. start end provided, entire chromosome used estimation.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/EstimateCovSF.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Estimate Coverage Scale Factor for a Chromosome or Region ‚Äî EstimateCovSF","text":"","code":"# EstimateCovSF(\"3\", start = NULL, end = NULL, seg = seg_df) # EstimateCovSF(\"7\", start = 100000, end = 500000, seg = seg_df)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/EstimateK.html","id":null,"dir":"Reference","previous_headings":"","what":"Estimate Beta-Binomial K Parameter for Each Segment ‚Äî EstimateK","title":"Estimate Beta-Binomial K Parameter for Each Segment ‚Äî EstimateK","text":"Calculates beta-binomial concentration parameter (K) segment based local sequencing depth fitted dispersion model.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/EstimateK.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Estimate Beta-Binomial K Parameter for Each Segment ‚Äî EstimateK","text":"","code":"EstimateK(result, theta_fit, maf)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/EstimateK.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Estimate Beta-Binomial K Parameter for Each Segment ‚Äî EstimateK","text":"result Data frame. Segment-level results, must include columns Chromosome, Start, End. theta_fit List data frame. Fitted dispersion model, must include breaks (numeric vector depth bin edges) theta_table (data frame columns depth_bin theta). maf Data frame. Allelic count data SNPs, must include columns chr, Pos, ref_count, alt_count.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/EstimateK.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Estimate Beta-Binomial K Parameter for Each Segment ‚Äî EstimateK","text":"input result data frame additional columns: depth Median SNP depth segment. depth_bin Depth bin index segment. theta Estimated dispersion parameter segment. K Estimated beta-binomial concentration parameter segment.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/EstimateK.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Estimate Beta-Binomial K Parameter for Each Segment ‚Äî EstimateK","text":"segment, function extracts SNPs within segment boundaries maf data, calculates median depth, assigns depth bin according theta_fit$breaks, joins corresponding theta value theta_fit$theta_table, computes K using formula \\(K = \\frac{\\text{depth}}{1 + \\text{depth} \\cdot \\theta} - 1\\).","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/EstimateMAFbyGMM.html","id":null,"dir":"Reference","previous_headings":"","what":"Estimate MAF Cluster Mean and Weight Using Gaussian Mixture Modeling ‚Äî EstimateMAFbyGMM","title":"Estimate MAF Cluster Mean and Weight Using Gaussian Mixture Modeling ‚Äî EstimateMAFbyGMM","text":"Fits Gaussian mixture model (GMM) Minor allele frequency (MAF) values returns prominent cluster's mean weight. Clusters similar means (within threshold) merged. insufficient values nearly variance, simple mean returned.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/EstimateMAFbyGMM.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Estimate MAF Cluster Mean and Weight Using Gaussian Mixture Modeling ‚Äî EstimateMAFbyGMM","text":"","code":"EstimateMAFbyGMM(maf_values)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/EstimateMAFbyGMM.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Estimate MAF Cluster Mean and Weight Using Gaussian Mixture Modeling ‚Äî EstimateMAFbyGMM","text":"maf_values Numeric vector MAF values.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/EstimateMAFbyGMM.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Estimate MAF Cluster Mean and Weight Using Gaussian Mixture Modeling ‚Äî EstimateMAFbyGMM","text":"Named numeric vector elements: gmm_mean mean prominent cluster (capped 0.5). gmm_weight mixture weight prominent cluster. gmm_G Number clusters merging adjacent means.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/EstimateMAFbyGMM.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Estimate MAF Cluster Mean and Weight Using Gaussian Mixture Modeling ‚Äî EstimateMAFbyGMM","text":"Uses Mclust Gaussian mixture modeling.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/EstimateMAFshift.html","id":null,"dir":"Reference","previous_headings":"","what":"Estimate MAF Shift Scaling Factor ‚Äî EstimateMAFshift","title":"Estimate MAF Shift Scaling Factor ‚Äî EstimateMAFshift","text":"Estimates scaling factor correct MAF shift.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/EstimateMAFshift.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Estimate MAF Shift Scaling Factor ‚Äî EstimateMAFshift","text":"","code":"EstimateMAFshift(maf)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/EstimateMAFshift.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Estimate MAF Shift Scaling Factor ‚Äî EstimateMAFshift","text":"maf data frame tibble least maf column (numeric MAF values).","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/EstimateMAFshift.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Estimate MAF Shift Scaling Factor ‚Äî EstimateMAFshift","text":"Numeric. estimated MAF scaling factor, NA enough SNPs.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/EstimateMAFshift.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Estimate MAF Shift Scaling Factor ‚Äî EstimateMAFshift","text":"Uses Mclust Gaussian mixture modeling.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/EstimateMinPurity.html","id":null,"dir":"Reference","previous_headings":"","what":"Estimate Minimum Tumor Purity from MAF Data ‚Äî EstimateMinPurity","title":"Estimate Minimum Tumor Purity from MAF Data ‚Äî EstimateMinPurity","text":"Estimates minimum tumor purity based lowest MAF among segments tagged \"Include\".","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/EstimateMinPurity.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Estimate Minimum Tumor Purity from MAF Data ‚Äî EstimateMinPurity","text":"","code":"EstimateMinPurity(df)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/EstimateMinPurity.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Estimate Minimum Tumor Purity from MAF Data ‚Äî EstimateMinPurity","text":"df data frame tibble containing least columns MAF Tag.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/EstimateMinPurity.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Estimate Minimum Tumor Purity from MAF Data ‚Äî EstimateMinPurity","text":"Numeric. estimated minimum tumor purity, 0 suitable segments found.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/EstimateMinPurity.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Estimate Minimum Tumor Purity from MAF Data ‚Äî EstimateMinPurity","text":"rows Tag == \"Include\" considered. minimum MAF less 0.4, minimum purity estimated max((0.5 - min\\_MAF) / 0.5 - 0.05, 0). Otherwise, returns 0.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/EstimateMinPurity.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Estimate Minimum Tumor Purity from MAF Data ‚Äî EstimateMinPurity","text":"","code":"df <- data.frame(MAF = c(0.3, 0.45, 0.5), Tag = c(\"Include\", \"Exclude\", \"Include\")) EstimateMinPurity(df) #> [1] 0.35"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/EstimatePurityCov.html","id":null,"dir":"Reference","previous_headings":"","what":"Estimate Tumor Purity from Coverage and Segmentation Data ‚Äî EstimatePurityCov","title":"Estimate Tumor Purity from Coverage and Segmentation Data ‚Äî EstimatePurityCov","text":"Estimates tumor purity fitting coverage MAF segmentation data across range purity values, selecting purity best matches integer copy number models.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/EstimatePurityCov.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Estimate Tumor Purity from Coverage and Segmentation Data ‚Äî EstimatePurityCov","text":"","code":"EstimatePurityCov(seg, gender)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/EstimatePurityCov.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Estimate Tumor Purity from Coverage and Segmentation Data ‚Äî EstimatePurityCov","text":"seg data frame tibble segment data, columns: Chromosome, Segment_Mean, MAF, MAF_gmm_G, MAF_Probes, MAF_gmm_weight, size, etc. gender Gender male femal.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/EstimatePurityCov.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Estimate Tumor Purity from Coverage and Segmentation Data ‚Äî EstimatePurityCov","text":"list elements: dis_df Data frame model fit statistics purity. Final_model List Final_mu Final_rho (selected purity). min_dis Minimum distance integer copy numbers. seg_call Segment calls selected purity. Model_source String, always \"Coverage\".","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/EstimatePurityCov.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Estimate Tumor Purity from Coverage and Segmentation Data ‚Äî EstimatePurityCov","text":"function fits models sequence purity values, applies segment correction calling, selects purity best fit integer copy number.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/EstimateSFVariance.html","id":null,"dir":"Reference","previous_headings":"","what":"Estimate Standard Deviation of a Numeric Vector ‚Äî EstimateSFVariance","title":"Estimate Standard Deviation of a Numeric Vector ‚Äî EstimateSFVariance","text":"Calculates standard deviation (sigma) sample variance numeric vector.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/EstimateSFVariance.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Estimate Standard Deviation of a Numeric Vector ‚Äî EstimateSFVariance","text":"","code":"EstimateSFVariance(x)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/EstimateSFVariance.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Estimate Standard Deviation of a Numeric Vector ‚Äî EstimateSFVariance","text":"x Numeric vector.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/EstimateSFVariance.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Estimate Standard Deviation of a Numeric Vector ‚Äî EstimateSFVariance","text":"Numeric. estimated standard deviation x.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/EstimateSFVariance.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Estimate Standard Deviation of a Numeric Vector ‚Äî EstimateSFVariance","text":"function computes sample variance using var(x) returns square root.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/EstimateSFVariance.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Estimate Standard Deviation of a Numeric Vector ‚Äî EstimateSFVariance","text":"","code":"EstimateSFVariance(c(1, 2, 3, 4, 5)) #> [1] 1.581139"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/EstimateTheta.html","id":null,"dir":"Reference","previous_headings":"","what":"Estimate Beta-Binomial Over-Dispersion Parameter (Theta) ‚Äî EstimateTheta","title":"Estimate Beta-Binomial Over-Dispersion Parameter (Theta) ‚Äî EstimateTheta","text":"Estimates -dispersion parameter (theta) beta-binomial model stratified sequencing depth, using panel normal (PoN) BAF data.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/EstimateTheta.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Estimate Beta-Binomial Over-Dispersion Parameter (Theta) ‚Äî EstimateTheta","text":"","code":"EstimateTheta(normals_dt, pon_ref, n_bins)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/EstimateTheta.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Estimate Beta-Binomial Over-Dispersion Parameter (Theta) ‚Äî EstimateTheta","text":"normals_dt Data frame tibble. Panel normal data. pon_ref Data frame tibble. Reference PoN data. n_bins Integer. Number depth strata use.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/EstimateTheta.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Estimate Beta-Binomial Over-Dispersion Parameter (Theta) ‚Äî EstimateTheta","text":"Returns list elements: theta_table Data frame columns depth_bin theta (per-stratum estimates). breaks Numeric vector depth quantile breakpoints.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/EstimateTheta.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Estimate Beta-Binomial Over-Dispersion Parameter (Theta) ‚Äî EstimateTheta","text":"function compares observed BAF variance expected binomial variance across bins depths, estimates theta : $$\\theta = \\frac{\\mathrm{Var}(p)}{\\mathrm{E}[p(1-p)/d]} - 1$$ \\(p\\) observed BAF, \\(d\\) median depth.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/EstimateVariance.html","id":null,"dir":"Reference","previous_headings":"","what":"Estimate Standard Deviation of a Numeric Vector ‚Äî EstimateVariance","title":"Estimate Standard Deviation of a Numeric Vector ‚Äî EstimateVariance","text":"Calculates standard deviation (sigma) sample variance numeric vector.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/EstimateVariance.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Estimate Standard Deviation of a Numeric Vector ‚Äî EstimateVariance","text":"","code":"EstimateVariance(x)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/EstimateVariance.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Estimate Standard Deviation of a Numeric Vector ‚Äî EstimateVariance","text":"x Numeric vector.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/EstimateVariance.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Estimate Standard Deviation of a Numeric Vector ‚Äî EstimateVariance","text":"Numeric. estimated standard deviation x.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/EstimateVariance.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Estimate Standard Deviation of a Numeric Vector ‚Äî EstimateVariance","text":"function computes sample variance using var(x) returns square root.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/EstimateVariance.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Estimate Standard Deviation of a Numeric Vector ‚Äî EstimateVariance","text":"","code":"EstimateVariance(c(1, 2, 3, 4, 5)) #> [1] 1.581139"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/ExtractCall.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract Final Calls for a Given (mu, rho) Model ‚Äî ExtractCall","title":"Extract Final Calls for a Given (mu, rho) Model ‚Äî ExtractCall","text":"given (mu, rho) combination, joins segment call results segment metadata returns final calls.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/ExtractCall.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract Final Calls for a Given (mu, rho) Model ‚Äî ExtractCall","text":"","code":"ExtractCall(df, max_L_mu, max_L_rho, seg)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/ExtractCall.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract Final Calls for a Given (mu, rho) Model ‚Äî ExtractCall","text":"df Data frame tibble. Contains segment call results, including columns mu, rho, index. max_L_mu Numeric. selected value mutation multiplicity (mu). max_L_rho Numeric. selected value tumor purity (rho). seg Data frame tibble. Segment metadata, must include column index.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/ExtractCall.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extract Final Calls for a Given (mu, rho) Model ‚Äî ExtractCall","text":"data frame tibble final calls given (mu, rho) model, joined segment metadata.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/ExtractCall.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Extract Final Calls for a Given (mu, rho) Model ‚Äî ExtractCall","text":"","code":"# ExtractCall(df, max_L_mu = 1, max_L_rho = 0.7, seg)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/FindTier1Models.html","id":null,"dir":"Reference","previous_headings":"","what":"Find the ","title":"Find the ","text":"Identifies first major drop (\"elbow\") sorted vector values, using smoothed difference approach.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/FindTier1Models.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Find the ","text":"","code":"FindTier1Models(values, fold)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/FindTier1Models.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Find the ","text":"values Numeric vector. Typically sorted (e.g., decreasing likelihoods scores). fold Numeric. Multiplicative factor median drop define significant elbow (e.g., 1.5).","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/FindTier1Models.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Find the ","text":"Integer. index first major drop (\"elbow\") values vector.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/FindTier1Models.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Find the ","text":"Uses rolling mean negative differences smooth noise find first drop exceeding fold times median drop. drop found, uses geometric \"elbow\" method fallback.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/FindTier1Models.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Find the ","text":"","code":"set.seed(1) vals <- sort(runif(20, 0, 10), decreasing = TRUE) FindTier1Models(vals, fold = 1.5) #> [1] 11"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/FixsegmentMean.html","id":null,"dir":"Reference","previous_headings":"","what":"Fix Segment Mean Based on Gender Discrepancy ‚Äî FixsegmentMean","title":"Fix Segment Mean Based on Gender Discrepancy ‚Äî FixsegmentMean","text":"Fix Segment Mean Based Gender Discrepancy","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/FixsegmentMean.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fix Segment Mean Based on Gender Discrepancy ‚Äî FixsegmentMean","text":"","code":"FixsegmentMean(sm, gatkgender, pipeline_gender)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/FixsegmentMean.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Fix Segment Mean Based on Gender Discrepancy ‚Äî FixsegmentMean","text":"sm Segment mean gatkgender Gender GATK pipeline_gender Gender clinical info","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/FixsegmentMean.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Fix Segment Mean Based on Gender Discrepancy ‚Äî FixsegmentMean","text":"Adjusted segment mean","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/GenerateCombinations.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate All Major/Minor Allele Combinations for a Given Total Copy Number ‚Äî GenerateCombinations","title":"Generate All Major/Minor Allele Combinations for a Given Total Copy Number ‚Äî GenerateCombinations","text":"Generates valid combinations major minor allele copy numbers sum specified total copy number, constraint major >= minor.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/GenerateCombinations.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate All Major/Minor Allele Combinations for a Given Total Copy Number ‚Äî GenerateCombinations","text":"","code":"GenerateCombinations(CN)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/GenerateCombinations.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate All Major/Minor Allele Combinations for a Given Total Copy Number ‚Äî GenerateCombinations","text":"CN Integer. total copy number.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/GenerateCombinations.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate All Major/Minor Allele Combinations for a Given Total Copy Number ‚Äî GenerateCombinations","text":"data frame columns: major Major allele copy number. minor Minor allele copy number. CN Sum major minor (equals input CN).","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/GenerateCombinations.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Generate All Major/Minor Allele Combinations for a Given Total Copy Number ‚Äî GenerateCombinations","text":"","code":"GenerateCombinations(3) #>   major minor CN #> 4     3     0  3 #> 7     2     1  3"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/GenerateISCN.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate Cytoband-Based Annotation String for a CNV Segment ‚Äî GenerateISCN","title":"Generate Cytoband-Based Annotation String for a CNV Segment ‚Äî GenerateISCN","text":"Returns cytoband-based annotation string CNV segment, based segment's position proximity p q arm detectable region boundaries.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/GenerateISCN.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate Cytoband-Based Annotation String for a CNV Segment ‚Äî GenerateISCN","text":"","code":"GenerateISCN(   chrom,   Start,   End,   CNF,   CN,   p_chromStart,   p_chromEnd,   p_first_name,   p_last_name,   q_chromStart,   q_chromEnd,   q_first_name,   q_last_name,   p_gap_to_tel,   p_gap_to_cen,   q_gap_to_tel,   q_gap_to_cen,   cytoband )"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/GenerateISCN.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate Cytoband-Based Annotation String for a CNV Segment ‚Äî GenerateISCN","text":"chrom Character. Chromosome name. Start, End Numeric. Segment start end positions (base pairs). CNF Numeric. Fractional copy number. CN Integer. Integer copy number. p_chromStart, p_chromEnd Numeric. p-arm detectable region start end positions. p_first_name, p_last_name Character. Cytoband names p-arm start end. q_chromStart, q_chromEnd Numeric. q-arm detectable region start end positions. q_first_name, q_last_name Character. Cytoband names q-arm start end. p_gap_to_tel, p_gap_to_cen, q_gap_to_tel, q_gap_to_cen Numeric. Gaps segment detectable region boundaries (CalculateGaps). cytoband Data frame. Cytoband annotation table.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/GenerateISCN.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate Cytoband-Based Annotation String for a CNV Segment ‚Äî GenerateISCN","text":"Character. cytoband-based annotation string segment.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/GenerateISCN.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Generate Cytoband-Based Annotation String for a CNV Segment ‚Äî GenerateISCN","text":"function determines annotation follows: segment start end cytoband, returns single-band range. segment spans multiple cytobands, returns range start end cytoband. segment close p-arm telomere centromere (p-arm boundaries), returns p-arm event . segment close q-arm centromere telomere (q-arm boundaries), returns q-arm event (chromosome-level event acrocentric chromosomes). segment close p-arm q-arm telomeres (covers whole chromosome), returns chromosome-level event. gap size smaller 5MB defined \"close\". acrocentric chromosomes, q-arm boundaries considered. annotation string determined size gaps segment p/q arm detectable region boundaries cytoband names segment start end. Events reported cytoband range, p-arm , q-arm , chromosome-level event.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/GenerateISCN.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Generate Cytoband-Based Annotation String for a CNV Segment ‚Äî GenerateISCN","text":"","code":"# GenerateISCN(\"1\", 10000, 50000, 2.1, 2, 0, 25000, \"p36.33\", \"p11.2\", #               25001, 100000, \"q11.1\", \"q44\", 1000, 1000, 1000, 1000, cytoband)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/Groupvalues.html","id":null,"dir":"Reference","previous_headings":"","what":"Group Values by Change Points in the Mean ‚Äî Groupvalues","title":"Group Values by Change Points in the Mean ‚Äî Groupvalues","text":"Uses changepoint package detect change points mean numeric vector assigns group IDs accordingly.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/Groupvalues.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Group Values by Change Points in the Mean ‚Äî Groupvalues","text":"","code":"Groupvalues(x)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/Groupvalues.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Group Values by Change Points in the Mean ‚Äî Groupvalues","text":"x Numeric vector.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/Groupvalues.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Group Values by Change Points in the Mean ‚Äî Groupvalues","text":"integer vector length x, element indicates group assignment based detected change points.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/Groupvalues.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Group Values by Change Points in the Mean ‚Äî Groupvalues","text":"Uses cpt.mean changepoint package PELT method MBIC penalty detect change points mean.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/Groupvalues.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Group Values by Change Points in the Mean ‚Äî Groupvalues","text":"","code":"# Example with a simulated change in mean set.seed(123) x <- c(rnorm(50, 0), rnorm(50, 3)) group_id <- Groupvalues(x) table(group_id) #> group_id #>  1  2  #> 50 50"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/KeepWhitelistAI.html","id":null,"dir":"Reference","previous_headings":"","what":"Keep Only AI Bins in Whitelisted Regions ‚Äî KeepWhitelistAI","title":"Keep Only AI Bins in Whitelisted Regions ‚Äî KeepWhitelistAI","text":"Filters AI (allelic imbalance) bins include overlapping whitelisted regions.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/KeepWhitelistAI.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Keep Only AI Bins in Whitelisted Regions ‚Äî KeepWhitelistAI","text":"","code":"KeepWhitelistAI(rounded_ai, whitelist)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/KeepWhitelistAI.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Keep Only AI Bins in Whitelisted Regions ‚Äî KeepWhitelistAI","text":"rounded_ai Data frame tibble. Rounded AI data, must include columns contig, start, stop. whitelist Data frame tibble. Whitelist regions, must include columns seqnames, start, end.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/KeepWhitelistAI.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Keep Only AI Bins in Whitelisted Regions ‚Äî KeepWhitelistAI","text":"data frame AI bins overlap whitelisted regions.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/KeepWhitelistAI.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Keep Only AI Bins in Whitelisted Regions ‚Äî KeepWhitelistAI","text":"","code":"# KeepWhitelistAI(rounded_ai, whitelist)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/KeepWhitelistCov.html","id":null,"dir":"Reference","previous_headings":"","what":"Keep Only Coverage Bins in Whitelisted Regions ‚Äî KeepWhitelistCov","title":"Keep Only Coverage Bins in Whitelisted Regions ‚Äî KeepWhitelistCov","text":"Filters smoothed coverage bins include overlapping whitelisted regions.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/KeepWhitelistCov.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Keep Only Coverage Bins in Whitelisted Regions ‚Äî KeepWhitelistCov","text":"","code":"KeepWhitelistCov(smooth_cov, whitelist, gender)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/KeepWhitelistCov.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Keep Only Coverage Bins in Whitelisted Regions ‚Äî KeepWhitelistCov","text":"smooth_cov Data frame tibble. Smoothed coverage data, must include columns CONTIG, bin_start, bin_end. whitelist Data frame tibble. Whitelist regions, must include columns chrom, start, end. gender Character. femle male.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/KeepWhitelistCov.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Keep Only Coverage Bins in Whitelisted Regions ‚Äî KeepWhitelistCov","text":"data frame smoothed coverage bins overlap whitelisted regions.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/KeepWhitelistCov.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Keep Only Coverage Bins in Whitelisted Regions ‚Äî KeepWhitelistCov","text":"","code":"# KeepWhitelistCov(smooth_cov, whitelist)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/MergeAICheck.html","id":null,"dir":"Reference","previous_headings":"","what":"Check Whether Two AI Segments Should Be Merged ‚Äî MergeAICheck","title":"Check Whether Two AI Segments Should Be Merged ‚Äî MergeAICheck","text":"function determines whether two adjacent AI (allelic imbalance) segments merged, based difference GMM means quality thresholds.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/MergeAICheck.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Check Whether Two AI Segments Should Be Merged ‚Äî MergeAICheck","text":"","code":"MergeAICheck(cur_row, next_row, mergeai, snpmin)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/MergeAICheck.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Check Whether Two AI Segments Should Be Merged ‚Äî MergeAICheck","text":"cur_row data frame row (list tibble row) representing current segment. Must include relevant columns (e.g., gmm_mean, gmm_weight, nonzero_count). next_row data frame row (list tibble row) representing next segment. Must include relevant columns (e.g., gmm_mean, gmm_weight, nonzero_count). mergeai Numeric. Threshold difference MAF (gmm_mean) adjacent segments allow merging. snpmin Numeric. Minimum SNP count required segment considered separate segment.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/MergeAICheck.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Check Whether Two AI Segments Should Be Merged ‚Äî MergeAICheck","text":"Logical value: TRUE two segments merged, FALSE otherwise.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/MergeAIRow.html","id":null,"dir":"Reference","previous_headings":"","what":"Merge Adjacent AI Segments Based on Similarity Criteria ‚Äî MergeAIRow","title":"Merge Adjacent AI Segments Based on Similarity Criteria ‚Äî MergeAIRow","text":"Iteratively merges adjacent rows data frame AI segments meet criteria defined MergeAICheck. merged segments, MAF values re-estimated segment information updated.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/MergeAIRow.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Merge Adjacent AI Segments Based on Similarity Criteria ‚Äî MergeAIRow","text":"","code":"MergeAIRow(df, mergeai, snpmin, tmp_maf)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/MergeAIRow.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Merge Adjacent AI Segments Based on Similarity Criteria ‚Äî MergeAIRow","text":"df data frame tibble AI segments, columns Chromosome, bin, Start, End, snp_count, each_maf, etc. mergeai Numeric. Threshold difference MAF (gmm_mean) adjacent segments allow merging. snpmin Numeric. Minimum SNP count required segment considered separate segment. tmp_maf data frame tibble containing maf values genomic coordinates (must include Chromosome, Start, End, maf).","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/MergeAIRow.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Merge Adjacent AI Segments Based on Similarity Criteria ‚Äî MergeAIRow","text":"data frame tibble merged AI segments, updated maf estimates, segment information.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/MergeAIRow.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Merge Adjacent AI Segments Based on Similarity Criteria ‚Äî MergeAIRow","text":"function uses MergeAICheck determine two adjacent segments merged. merged segments, maf values re-estimated using EstimateMAFbyGMM.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/MergeSegCheck.html","id":null,"dir":"Reference","previous_headings":"","what":"Check Whether Two Segments Should Be Merged (Copy Number) ‚Äî MergeSegCheck","title":"Check Whether Two Segments Should Be Merged (Copy Number) ‚Äî MergeSegCheck","text":"Determines whether two adjacent copy number segments merged based difference segment means whether calls identical.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/MergeSegCheck.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Check Whether Two Segments Should Be Merged (Copy Number) ‚Äî MergeSegCheck","text":"","code":"MergeSegCheck(cur_row, next_row, mergecov)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/MergeSegCheck.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Check Whether Two Segments Should Be Merged (Copy Number) ‚Äî MergeSegCheck","text":"cur_row data frame row (list tibble row) representing current segment. Must Segment_Mean Call. next_row data frame row (list tibble row) representing next segment. Must Segment_Mean Call. mergecov Numeric threshold segment mean difference","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/MergeSegCheck.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Check Whether Two Segments Should Be Merged (Copy Number) ‚Äî MergeSegCheck","text":"Logical value: TRUE two segments merged, FALSE otherwise.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/MergeSegRow.html","id":null,"dir":"Reference","previous_headings":"","what":"Merge Adjacent Copy Number Segments Based on Similarity Criteria ‚Äî MergeSegRow","title":"Merge Adjacent Copy Number Segments Based on Similarity Criteria ‚Äî MergeSegRow","text":"Iteratively merges adjacent rows data frame copy number segments meet criteria defined MergeSegCheck. merged segments, segment greater number probes provides call, segment mean, count, baseline coverage.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/MergeSegRow.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Merge Adjacent Copy Number Segments Based on Similarity Criteria ‚Äî MergeSegRow","text":"","code":"MergeSegRow(df, mergecov)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/MergeSegRow.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Merge Adjacent Copy Number Segments Based on Similarity Criteria ‚Äî MergeSegRow","text":"df data frame tibble copy number segments, columns Sample, Chromosome, Start, End, Num_Probes, Call, Segment_Mean, etc. mergecov Numeric threshold merging segment mean value.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/MergeSegRow.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Merge Adjacent Copy Number Segments Based on Similarity Criteria ‚Äî MergeSegRow","text":"data frame tibble merged segments updated segment information.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/MergeSegRow.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Merge Adjacent Copy Number Segments Based on Similarity Criteria ‚Äî MergeSegRow","text":"function uses MergeSegCheck determine two adjacent segments merged.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/ModelSource.html","id":null,"dir":"Reference","previous_headings":"","what":"Determine Model Source Based on MAF and Coverage Information ‚Äî ModelSource","title":"Determine Model Source Based on MAF and Coverage Information ‚Äî ModelSource","text":"Determines whether model source segment \"Coverage\", \"Diploid\", \"Coverage + MAF\", based MAF segment mean values.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/ModelSource.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Determine Model Source Based on MAF and Coverage Information ‚Äî ModelSource","text":"","code":"ModelSource(seg_df, modelminprobes)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/ModelSource.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Determine Model Source Based on MAF and Coverage Information ‚Äî ModelSource","text":"seg_df data frame tibble containing segment information, including columns: size, FILTER, MAF_Probes, MAF, Segment_Mean. modelminprobes Numeric. minimum number probes segment include model decision","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/ModelSource.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Determine Model Source Based on MAF and Coverage Information ‚Äî ModelSource","text":"Character. One \"Coverage\", \"Diploid\", \"Coverage + MAF\".","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/ModelSource.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Determine Model Source Based on MAF and Coverage Information ‚Äî ModelSource","text":"segments sufficient probes minimum MAF > 0.4 maximum absolute segment mean >= 0.2, returns \"Coverage\". segments sufficient probes minimum MAF > 0.4 maximum absolute segment mean < 0.2, returns \"Diploid\". Otherwise, returns \"Coverage + MAF\".","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/ModelSource.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Determine Model Source Based on MAF and Coverage Information ‚Äî ModelSource","text":"","code":"# seg_df must have columns: size, FILTER, MAF_Probes, MAF, Segment_Mean # ModelSource(seg_df, modelminprobes)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/PONAIprocess.html","id":null,"dir":"Reference","previous_headings":"","what":"Process Panel of Normal AI Files and Estimate Beta-binomial Dispersion based on the depth ‚Äî PONAIprocess","title":"Process Panel of Normal AI Files and Estimate Beta-binomial Dispersion based on the depth ‚Äî PONAIprocess","text":"Reads bins allelic imbalance (AI) data panel normal (PoN), summarizes bin-level statistics, estimates beta-binomial dispersion (theta) downstream modeling.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/PONAIprocess.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Process Panel of Normal AI Files and Estimate Beta-binomial Dispersion based on the depth ‚Äî PONAIprocess","text":"","code":"PONAIprocess(   ai_pon_file,   aitype,   minsnpcov = 20,   output,   prefix,   maxgap = 2e+06,   maxbinsize = 5e+06,   minbinsize = 5e+05,   snpnum = 30,   gender )"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/PONAIprocess.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Process Panel of Normal AI Files and Estimate Beta-binomial Dispersion based on the depth ‚Äî PONAIprocess","text":"ai_pon_file Character. Path text file listing PoN AI file paths (one per line). aitype Character. Type AI input file (passed ReadPonAI(), e.g., \"gatk\", \"dragen\", \"\"). minsnpcov Integer. Minimum SNP coverage include site AI calculation. (default: 20) output Character. Output directory processed PoN AI Rdata file. prefix Character. Prefix output file. maxgap Numeric. Maximum allowed gap SNPs within bin. (default: 2000000) maxbinsize Numeric. Maximum allowed bin size (bp). (default: 5000000) minbinsize Numeric. Minimum allowed bin size (bp). (default: 500000) snpnum Integer. Target number SNPs per bin. (default: ) gender Character. Gender sample \"male\" \"female\".","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/PONAIprocess.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Process Panel of Normal AI Files and Estimate Beta-binomial Dispersion based on the depth ‚Äî PONAIprocess","text":"Invisibly returns NULL. Saves Rdata file containing processed PoN reference (pon_ref) estimated dispersion parameters (theta_fit).","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/PONAIprocess.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Process Panel of Normal AI Files and Estimate Beta-binomial Dispersion based on the depth ‚Äî PONAIprocess","text":"function reads PoN AI files, bins AI data using BinMaf(), summarizes bin-level BAF/MAF depth statistics, estimates beta-binomial -dispersion (theta) stratified depth. reference table theta estimates saved Rdata file use downstream analysis.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/ParseParm.html","id":null,"dir":"Reference","previous_headings":"","what":"Parse and Select Purity and Scale Factor Parameters from Model Grid ‚Äî ParseParm","title":"Parse and Select Purity and Scale Factor Parameters from Model Grid ‚Äî ParseParm","text":"Selects best-matching purity scale factor (dicovsf) grid models, based user input (value range), returns optimal combination downstream analysis.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/ParseParm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Parse and Select Purity and Scale Factor Parameters from Model Grid ‚Äî ParseParm","text":"","code":"ParseParm(purity, dicovsf, models)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/ParseParm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Parse and Select Purity and Scale Factor Parameters from Model Grid ‚Äî ParseParm","text":"purity Numeric, character, NULL. Desired purity value, range format \"min:max\" (e.g., \"0.5:0.7\"). NULL, available purity values models considered. dicovsf Numeric, character, NULL. Desired scale factor (mu), range format \"min:max\" (e.g., \"0.9:1.1\"). NULL, available scale factor values models considered. models Data frame tibble. Model grid columns rho (purity), mu (scale factor), total_distance_to_integer, total_log_likelihood generated initial run.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/ParseParm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Parse and Select Purity and Scale Factor Parameters from Model Grid ‚Äî ParseParm","text":"named list elements: final_purity Selected purity value. final_sf Selected scale factor (mu) value.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/ParseParm.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Parse and Select Purity and Scale Factor Parameters from Model Grid ‚Äî ParseParm","text":"range provided purity dicovsf, models within range considered. single value provided, closest available value models selected. model lowest total_distance_to_integer highest total_log_likelihood chosen.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/ParseParm.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Parse and Select Purity and Scale Factor Parameters from Model Grid ‚Äî ParseParm","text":"","code":"# ParseParm(purity = \"0.5:0.7\", dicovsf = NULL, models = models_df) # ParseParm(purity = 0.6, dicovsf = 1.1, models = models_df)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/PlotCov.html","id":null,"dir":"Reference","previous_headings":"","what":"Multi-panel Plot of Copy Number, BAF, Clonality, and Quality Across Chromosomes ‚Äî PlotCov","title":"Multi-panel Plot of Copy Number, BAF, Clonality, and Quality Across Chromosomes ‚Äî PlotCov","text":"Produces summary plot four panels: copy number, BAF, clonality, segment quality, faceted chromosome.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/PlotCov.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Multi-panel Plot of Copy Number, BAF, Clonality, and Quality Across Chromosomes ‚Äî PlotCov","text":"","code":"PlotCov(df_cov, df_ai, call_seg, whitelist, gender, prefix, purity)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/PlotCov.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Multi-panel Plot of Copy Number, BAF, Clonality, and Quality Across Chromosomes ‚Äî PlotCov","text":"df_cov Data frame tibble. Smoothed coverage data, must include columns seqnames, start, end, smoothed_bin_cnf. df_ai Data frame tibble. Smoothed AI data, must include columns seqnames, bin_start, smoothed_ai. call_seg Data frame tibble. Segment calls, must include columns seqnames, loc.start, loc.end, CN, MAF, ccf_final, FILTER. whitelist Data frame tibble. Whitelist regions, must include columns seqnames, start, end. gender Character. Sample gender (\"male\" \"female\"). prefix Character. Plot title output prefix. purity Numeric. Tumor purity (directly used plot, included compatibility).","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/PlotCov.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Multi-panel Plot of Copy Number, BAF, Clonality, and Quality Across Chromosomes ‚Äî PlotCov","text":"grob object (gridExtra::grid.arrange) representing combined plot.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/PlotCov.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Multi-panel Plot of Copy Number, BAF, Clonality, and Quality Across Chromosomes ‚Äî PlotCov","text":"","code":"# PlotCov(df_cov, df_ai, call_seg, whitelist, gender = \"female\", prefix = \"Sample1\", purity = 0.7)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/PlotCovDisCN.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot Coverage Distance to Integer Copy Number vs. Purity ‚Äî PlotCovDisCN","title":"Plot Coverage Distance to Integer Copy Number vs. Purity ‚Äî PlotCovDisCN","text":"Plots distance integer copy number (dis_integer_CN) function purity (rho), minimum distance point highlighted.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/PlotCovDisCN.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot Coverage Distance to Integer Copy Number vs. Purity ‚Äî PlotCovDisCN","text":"","code":"PlotCovDisCN(dis, purity, min_dis, prefix, out_dir)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/PlotCovDisCN.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot Coverage Distance to Integer Copy Number vs. Purity ‚Äî PlotCovDisCN","text":"dis Data frame tibble. Must include columns rho dis_integer_CN. purity Numeric. selected purity value highlight. min_dis Numeric. minimum distance integer copy number highlight. prefix Character. Output file prefix. out_dir Character. Output directory saving plot.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/PlotCovDisCN.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot Coverage Distance to Integer Copy Number vs. Purity ‚Äî PlotCovDisCN","text":"Invisibly returns ggplot object (FALSE plotting failed). plot saved PNG file output directory.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/PlotCovDisCN.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot Coverage Distance to Integer Copy Number vs. Purity ‚Äî PlotCovDisCN","text":"","code":"# PlotCovDisCN(dis, purity = 0.7, min_dis = 2, prefix = \"Sample1\", out_dir = \"results/\")"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/PlotLikelihoodAndDistance.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot Model Likelihood and Distance Clusters as an Interactive Heatmap ‚Äî PlotLikelihoodAndDistance","title":"Plot Model Likelihood and Distance Clusters as an Interactive Heatmap ‚Äî PlotLikelihoodAndDistance","text":"Plots interactive heatmap total likelihood cluster assignments, best model highlighted, saves HTML file.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/PlotLikelihoodAndDistance.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot Model Likelihood and Distance Clusters as an Interactive Heatmap ‚Äî PlotLikelihoodAndDistance","text":"","code":"PlotLikelihoodAndDistance(df, Final_model, opt)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/PlotLikelihoodAndDistance.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot Model Likelihood and Distance Clusters as an Interactive Heatmap ‚Äî PlotLikelihoodAndDistance","text":"df Data frame tibble. Must include columns mu, rho, total_likelihood_cluster, diploid_distance_cluster, nondiploid_distance_cluster. Final_model List. Output ClusterModels, must include Final_mu Final_rho. opt List options. Must include out_dir prefix.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/PlotLikelihoodAndDistance.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot Model Likelihood and Distance Clusters as an Interactive Heatmap ‚Äî PlotLikelihoodAndDistance","text":"Invisibly returns interactive plotly object (FALSE plotting failed).","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/PlotLikelihoodAndDistance.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot Model Likelihood and Distance Clusters as an Interactive Heatmap ‚Äî PlotLikelihoodAndDistance","text":"","code":"# PlotLikelihoodAndDistance(df, Final_model, opt)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/PlotModel.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot Model Total Log-Likelihoods as a Heatmap ‚Äî PlotModel","title":"Plot Model Total Log-Likelihoods as a Heatmap ‚Äî PlotModel","text":"Plots heatmap total log-likelihoods (mu, rho) combinations highlights selected model.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/PlotModel.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot Model Total Log-Likelihoods as a Heatmap ‚Äî PlotModel","text":"","code":"PlotModel(data, prefix, out_dir, max_L_mu, max_L_rho)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/PlotModel.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot Model Total Log-Likelihoods as a Heatmap ‚Äî PlotModel","text":"data Data frame tibble. Must include columns rho, mu, total_log_likelihood_before_refine. prefix Character. Output file prefix. out_dir Character. Output directory saving plot. max_L_mu Numeric. selected value mutation multiplicity (mu) highlight. max_L_rho Numeric. selected value tumor purity (rho) highlight.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/PlotModel.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot Model Total Log-Likelihoods as a Heatmap ‚Äî PlotModel","text":"Invisibly returns ggplot object (FALSE plotting failed).","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/PlotModel.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot Model Total Log-Likelihoods as a Heatmap ‚Äî PlotModel","text":"","code":"# PlotModel(data, opt, max_L_mu = 1, max_L_rho = 0.7)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/PlotModelDot.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot Model Total Log-Likelihoods as a Dot Plot ‚Äî PlotModelDot","title":"Plot Model Total Log-Likelihoods as a Dot Plot ‚Äî PlotModelDot","text":"Plots total log-likelihood model dot plot, tier 1 index highlighted vertical dashed line.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/PlotModelDot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot Model Total Log-Likelihoods as a Dot Plot ‚Äî PlotModelDot","text":"","code":"PlotModelDot(models, prefix, out_dir, tier1_index)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/PlotModelDot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot Model Total Log-Likelihoods as a Dot Plot ‚Äî PlotModelDot","text":"models Data frame tibble. Must include total_log_likelihood column. prefix Character. Output file prefix. out_dir Character. Output directory saving plot. tier1_index Integer. index (rank) tier 1 model highlight.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/PlotModelDot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot Model Total Log-Likelihoods as a Dot Plot ‚Äî PlotModelDot","text":"Invisibly returns ggplot object (FALSE plotting failed). plot saved PNG file output directory.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/PlotModelDot.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot Model Total Log-Likelihoods as a Dot Plot ‚Äî PlotModelDot","text":"","code":"# PlotModelDot(models, prefix = \"Sample1\", out_dir = \"results/\", tier1_index = 10)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/PlotModelcluster.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot all CNV calls under each Tier1 models ‚Äî PlotModelcluster","title":"Plot all CNV calls under each Tier1 models ‚Äî PlotModelcluster","text":"Generates interactive plot (HTML) clustered CNV models, showing copy number profiles Tier 1 models. y-axis represents model IDs (clustered CNV profile similarity), x-axis shows genomic coordinates, color indicates copy number (CN). Tooltip text provides model summary statistics.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/PlotModelcluster.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot all CNV calls under each Tier1 models ‚Äî PlotModelcluster","text":"","code":"PlotModelcluster(models, refined_calls, out_dir, prefix)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/PlotModelcluster.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot all CNV calls under each Tier1 models ‚Äî PlotModelcluster","text":"models Data frame model likelihood results. Must include columns mu, rho, Tier1, summary statistics (total_likelihood_cluster, diploid_distance_cluster, nondiploid_distance_cluster). refined_calls Data frame segment calls. Must include columns Chromosome, Start, End, CN, mu, rho. out_dir Character. Output directory HTML plot. prefix Character. Prefix output file name.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/PlotModelcluster.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot all CNV calls under each Tier1 models ‚Äî PlotModelcluster","text":"Invisibly returns TRUE plot successfully created saved, otherwise returns FALSE.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/PlotModelcluster.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Plot all CNV calls under each Tier1 models ‚Äî PlotModelcluster","text":"function filters Tier 1 models, clusters CNV profile similarity, generates interactive heatmap using ggplot2 plotly. plot saved HTML file out_dir.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/PlotModelcluster.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot all CNV calls under each Tier1 models ‚Äî PlotModelcluster","text":"","code":"if (FALSE) { # \\dontrun{ PlotModelcluster(   models = models_df,   refined_calls = calls_df,   out_dir = \"results/\",   prefix = \"sample1\" ) } # }"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/PonProcess.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate Whitelist, Blacklist, and Cytoband-Detectable Edge Files from GATK PoN HDF5 ‚Äî PonProcess","title":"Generate Whitelist, Blacklist, and Cytoband-Detectable Edge Files from GATK PoN HDF5 ‚Äî PonProcess","text":"Processes GATK Panel Normals (PoN) HDF5 file extract final intervals (whitelist) excluded regions (blacklist), outputs BED files. Also creates cytoband-detectable edge file overlapping whitelist intervals cytoband annotations define p q arm coverage.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/PonProcess.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate Whitelist, Blacklist, and Cytoband-Detectable Edge Files from GATK PoN HDF5 ‚Äî PonProcess","text":"","code":"PonProcess(   pon_file,   blacklist_bed,   whitelist_bed,   cytoband,   detectable_edge,   gender )"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/PonProcess.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate Whitelist, Blacklist, and Cytoband-Detectable Edge Files from GATK PoN HDF5 ‚Äî PonProcess","text":"pon_file Character. Path GATK PoN HDF5 file. blacklist_bed Character. Output file path blacklist BED file (intervals excluded panel). whitelist_bed Character. Output file path whitelist BED file (final intervals retained panel). cytoband Character. Path cytoband annotation file columns: chrom, chromStart, chromEnd, name, gieStain. detectable_edge Character. Output file path cytoband-detectable edge file, used downstream annotation. gender Character. female male. Gender GATK PON file. Mixed gender supported.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/PonProcess.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate Whitelist, Blacklist, and Cytoband-Detectable Edge Files from GATK PoN HDF5 ‚Äî PonProcess","text":"Invisibly returns list containing data frames: blacklist, whitelist, cytoband_edge.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/PonProcess.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Generate Whitelist, Blacklist, and Cytoband-Detectable Edge Files from GATK PoN HDF5 ‚Äî PonProcess","text":"function calls FindCytoband, must available package namespace. function performs following: Reads original final intervals PoN file maps contig indices chromosome names. Writes whitelist BED file intervals retained CNV calling. Writes blacklist BED file intervals filtered GATK PoN processing. Generates cytoband-detectable edge file intersecting whitelist intervals cytoband annotations, summarizing detectable p q arm boundaries per chromosome.","code":""},{"path":[]},{"path":"https://sj-cmpb-se.github.io/XploR/reference/PonProcess.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Generate Whitelist, Blacklist, and Cytoband-Detectable Edge Files from GATK PoN HDF5 ‚Äî PonProcess","text":"","code":"PonProcess(\"gatk.pon.hdf5\", \"pon_blacklist.bed\", \"pon_whitelist.bed\", \"detectable_edge.bed\", \"cytoband.txt\") #> Error in H5File.open(filename, mode, file_create_pl, file_access_pl): HDF5-API Errors: #>     error #000: ../../src/hdf5-1.12.2/src/H5F.c in H5Fopen(): line 620: unable to open file #>         class: HDF5 #>         major: File accessibility #>         minor: Unable to open file #>  #>     error #001: ../../src/hdf5-1.12.2/src/H5VLcallback.c in H5VL_file_open(): line 3502: failed to iterate over available VOL connector plugins #>         class: HDF5 #>         major: Virtual Object Layer #>         minor: Iteration failed #>  #>     error #002: ../../src/hdf5-1.12.2/src/H5PLpath.c in H5PL__path_table_iterate(): line 579: can't iterate over plugins in plugin path '(null)' #>         class: HDF5 #>         major: Plugin for dynamically loaded library #>         minor: Iteration failed #>  #>     error #003: ../../src/hdf5-1.12.2/src/H5PLpath.c in H5PL__path_table_iterate_process_path(): line 620: can't open directory: /usr/local/hdf5/lib/plugin #>         class: HDF5 #>         major: Plugin for dynamically loaded library #>         minor: Can't open directory or file #>  #>     error #004: ../../src/hdf5-1.12.2/src/"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/ReadAI.html","id":null,"dir":"Reference","previous_headings":"","what":"Read and Standardize Allelic Imbalance Data ‚Äî ReadAI","title":"Read and Standardize Allelic Imbalance Data ‚Äî ReadAI","text":"Reads allelic imbalance (AI) data different input formats standardizes output.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/ReadAI.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Read and Standardize Allelic Imbalance Data ‚Äî ReadAI","text":"","code":"ReadAI(aitype, ballele, minsnpcov, gender)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/ReadAI.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Read and Standardize Allelic Imbalance Data ‚Äî ReadAI","text":"aitype Character. Type AI input file. Supported values : \"gatk\": Tab-separated file columns Chromosome, Pos, REF_NUCLEOTIDE, ALT_NUCLEOTIDE, REF_COUNT, ALT_COUNT. \"dragen\": input must include columns contig, start, stop, refAllele, allele1, allele2, allele1Count, allele2Count, allele1AF, allele2AF. \"\": Tab-separated file columns Chromosome, Pos, REF_NUCLEOTIDE, ALT_NUCLEOTIDE, REF_COUNT, ALT_COUNT. ballele Character. Path input allelic count file. minsnpcov Numeric, minimum coverage SNPs included (default: 20). gender Character. Sample gender, either \"female\" \"male\". value passed ReadAI().","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/ReadAI.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Read and Standardize Allelic Imbalance Data ‚Äî ReadAI","text":"data frame columns Chromosome, Pos, ref_count, alt_count maf, containing autosomal positions (Chromosome X Y), minor allele frequency (maf) 0 0.5.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/ReadAI.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Read and Standardize Allelic Imbalance Data ‚Äî ReadAI","text":"","code":"if (FALSE) { # \\dontrun{ # Read AI data from a count file maf_df <- ReadAI(\"gatk\", \"sample.allele_counts\", 20, \"female\")  # Read AI data from a DRAGEN file maf_df <- ReadAI(\"dragen\", \"sample_dragen.tumor.ballele.counts.gz\",20, \"female\")  # Read AI data from a BAF file maf_df <- ReadAI(\"other\", \"sample.tsv\",20, \"female\") } # }"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/ReadPonAI.html","id":null,"dir":"Reference","previous_headings":"","what":"Read and Combine Panel of Normal AI Files ‚Äî ReadPonAI","title":"Read and Combine Panel of Normal AI Files ‚Äî ReadPonAI","text":"Reads multiple allelic imbalance (AI) files panel normal (PoN), processes combines results single data frame.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/ReadPonAI.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Read and Combine Panel of Normal AI Files ‚Äî ReadPonAI","text":"","code":"ReadPonAI(ai_pon_file, aitype, minsnpcov, gender)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/ReadPonAI.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Read and Combine Panel of Normal AI Files ‚Äî ReadPonAI","text":"ai_pon_file Character. Path text file listing paths PoN AI files (one file path per line). aitype Character. Type AI input file. Passed ReadAI() (e.g., \"gatk\", \"dragen\", \"\"). minsnpcov Integer. Minimum SNP coverage include site AI calculation. Passed ReadAI(). gender Character. Sample gender, either \"female\" \"male\". value passed ReadAI().","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/ReadPonAI.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Read and Combine Panel of Normal AI Files ‚Äî ReadPonAI","text":"data frame combining AI data PoN files.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/ReadPonAI.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Read and Combine Panel of Normal AI Files ‚Äî ReadPonAI","text":"file path listed ai_pon_file read processed using ReadAI(), resulting data frames combined row.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/RefineCalls.html","id":null,"dir":"Reference","previous_headings":"","what":"Refine Segment Calls According to the Final Model ‚Äî RefineCalls","title":"Refine Segment Calls According to the Final Model ‚Äî RefineCalls","text":"Refines values calls segment based selected (mu, rho) model, adjusting segment mean, purity, copy number calls.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/RefineCalls.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Refine Segment Calls According to the Final Model ‚Äî RefineCalls","text":"","code":"RefineCalls(df, max_L_mu, max_L_rho, gender)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/RefineCalls.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Refine Segment Calls According to the Final Model ‚Äî RefineCalls","text":"df Data frame tibble. Segment call data, must include columns used refinement. max_L_mu Numeric. selected value mutation multiplicity (mu). max_L_rho Numeric. selected value tumor purity (rho). gender Character. Gender female male.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/RefineCalls.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Refine Segment Calls According to the Final Model ‚Äî RefineCalls","text":"data frame tibble refined segment calls, ordered chromosome start position.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/RefineCalls.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Refine Segment Calls According to the Final Model ‚Äî RefineCalls","text":"","code":"# RefineCalls(df, max_L_mu = 1, max_L_rho = 0.7, gender = \"female\")"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/RefineCallsSecond.html","id":null,"dir":"Reference","previous_headings":"","what":"Second Refinement of Segment Calls for Coverage/AI Profile Mismatches ‚Äî RefineCallsSecond","title":"Second Refinement of Segment Calls for Coverage/AI Profile Mismatches ‚Äî RefineCallsSecond","text":"refines segment calls coverage profile allelic imbalance (AI) profile match, considering alternative copy number states updating calls expected values.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/RefineCallsSecond.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Second Refinement of Segment Calls for Coverage/AI Profile Mismatches ‚Äî RefineCallsSecond","text":"","code":"RefineCallsSecond(df, results, final_mu, final_rho, gender, callcov)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/RefineCallsSecond.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Second Refinement of Segment Calls for Coverage/AI Profile Mismatches ‚Äî RefineCallsSecond","text":"df Data frame tibble. Refined segment calls (see RefineCalls), must include columns col_name. results Data frame tibble. likelihood results possible copy number states, must include columns rho, mu, index, CN, etc. final_mu Numeric. selected value scale factor (mu). final_rho Numeric. selected value tumor purity (rho). gender Character. Sample gender (\"male\" \"female\"). callcov Numeric. Subclonal events calling cutoff based coverage.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/RefineCallsSecond.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Second Refinement of Segment Calls for Coverage/AI Profile Mismatches ‚Äî RefineCallsSecond","text":"data frame tibble refined segment calls, including updated columns ccf_COV, ccf_final, CN_mix.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/RefineCallsSecond.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Second Refinement of Segment Calls for Coverage/AI Profile Mismatches ‚Äî RefineCallsSecond","text":"Segments discordant coverage AI profiles re-evaluated searching alternative copy number states likelihood results, calls updated accordingly.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/RefineCallsSecond.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Second Refinement of Segment Calls for Coverage/AI Profile Mismatches ‚Äî RefineCallsSecond","text":"","code":"# RefineCallsSecond(df, results, final_mu = 1, final_rho = 0.7, gender = \"female\", callcov = 0.3)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/RefineTier1Models.html","id":null,"dir":"Reference","previous_headings":"","what":"Refine Tier 1 Models and Their Segment Calls ‚Äî RefineTier1Models","title":"Refine Tier 1 Models and Their Segment Calls ‚Äî RefineTier1Models","text":"candidate (mu, rho) model tier1, extracts refines segment calls, computes fit statistics, returns list calls model summaries.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/RefineTier1Models.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Refine Tier 1 Models and Their Segment Calls ‚Äî RefineTier1Models","text":"","code":"RefineTier1Models(   tier1,   results,   top_likelihood_rows,   likelihood_min,   seg,   modelminprobes,   gender,   callcov,   modelminAIsize )"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/RefineTier1Models.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Refine Tier 1 Models and Their Segment Calls ‚Äî RefineTier1Models","text":"tier1 Data frame tibble. row candidate model columns mu rho. results Data frame tibble. full set segment likelihoods/results. top_likelihood_rows Data frame tibble. Top likelihood calls segment. likelihood_min Numeric. minimum log-likelihood value use penalty. seg Data frame tibble. Segment information. modelminprobes Integer. Minimum number probes model inclusion. gender Character. Sample gender (\"male\" \"female\"). callcov Numeric. Subclonal events calling cutoff based CNF. modelminAIsize Numeric. Minimum segment size model inclusion.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/RefineTier1Models.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Refine Tier 1 Models and Their Segment Calls ‚Äî RefineTier1Models","text":"list length equal nrow(tier1). element list : calls Refined segment calls model. model Summary statistics model (data.frame).","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/RefineTier1Models.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Refine Tier 1 Models and Their Segment Calls ‚Äî RefineTier1Models","text":"(mu, rho) combination, extracts refines calls, computes distances integer copy number, ploidy, likelihoods, summarizes results.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/RefineTier1Models.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Refine Tier 1 Models and Their Segment Calls ‚Äî RefineTier1Models","text":"","code":"# RefineTier1Models(tier1, results, top_likelihood_rows, likelihood_min, seg, modelminprobes = 20, gender = \"female\", callcov = 0.3, modelminAIsize = 500000)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/RerunCNV.html","id":null,"dir":"Reference","previous_headings":"","what":"Rerun CNV Calling with User-Defined Purity and Size Factor or Diploid Region ‚Äî RerunCNV","title":"Rerun CNV Calling with User-Defined Purity and Size Factor or Diploid Region ‚Äî RerunCNV","text":"Allows users rerun copy number variant (CNV) calling custom purity scale factor (size factor) values, specifying diploid region normalization.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/RerunCNV.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Rerun CNV Calling with User-Defined Purity and Size Factor or Diploid Region ‚Äî RerunCNV","text":"","code":"RerunCNV(   seg,   input,   models,   call,   gender,   callcov = 0.3,   dicovsf = NULL,   purity = NULL,   chromosome = NULL,   start = NULL,   end = NULL,   mode = NULL,   out_file )"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/RerunCNV.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Rerun CNV Calling with User-Defined Purity and Size Factor or Diploid Region ‚Äî RerunCNV","text":"seg Character. Path AI segment file (e.g., *_GATK_AI_segment.tsv). input Character. Path top likelihood row file (e.g., *_top_likelihood_calls.tsv). models Character. Path model likelihood file (e.g., *_Models_likelihood.tsv). call Character. Path final call file. gender Character. Sample gender, either \"male\" \"female\". callcov Numeric. Subclonal events calling cutoff based coverage. dicovsf Numeric character. Desired scale factor range (e.g., 0.9, \"0.9:1.1\"). Optional. purity Numeric character. Desired purity range (e.g., 0.5, \"0.5:0.7\"). Optional. chromosome Character. Chromosome diploid region (e.g., \"1\", \"X\"). Optional. start Integer. Start position diploid region. Optional. end Integer. End position diploid region. Optional. mode Character. Rerun mode: either \"model\" \"region\". out_file Character. Output file path final calls.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/RerunCNV.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Rerun CNV Calling with User-Defined Purity and Size Factor or Diploid Region ‚Äî RerunCNV","text":"Invisibly returns final call data frame.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/RerunCNV.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Rerun CNV Calling with User-Defined Purity and Size Factor or Diploid Region ‚Äî RerunCNV","text":"mode = \"region\", chromosome must set. chromosome start provided, region spans start end chromosome. chromosome end provided, region spans start chromosome end. start end given, user-defined region used. mode = \"model\", least one dicovsf purity must set. can specified single values ranges (e.g., \"0.9:1.1\"). function enables re-calling CNV segments using user-specified purity /size factor (SF), defining diploid region normalization. supports \"model\" \"region\" rerun modes. resulting calls written out_file.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/RerunCNV.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Rerun CNV Calling with User-Defined Purity and Size Factor or Diploid Region ‚Äî RerunCNV","text":"","code":"if (FALSE) { # \\dontrun{ # Rerun using a specific purity and size factor RerunCNV(   seg = \"sample_GATK_AI_segment.tsv\",   input = \"sample_top_likelihood_calls.tsv\",   models = \"sample_Models_likelihood.tsv\",   call = \"sample_final_call.tsv\",   gender = \"female\",   dicovsf = \"0.95:1.05\",   purity = \"0.6:0.8\",   mode = \"model\",   out_file = \"sample_final_call_refined.tsv\" )  # Rerun using a user-defined diploid region RerunCNV(   seg = \"sample_GATK_AI_segment.tsv\",   input = \"sample_top_likelihood_calls.tsv\",   models = \"sample_Models_likelihood.tsv\",   call = \"sample_final_call.tsv\",   gender = \"male\",   chromosome = \"3\",   start = 1e6,   end = 5e7,   mode = \"region\",   out_file = \"sample_final_call_refined.tsv\" ) } # }"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/RoundAI.html","id":null,"dir":"Reference","previous_headings":"","what":"Round BAF Values into 20 Bins ‚Äî RoundAI","title":"Round BAF Values into 20 Bins ‚Äî RoundAI","text":"chromosome, rounds B-allele frequency (BAF, af) values 20 bins (increments 0.05).","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/RoundAI.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Round BAF Values into 20 Bins ‚Äî RoundAI","text":"","code":"RoundAI(ai)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/RoundAI.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Round BAF Values into 20 Bins ‚Äî RoundAI","text":"ai list data frames tibbles, one per chromosome. must include columns af, contig, start, stop, allele1Count, allele2Count.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/RoundAI.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Round BAF Values into 20 Bins ‚Äî RoundAI","text":"data frame columns: contig, start, stop, allele1Count, allele2Count, norm_af.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/RoundAI.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Round BAF Values into 20 Bins ‚Äî RoundAI","text":"BAF values (af) rounded nearest 0.05. Output single data frame combining chromosomes.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/RoundAI.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Round BAF Values into 20 Bins ‚Äî RoundAI","text":"","code":"# ai_list <- list(chr1 = data.frame(af = runif(10), contig = \"1\", start = 1:10, stop = 11:20, allele1Count = 1:10, allele2Count = 11:20)) # RoundAI(ai_list)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/RunCallikelihood.html","id":null,"dir":"Reference","previous_headings":"","what":"Run Likelihood Calculation Across All Purity and Scale Factor Combinations ‚Äî RunCallikelihood","title":"Run Likelihood Calculation Across All Purity and Scale Factor Combinations ‚Äî RunCallikelihood","text":"combination purity scale factor purity_sf, computes segment likelihoods segments data using specified model parameters.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/RunCallikelihood.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Run Likelihood Calculation Across All Purity and Scale Factor Combinations ‚Äî RunCallikelihood","text":"","code":"RunCallikelihood(   purity_sf,   data,   sigma_C,   lambda = 1,   gamma = 1,   epsilon = 0.01 )"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/RunCallikelihood.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Run Likelihood Calculation Across All Purity and Scale Factor Combinations ‚Äî RunCallikelihood","text":"purity_sf Data frame tibble. Grid purity scale factor values evaluate; must include columns mu rho. data Data frame tibble. Segment data (see Callikelihood required columns). sigma_C Numeric. Parameter segment likelihood (passed Callikelihood).","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/RunCallikelihood.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Run Likelihood Calculation Across All Purity and Scale Factor Combinations ‚Äî RunCallikelihood","text":"data frame likelihoods segment (mu, rho) combination, NA minor alleles removed NA ccf values set 1.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/RunCallikelihood.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Run Likelihood Calculation Across All Purity and Scale Factor Combinations ‚Äî RunCallikelihood","text":"","code":"# RunCallikelihood(purity_sf, data, sigma_C = 0.1, lambda = 1, gamma = 1, epsilon = 0.01)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/RunExamplePipeline.html","id":null,"dir":"Reference","previous_headings":"","what":"Run XploR Example Pipeline ‚Äî RunExamplePipeline","title":"Run XploR Example Pipeline ‚Äî RunExamplePipeline","text":"Runs XploR pipeline bundled example data writes results temporary directory (user-specified directory).","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/RunExamplePipeline.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Run XploR Example Pipeline ‚Äî RunExamplePipeline","text":"","code":"RunExamplePipeline(out_dir)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/RunExamplePipeline.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Run XploR Example Pipeline ‚Äî RunExamplePipeline","text":"out_dir Output directory results. Defaults temporary directory.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/RunExamplePipeline.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Run XploR Example Pipeline ‚Äî RunExamplePipeline","text":"Invisibly returns output directory path.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/Runcheckgender.html","id":null,"dir":"Reference","previous_headings":"","what":"Run automatic gender detection ‚Äî Runcheckgender","title":"Run automatic gender detection ‚Äî Runcheckgender","text":"Detects sample gender based coverage segmentation data, returns predicted gender. gender information missing set \"unknown\", function infer gender automatically.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/Runcheckgender.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Run automatic gender detection ‚Äî Runcheckgender","text":"","code":"Runcheckgender(cov, seg, gender, out_dir, prefix)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/Runcheckgender.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Run automatic gender detection ‚Äî Runcheckgender","text":"cov Data frame. Coverage data. seg Character. Path segmentation data file. gender Character. Provided gender information; use \"unknown\" trigger automatic detection.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/Runcheckgender.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Run automatic gender detection ‚Äî Runcheckgender","text":"Character. Predicted gender (\"male\" \"female\").","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/SearchBreakpoint.html","id":null,"dir":"Reference","previous_headings":"","what":"Refine Breakpoints Within a Segment Using MAF Data ‚Äî SearchBreakpoint","title":"Refine Breakpoints Within a Segment Using MAF Data ‚Äî SearchBreakpoint","text":"Refines breakpoints within segment using minor allele frequency (MAF) data. enough informative MAF sites present, segment binned can split finer regions using either stepwise merging CBS (circular binary segmentation). Optionally, PON-based bias correction applied resulting segments.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/SearchBreakpoint.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Refine Breakpoints Within a Segment Using MAF Data ‚Äî SearchBreakpoint","text":"","code":"SearchBreakpoint(   seg_row,   maf,   pon_ref,   gender,   mergeai = 0.15,   snpmin = 3,   maxgap = 1e+06,   snpnum = 20,   maxbinsize = 1e+06,   minbinsize = 5e+05,   minsnpcov = 20,   segmethod = \"cbs\",   cbssmooth = \"no\" )"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/SearchBreakpoint.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Refine Breakpoints Within a Segment Using MAF Data ‚Äî SearchBreakpoint","text":"seg_row Data frame row (list tibble row) representing single segment. Must columns: Sample, Chromosome, Start, End, Num_Probes, Segment_Mean, Segment_Mean_raw, Count, Baseline_cov, gatk_gender, pipeline_gender, size. maf Data frame tibble containing MAF data. Must include columns: Chromosome, Pos, maf. pon_ref Data frame. Panel normal reference bias correction (required bias correction step). gender Character. \"female\", X chromosome also proceed. mergeai Numeric. Threshold difference MAF (gmm_mean) adjacent segments allow merging \"merge\" mode segmentation. snpmin Numeric. Minimum SNP count required segment considered separate segment \"merge\" mode segmentation. maxgap Numeric. Maximum allowed gap SNPs within bin. snpnum Integer. Target number SNPs per bin. maxbinsize Numeric. Maximum allowed bin size (bp). minbinsize Numeric. Minimum allowed bin size (bp). minimum segment size \"merge\" mode 2*minbinsize. minsnpcov Integer. Minimum coverage SNP sites included. segmethod Character. Segmentation method use: \"merge\", perform stepwise merging; \"cbs\", perform CBS (circular binary segmentation). cbssmooth Character. using \"cbs\" segmentation method, set \"yes\" apply smoothing segmentation, \"\" skip smoothing.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/SearchBreakpoint.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Refine Breakpoints Within a Segment Using MAF Data ‚Äî SearchBreakpoint","text":"data frame refined segment(s), including updated breakpoints, MAF metrics, BreakpointSource column indicating whether breakpoints post-processed GATK.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/SearchBreakpoint.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Refine Breakpoints Within a Segment Using MAF Data ‚Äî SearchBreakpoint","text":"function first bins MAF data within segment. segmethod = \"merge\", segments merged stepwise based MAF difference SNP count. segmethod = \"cbs\", CBS segmentation performed binned MAF values, optional smoothing. segmentation, bias correction using panel normal can applied. function returns refined segments updated metrics BreakpointSource label.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/SegmentMeanToOriCov.html","id":null,"dir":"Reference","previous_headings":"","what":"Convert Segment Mean to Original Coverage ‚Äî SegmentMeanToOriCov","title":"Convert Segment Mean to Original Coverage ‚Äî SegmentMeanToOriCov","text":"Calculates original coverage segment based segment mean (log2 ratio), gender, chromosome, assumed diploid coverage.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/SegmentMeanToOriCov.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Convert Segment Mean to Original Coverage ‚Äî SegmentMeanToOriCov","text":"","code":"SegmentMeanToOriCov(SM, gender, chromosome, diploid_cov)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/SegmentMeanToOriCov.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Convert Segment Mean to Original Coverage ‚Äî SegmentMeanToOriCov","text":"SM Numeric. segment mean (log2 ratio) CNV analysis. gender Character. Sample gender, either \"male\" \"female\". chromosome Character factor. Chromosome name (e.g., \"1\", \"2\", ..., \"X\", \"Y\"). diploid_cov Numeric. expected coverage diploid region (e.g., 100).","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/SegmentMeanToOriCov.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Convert Segment Mean to Original Coverage ‚Äî SegmentMeanToOriCov","text":"Numeric. estimated original coverage segment.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/SegmentMeanToOriCov.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Convert Segment Mean to Original Coverage ‚Äî SegmentMeanToOriCov","text":"males sex chromosomes (\"X\" \"Y\"), diploid coverage halved. cases, segment mean scaled full diploid coverage.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/SegmentMeanToOriCov.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Convert Segment Mean to Original Coverage ‚Äî SegmentMeanToOriCov","text":"","code":"SegmentMeanToOriCov(SM = 0, gender = \"male\", chromosome = \"X\", diploid_cov = 100) #> [1] 50 SegmentMeanToOriCov(SM = 0.5, gender = \"female\", chromosome = \"3\", diploid_cov = 100) #> [1] 141.4214"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/SelectCallpersegment.html","id":null,"dir":"Reference","previous_headings":"","what":"Select the Most Likely Call per Segment ‚Äî SelectCallpersegment","title":"Select the Most Likely Call per Segment ‚Äî SelectCallpersegment","text":"segment, selects allele combination (major/minor) highest MAF likelihood, special handling subclonal events cases minor allele zero.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/SelectCallpersegment.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Select the Most Likely Call per Segment ‚Äî SelectCallpersegment","text":"","code":"SelectCallpersegment(results)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/SelectCallpersegment.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Select the Most Likely Call per Segment ‚Äî SelectCallpersegment","text":"results data frame tibble containing possible calls segment, columns including: Segcov, MAF, mu, rho, index, major, minor, ccf, MAF_likelihood, Bio_diff, maf_ll, cov_diff, etc.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/SelectCallpersegment.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Select the Most Likely Call per Segment ‚Äî SelectCallpersegment","text":"data frame tibble likely call per segment, including log_MAF_likelihood column.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/SelectCallpersegment.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Select the Most Likely Call per Segment ‚Äî SelectCallpersegment","text":"Assigns minimum likelihood cases MAF_likelihood zero. possible subclonal events present, compares top two likelihoods may select second subclonal event. segments minor == 0, call refined using coverage difference.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/SelectFinalModel.html","id":null,"dir":"Reference","previous_headings":"","what":"Select and Refine the Final CNV Model and Segment Calls ‚Äî SelectFinalModel","title":"Select and Refine the Final CNV Model and Segment Calls ‚Äî SelectFinalModel","text":"Selects best model (mu, rho) combination based total log-likelihood distance integer copy number, refines segment calls, writes results output files.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/SelectFinalModel.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Select and Refine the Final CNV Model and Segment Calls ‚Äî SelectFinalModel","text":"","code":"SelectFinalModel(   results,   top_likelihood_rows,   groupinfo,   prefix,   gender,   out_dir,   model_source,   seg,   callcov,   modelminAIsize,   modelminprobes,   minsf )"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/SelectFinalModel.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Select and Refine the Final CNV Model and Segment Calls ‚Äî SelectFinalModel","text":"results Data frame tiblle. Likelihood results calculated RunCallikelihood function. top_likelihood_rows Data frame tibble. Top likelihood calls segment, including columns mu, rho, log_MAF_likelihood, major, minor, Tag, etc. groupinfo Data frame tibble. Information estimating minimum purity (see EstimateMinPurity). prefix Character. Output file prefix. gender Character. Sample gender (\"male\" \"female\"). out_dir Character. Output directory saving results. model_source Character. Description model source (e.g., \"Coverage\", \"Coverage + MAF\"). seg Data frame tibble. Segment information. callcov Numeric. Subclonal events calling cutoff based coverage. modelminAIsize Numeric. Minimum segment size model inclusion. modelminprobes Integer. Minimum number probes model inclusion. minsf Numeric. Minimum scale factor estimated. default 0.4. range 0~0.4.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/SelectFinalModel.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Select and Refine the Final CNV Model and Segment Calls ‚Äî SelectFinalModel","text":"list : Final_model final selected model (see ClusterModels). models full model table (refinement). refined_calls final calls tier1 models.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/SelectFinalModel.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Select and Refine the Final CNV Model and Segment Calls ‚Äî SelectFinalModel","text":"Refines calls models several selection clustering steps. Writes model table final calls output files specified output directory.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/SelectFinalModel.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Select and Refine the Final CNV Model and Segment Calls ‚Äî SelectFinalModel","text":"","code":"# SelectFinalModel(top_likelihood_rows, groupinfo, prefix = \"Sample1\", gender = \"female\", out_dir = \"results/\",model_source = \"Coverage + MAF\", callcov = 0.3,modelminAIsize=5000000, modelminprobes= 20)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/SelectModelByDis.html","id":null,"dir":"Reference","previous_headings":"","what":"Select Model by Distance to Integer Copy Number ‚Äî SelectModelByDis","title":"Select Model by Distance to Integer Copy Number ‚Äî SelectModelByDis","text":"candidate model tier1, evaluates mean distance integer copy number diploid non-diploid segments, returns summary table sorted total distance.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/SelectModelByDis.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Select Model by Distance to Integer Copy Number ‚Äî SelectModelByDis","text":"","code":"SelectModelByDis(tier1, df, seg, gender)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/SelectModelByDis.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Select Model by Distance to Integer Copy Number ‚Äî SelectModelByDis","text":"tier1 Data frame tibble. row candidate model columns mu, rho, total_log_likelihood, segments_n. df Data frame tibble. segment call likelihoods (see ExtractCall). seg Data frame tibble. Segment information. gender gender options passed RefineCalls.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/SelectModelByDis.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Select Model by Distance to Integer Copy Number ‚Äî SelectModelByDis","text":"data frame one row per model, including columns: mu Mutation multiplicity. rho Tumor purity. total_log_likelihood Total log-likelihood model. segments_n Number segments. diploid_n Number diploid segments. diploid_distance_to_integer Mean distance integer CN diploid segments. nondiploid_n Number non-diploid segments. nondiploid_distance_to_integer Mean distance integer CN non-diploid segments. total_distance_to_integer Sum diploid non-diploid mean distances.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/SmoothAI.html","id":null,"dir":"Reference","previous_headings":"","what":"Smooth AI Bins by Window Size and Downsampling ‚Äî SmoothAI","title":"Smooth AI Bins by Window Size and Downsampling ‚Äî SmoothAI","text":"Smooths allelic imbalance (AI) bins specified window size, keeping 30 data points per bin using frequency-based downsampling.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/SmoothAI.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Smooth AI Bins by Window Size and Downsampling ‚Äî SmoothAI","text":"","code":"SmoothAI(df, ai_binsize, gender)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/SmoothAI.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Smooth AI Bins by Window Size and Downsampling ‚Äî SmoothAI","text":"df Data frame tibble. Must include columns seqnames, start, norm_af. ai_binsize Numeric. Bin size (bases) smoothing. gender Character. Sample gender (\"male\" \"female\"). (Currently used function, included compatibility.)","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/SmoothAI.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Smooth AI Bins by Window Size and Downsampling ‚Äî SmoothAI","text":"data frame columns: seqnames, bin_start, bin_end, smoothed AI values.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/SmoothAI.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Smooth AI Bins by Window Size and Downsampling ‚Äî SmoothAI","text":"Splits data chromosome. bin, keeps 30 values using ai_bin_smooth.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/SmoothAI.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Smooth AI Bins by Window Size and Downsampling ‚Äî SmoothAI","text":"","code":"# SmoothAI(df, ai_binsize = 10000, gender = \"female\")"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/SummarizeMapQC.html","id":null,"dir":"Reference","previous_headings":"","what":"Summarize QC Metrics for a Sample from a DRAGEN run. ‚Äî SummarizeMapQC","title":"Summarize QC Metrics for a Sample from a DRAGEN run. ‚Äî SummarizeMapQC","text":"Reads mapping coverage quality control (QC) files sample, summarizes key metrics, writes summary table output directory.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/SummarizeMapQC.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summarize QC Metrics for a Sample from a DRAGEN run. ‚Äî SummarizeMapQC","text":"","code":"SummarizeMapQC(input_dir, prefix, platform, out_dir)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/SummarizeMapQC.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Summarize QC Metrics for a Sample from a DRAGEN run. ‚Äî SummarizeMapQC","text":"input_dir Character. Path directory containing QC files sample. prefix Character. Sample ID file prefix. platform Character. Sequencing platform, either \"wgs\" (whole genome sequencing) \"targeted\". out_dir Character. Output directory summary table.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/SummarizeMapQC.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Summarize QC Metrics for a Sample from a DRAGEN run. ‚Äî SummarizeMapQC","text":"Invisibly returns data frame containing QC summary metrics.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/SummarizeMapQC.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Summarize QC Metrics for a Sample from a DRAGEN run. ‚Äî SummarizeMapQC","text":"function reads mapping coverage QC files input_dir, extracts key metrics, writes summary table out_dir specified prefix. summary includes metrics relevant specified platform.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/ai_bin_smooth.html","id":null,"dir":"Reference","previous_headings":"","what":"Smooth AI Bin Values by Downsampling to Mode Proportions ‚Äî ai_bin_smooth","title":"Smooth AI Bin Values by Downsampling to Mode Proportions ‚Äî ai_bin_smooth","text":"length input vector greater 30, returns vector 30 values sampled according observed frequency unique value (mode smoothing). Otherwise, returns vector unchanged.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/ai_bin_smooth.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Smooth AI Bin Values by Downsampling to Mode Proportions ‚Äî ai_bin_smooth","text":"","code":"ai_bin_smooth(x)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/ai_bin_smooth.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Smooth AI Bin Values by Downsampling to Mode Proportions ‚Äî ai_bin_smooth","text":"x Numeric character vector. Typically vector rounded AI (e.g., BAF) values.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/ai_bin_smooth.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Smooth AI Bin Values by Downsampling to Mode Proportions ‚Äî ai_bin_smooth","text":"numeric vector, either unchanged (length <= 30) length <= 30, values sampled according observed frequencies.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/ai_bin_smooth.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Smooth AI Bin Values by Downsampling to Mode Proportions ‚Äî ai_bin_smooth","text":"","code":"set.seed(1) x <- sample(c(0.1, 0.2, 0.3, 0.4), 100, replace = TRUE) ai_bin_smooth(x) #>  [1] 0.2 0.2 0.2 0.2 0.2 0.2 0.2 0.2 0.2 0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.3 0.3 #> [20] 0.3 0.3 0.3 0.3 0.3 0.4 0.4 0.4 0.4 0.4 0.4"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/band_plottable_female.html","id":null,"dir":"Reference","previous_headings":"","what":"Non blacklist region for each cytobands binned by 300nt for female. ‚Äî band_plottable_female","title":"Non blacklist region for each cytobands binned by 300nt for female. ‚Äî band_plottable_female","text":"File used plot CNV profile keep non-blacklist region.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/band_plottable_female.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Non blacklist region for each cytobands binned by 300nt for female. ‚Äî band_plottable_female","text":"","code":"band_plottable_female"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/band_plottable_female.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Non blacklist region for each cytobands binned by 300nt for female. ‚Äî band_plottable_female","text":"data frame columns: cytoband cytoband name (character). coordinates coordinates binned 300nt (integer).","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/band_plottable_female.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Non blacklist region for each cytobands binned by 300nt for female. ‚Äî band_plottable_female","text":"DRAGEN","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/band_plottable_male.html","id":null,"dir":"Reference","previous_headings":"","what":"Non blacklist region for each cytobands binned by 300nt for male. ‚Äî band_plottable_male","title":"Non blacklist region for each cytobands binned by 300nt for male. ‚Äî band_plottable_male","text":"File used plot CNV profile keep non-blacklist region.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/band_plottable_male.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Non blacklist region for each cytobands binned by 300nt for male. ‚Äî band_plottable_male","text":"","code":"band_plottable_male"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/band_plottable_male.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Non blacklist region for each cytobands binned by 300nt for male. ‚Äî band_plottable_male","text":"data frame columns: cytoband cytoband name (character). coordinates coordinates binned 300nt (integer).","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/band_plottable_male.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Non blacklist region for each cytobands binned by 300nt for male. ‚Äî band_plottable_male","text":"DRAGEN","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/binbaf.html","id":null,"dir":"Reference","previous_headings":"","what":"Bin MAF Data and Estimate MAF Metrics per Bin ‚Äî binbaf","title":"Bin MAF Data and Estimate MAF Metrics per Bin ‚Äî binbaf","text":"Bins input MAF data fixed-size windows calculates summary metrics (e.g., estimated MAF, nonzero counts) bin.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/binbaf.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Bin MAF Data and Estimate MAF Metrics per Bin ‚Äî binbaf","text":"","code":"binbaf(data, bin_size)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/binbaf.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Bin MAF Data and Estimate MAF Metrics per Bin ‚Äî binbaf","text":"data data frame tibble containing least Chromosome, End, baf columns. bin_size Numeric. bin size use (e.g., 1e6 1Mb bins).","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/binbaf.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Bin MAF Data and Estimate MAF Metrics per Bin ‚Äî binbaf","text":"tibble one row per bin columns: Chromosome Chromosome identifier. bin Bin start coordinate. Start Minimum End value bin. End Maximum End value bin. Estimated_baf List column GMM-based BAF estimation results. nonzero_count Number nonzero BAF values bin. each_baf Semicolon-separated string nonzero BAF values bin. gmm_mean, gmm_weight, gmm_G Unnested BAF GMM metrics.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/blacklist_table.html","id":null,"dir":"Reference","previous_headings":"","what":"Non mapable regions of the genome ‚Äî blacklist_table","title":"Non mapable regions of the genome ‚Äî blacklist_table","text":"table listing genomic intervals known problematic mapping.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/blacklist_table.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Non mapable regions of the genome ‚Äî blacklist_table","text":"","code":"blacklist_table"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/blacklist_table.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Non mapable regions of the genome ‚Äî blacklist_table","text":"data frame columns: chrom Chromosome name (character). start Start coordinate (integer). end End coordinate (integer). tag ignored (character).","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/blacklist_table.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Non mapable regions of the genome ‚Äî blacklist_table","text":"DRAGEN4.2 CNV output *.cnv.excluded_intervals.bed.gz file","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/calculate_gaps.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate Gaps Between Segment and Cytoband-Defined Chromosome Landmarks ‚Äî calculate_gaps","title":"Calculate Gaps Between Segment and Cytoband-Defined Chromosome Landmarks ‚Äî calculate_gaps","text":"Calculates distances (gaps) segment's start end positions defined start end sites p q arms chromosome. acrocentric chromosomes, q arm start end sites considered.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/calculate_gaps.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate Gaps Between Segment and Cytoband-Defined Chromosome Landmarks ‚Äî calculate_gaps","text":"","code":"calculate_gaps(   Chrom,   Start,   End,   p_chromStart,   p_chromEnd,   q_chromStart,   q_chromEnd )"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/calculate_gaps.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate Gaps Between Segment and Cytoband-Defined Chromosome Landmarks ‚Äî calculate_gaps","text":"Chrom Character. Chromosome name (e.g., \"1\", \"X\"). Start Numeric. Segment start position (base pair). End Numeric. Segment end position (base pair). p_chromStart Numeric. Start position p arm detectable region. p_chromEnd Numeric. End position p arm detectable region. q_chromStart Numeric. Start position q arm detectable region. q_chromEnd Numeric. End position q arm detectable region.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/calculate_gaps.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate Gaps Between Segment and Cytoband-Defined Chromosome Landmarks ‚Äî calculate_gaps","text":"named list elements: p_gap_to_tel Gap segment start p arm telomere (NA). p_gap_to_cen Gap segment end p arm centromere (NA). q_gap_to_tel Gap segment end q arm telomere (NA). q_gap_to_cen Gap segment start q arm centromere (NA).","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/calculate_gaps.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Calculate Gaps Between Segment and Cytoband-Defined Chromosome Landmarks ‚Äî calculate_gaps","text":"acrocentric chromosomes, p arm calculations omitted q arm start/end sites considered.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/calculate_gaps.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Calculate Gaps Between Segment and Cytoband-Defined Chromosome Landmarks ‚Äî calculate_gaps","text":"","code":"# calculate_gaps(\"1\", 10000, 50000, 0, 25000, 25001, 100000)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/categorize_K.html","id":null,"dir":"Reference","previous_headings":"","what":"Categorize Beta Distribution K Values ‚Äî categorize_K","title":"Categorize Beta Distribution K Values ‚Äî categorize_K","text":"Categorizes numeric K value (e.g., beta distribution) bins based sample quantiles.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/categorize_K.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Categorize Beta Distribution K Values ‚Äî categorize_K","text":"","code":"categorize_K(K)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/categorize_K.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Categorize Beta Distribution K Values ‚Äî categorize_K","text":"K Numeric vector. K values categorize.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/categorize_K.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Categorize Beta Distribution K Values ‚Äî categorize_K","text":"Integer vector categories, possible values 50, 100, 200, 300, corresponding increasing quantile bins.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/categorize_K.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Categorize Beta Distribution K Values ‚Äî categorize_K","text":"function computes quantiles K (using default quartiles), assigns value category: 50: lowest quantile 100: 2nd quantile 200: 3rd quantile 300: highest quantile","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/categorize_K.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Categorize Beta Distribution K Values ‚Äî categorize_K","text":"","code":"set.seed(1) K <- rbeta(100, 2, 5) categorize_K(K) #>   [1]  50 200  50 200  50 200 300 100 300 200  50  50 300 100 100 300 300 300 #>  [19] 300 300 200  50 300 100 100  50 100 200 300 100 200 100  50 100 100 100 #>  [37] 300 100 100 300 200  50  50 200 300 100 300 200 200  50 100  50 300 100 #>  [55] 100 300 200  50 200  50 200 200  50 300  50  50 200 100 200 200  50 100 #>  [73] 100 300  50 300 200 300 100 200 200 100 300 300 300 200  50 100  50 100 #>  [91]  50 200  50 200  50 300 300 200  50 100"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/clean_homalt.html","id":null,"dir":"Reference","previous_headings":"","what":"Clean Homozygous AI Bins Based on LOH Segments ‚Äî clean_homalt","title":"Clean Homozygous AI Bins Based on LOH Segments ‚Äî clean_homalt","text":"Removes homozygous allelic imbalance (AI) bins overlap LOH (loss heterozygosity) segments.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/clean_homalt.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Clean Homozygous AI Bins Based on LOH Segments ‚Äî clean_homalt","text":"","code":"clean_homalt(rounded_ai, call_seg)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/clean_homalt.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Clean Homozygous AI Bins Based on LOH Segments ‚Äî clean_homalt","text":"rounded_ai Data frame tibble. AI data, must include columns contig, start, stop, allele1Count, allele2Count. call_seg Data frame tibble. Segment calls, must include columns chrom, loc.start, loc.end, MAF.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/clean_homalt.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Clean Homozygous AI Bins Based on LOH Segments ‚Äî clean_homalt","text":"data frame AI bins, homozygous bins outside LOH regions removed.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/clean_homalt.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Clean Homozygous AI Bins Based on LOH Segments ‚Äî clean_homalt","text":"","code":"# clean_homalt(rounded_ai, call_seg)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/correct_purity.html","id":null,"dir":"Reference","previous_headings":"","what":"Correct Copy Ratio and Calculate CNF for Purity and Scale Factor ‚Äî correct_purity","title":"Correct Copy Ratio and Calculate CNF for Purity and Scale Factor ‚Äî correct_purity","text":"Adjusts log2 copy ratio computes copy number fraction (CNF) region, given sample purity scale factor.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/correct_purity.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Correct Copy Ratio and Calculate CNF for Purity and Scale Factor ‚Äî correct_purity","text":"","code":"correct_purity(cov, gender, purity, sf)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/correct_purity.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Correct Copy Ratio and Calculate CNF for Purity and Scale Factor ‚Äî correct_purity","text":"cov Data frame tibble. Coverage data, must include columns CONTIG LOG2_COPY_RATIO. gender Character. Sample gender (\"male\" \"female\"). purity Numeric. Tumor purity (fraction 0 1). sf Numeric. Scale factor diploid coverage.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/correct_purity.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Correct Copy Ratio and Calculate CNF for Purity and Scale Factor ‚Äî correct_purity","text":"coverage data frame tibble additional columns Segcov, updated LOG2_COPY_RATIO, CNF.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/correct_purity.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Correct Copy Ratio and Calculate CNF for Purity and Scale Factor ‚Äî correct_purity","text":"Adjusts log2 copy ratio using scale factor. Calculates CNF differently sex chromosomes males.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/correct_purity.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Correct Copy Ratio and Calculate CNF for Purity and Scale Factor ‚Äî correct_purity","text":"","code":"# correct_purity(cov, gender = \"female\", purity = 0.7, sf = 1)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/cov_bin.html","id":null,"dir":"Reference","previous_headings":"","what":"Bin and Smooth Copy Number Data from Coverage File ‚Äî cov_bin","title":"Bin and Smooth Copy Number Data from Coverage File ‚Äî cov_bin","text":"Splits coverage data chromosome, bins 300bp windows, computes smoothed copy number values using larger window size.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/cov_bin.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Bin and Smooth Copy Number Data from Coverage File ‚Äî cov_bin","text":"","code":"cov_bin(cov, cov_binsize)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/cov_bin.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Bin and Smooth Copy Number Data from Coverage File ‚Äî cov_bin","text":"cov Data frame tibble. Must include columns CONTIG, START, END, CNF. cov_binsize Numeric. Bin size (bases) smoothing (e.g., 10000 10kb).","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/cov_bin.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Bin and Smooth Copy Number Data from Coverage File ‚Äî cov_bin","text":"data frame columns: CONTIG, bin_start, bin_norm_id, smoothed CNF values.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/cov_bin.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Bin and Smooth Copy Number Data from Coverage File ‚Äî cov_bin","text":"Bins generated every 300bp within region. Smoothed copy number computed median CNF within larger (cov_binsize) window.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/cov_bin.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Bin and Smooth Copy Number Data from Coverage File ‚Äî cov_bin","text":"","code":"# cov_bin(cov, cov_binsize = 10000)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/cytoband_table.html","id":null,"dir":"Reference","previous_headings":"","what":"Cytoband reference table ‚Äî cytoband_table","title":"Cytoband reference table ‚Äî cytoband_table","text":"dataset contains cytoband annotations human genome.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/cytoband_table.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Cytoband reference table ‚Äî cytoband_table","text":"","code":"cytoband_table"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/cytoband_table.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Cytoband reference table ‚Äî cytoband_table","text":"data frame columns: chrom Chromosome name (character). start Start coordinate (integer). end End coordinate (integer). band Cytoband name (character). gieStain Giemsa stain (character).","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/cytoband_table.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Cytoband reference table ‚Äî cytoband_table","text":"UCSC Table Browser","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/edge_table.html","id":null,"dir":"Reference","previous_headings":"","what":"Detectable Edge table for cytoband annotation follows the 5MB rule. ‚Äî edge_table","title":"Detectable Edge table for cytoband annotation follows the 5MB rule. ‚Äî edge_table","text":"Detectable Edge table cytoband annotation follows 5MB rule.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/edge_table.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Detectable Edge table for cytoband annotation follows the 5MB rule. ‚Äî edge_table","text":"","code":"edge_table"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/edge_table.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Detectable Edge table for cytoband annotation follows the 5MB rule. ‚Äî edge_table","text":"data frame columns: Chrom Chromosome name (character). p_chromStart P arm chromosome Start coordinates (integer). p_chromEnd P arm chromosome End coordinates (integer). p_first_name P arm first cytoband name (character). p_last_name P arm last cytoband name (character). q_chromStart Q arm chromosome Start coordinates (integer). q_chromEnd Q arm chromosome End coordinates (integer). q_first_name Q arm first cytoband name (character). q_last_name Q arm last cytoband name (character).","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/edge_table.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Detectable Edge table for cytoband annotation follows the 5MB rule. ‚Äî edge_table","text":"Internal analysis","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/findcytoband.html","id":null,"dir":"Reference","previous_headings":"","what":"Find Cytoband Name for Genomic Position ‚Äî FindCytoband","title":"Find Cytoband Name for Genomic Position ‚Äî FindCytoband","text":"Returns cytoband name given chromosome position searching cytoband annotation data frame.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/findcytoband.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Find Cytoband Name for Genomic Position ‚Äî FindCytoband","text":"","code":"FindCytoband(cytoband, chrom, pos)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/findcytoband.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Find Cytoband Name for Genomic Position ‚Äî FindCytoband","text":"cytoband Data frame. Cytoband annotation columns chrom, chromStart, chromEnd, name. chrom Character. Chromosome name (e.g., \"1\", \"X\"). pos Numeric character. Genomic position (base pair).","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/findcytoband.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Find Cytoband Name for Genomic Position ‚Äî FindCytoband","text":"Character. cytoband name(s) containing position.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/findcytoband.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Find Cytoband Name for Genomic Position ‚Äî FindCytoband","text":"","code":"# cytoband <- data.frame(chrom = \"1\", chromStart = 1, chromEnd = 1000000, name = \"p36.33\") # FindCytoband(cytoband, chrom = \"1\", pos = 500000)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/gene_annotation.html","id":null,"dir":"Reference","previous_headings":"","what":"RefSeq gene annotations ‚Äî gene_annotation","title":"RefSeq gene annotations ‚Äî gene_annotation","text":"RefSeq annotations including gene names start end.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/gene_annotation.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"RefSeq gene annotations ‚Äî gene_annotation","text":"","code":"gene_annotation"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/gene_annotation.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"RefSeq gene annotations ‚Äî gene_annotation","text":"data frame columns: chrom Chromosome name (character). start Start coordinate (integer). end End coordinate (integer). genesymbl Gene name (character).","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/gene_annotation.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"RefSeq gene annotations ‚Äî gene_annotation","text":"RefSeq","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/generate_ISCN.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate Cytoband-Based Annotation String for a CNV Segment ‚Äî generate_ISCN","title":"Generate Cytoband-Based Annotation String for a CNV Segment ‚Äî generate_ISCN","text":"Returns cytoband-based annotation string CNV segment, based segment's position proximity p q arm detectable region boundaries.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/generate_ISCN.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate Cytoband-Based Annotation String for a CNV Segment ‚Äî generate_ISCN","text":"","code":"generate_ISCN(   chrom,   Start,   End,   CNF,   CN,   p_chromStart,   p_chromEnd,   p_first_name,   p_last_name,   q_chromStart,   q_chromEnd,   q_first_name,   q_last_name,   p_gap_to_tel,   p_gap_to_cen,   q_gap_to_tel,   q_gap_to_cen,   cytoband )"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/generate_ISCN.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate Cytoband-Based Annotation String for a CNV Segment ‚Äî generate_ISCN","text":"chrom Character. Chromosome name. Start, End Numeric. Segment start end positions (base pairs). CNF Numeric. Fractional copy number. CN Integer. Integer copy number. p_chromStart, p_chromEnd Numeric. p-arm detectable region start end positions. p_first_name, p_last_name Character. Cytoband names p-arm start end. q_chromStart, q_chromEnd Numeric. q-arm detectable region start end positions. q_first_name, q_last_name Character. Cytoband names q-arm start end. p_gap_to_tel, p_gap_to_cen, q_gap_to_tel, q_gap_to_cen Numeric. Gaps segment detectable region boundaries (calculate_gaps). cytoband Data frame. Cytoband annotation table.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/generate_ISCN.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate Cytoband-Based Annotation String for a CNV Segment ‚Äî generate_ISCN","text":"Character. cytoband-based annotation string segment.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/generate_ISCN.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Generate Cytoband-Based Annotation String for a CNV Segment ‚Äî generate_ISCN","text":"function determines annotation follows: segment start end cytoband, returns single-band range. segment spans multiple cytobands, returns range start end cytoband. segment close p-arm telomere centromere (p-arm boundaries), returns p-arm event . segment close q-arm centromere telomere (q-arm boundaries), returns q-arm event (chromosome-level event acrocentric chromosomes). segment close p-arm q-arm telomeres (covers whole chromosome), returns chromosome-level event. gap size smaller 5MB defined \"close\". acrocentric chromosomes, q-arm boundaries considered. annotation string determined size gaps segment p/q arm detectable region boundaries cytoband names segment start end. Events reported cytoband range, p-arm , q-arm , chromosome-level event.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/generate_ISCN.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Generate Cytoband-Based Annotation String for a CNV Segment ‚Äî generate_ISCN","text":"","code":"# generate_ISCN(\"1\", 10000, 50000, 2.1, 2, 0, 25000, \"p36.33\", \"p11.2\", #               25001, 100000, \"q11.1\", \"q44\", 1000, 1000, 1000, 1000, cytoband)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/keep_whitelist_ai.html","id":null,"dir":"Reference","previous_headings":"","what":"Keep Only AI Bins in Whitelisted Regions ‚Äî keep_whitelist_ai","title":"Keep Only AI Bins in Whitelisted Regions ‚Äî keep_whitelist_ai","text":"Filters AI (allelic imbalance) bins include overlapping whitelisted regions.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/keep_whitelist_ai.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Keep Only AI Bins in Whitelisted Regions ‚Äî keep_whitelist_ai","text":"","code":"keep_whitelist_ai(rounded_ai, whitelist)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/keep_whitelist_ai.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Keep Only AI Bins in Whitelisted Regions ‚Äî keep_whitelist_ai","text":"rounded_ai Data frame tibble. Rounded AI data, must include columns contig, start, stop. whitelist Data frame tibble. Whitelist regions, must include columns seqnames, start, end.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/keep_whitelist_ai.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Keep Only AI Bins in Whitelisted Regions ‚Äî keep_whitelist_ai","text":"data frame AI bins overlap whitelisted regions.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/keep_whitelist_ai.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Keep Only AI Bins in Whitelisted Regions ‚Äî keep_whitelist_ai","text":"","code":"# keep_whitelist_ai(rounded_ai, whitelist)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/keep_whitelist_cov.html","id":null,"dir":"Reference","previous_headings":"","what":"Keep Only Coverage Bins in Whitelisted Regions ‚Äî keep_whitelist_cov","title":"Keep Only Coverage Bins in Whitelisted Regions ‚Äî keep_whitelist_cov","text":"Filters smoothed coverage bins include overlapping whitelisted regions.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/keep_whitelist_cov.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Keep Only Coverage Bins in Whitelisted Regions ‚Äî keep_whitelist_cov","text":"","code":"keep_whitelist_cov(smooth_cov, whitelist)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/keep_whitelist_cov.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Keep Only Coverage Bins in Whitelisted Regions ‚Äî keep_whitelist_cov","text":"smooth_cov Data frame tibble. Smoothed coverage data, must include columns CONTIG, bin_start, bin_end. whitelist Data frame tibble. Whitelist regions, must include columns seqnames, start, end.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/keep_whitelist_cov.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Keep Only Coverage Bins in Whitelisted Regions ‚Äî keep_whitelist_cov","text":"data frame smoothed coverage bins overlap whitelisted regions.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/keep_whitelist_cov.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Keep Only Coverage Bins in Whitelisted Regions ‚Äî keep_whitelist_cov","text":"","code":"# keep_whitelist_cov(smooth_cov, whitelist)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/plot_cov.html","id":null,"dir":"Reference","previous_headings":"","what":"Multi-panel Plot of Copy Number, BAF, Clonality, and Quality Across Chromosomes ‚Äî plot_cov","title":"Multi-panel Plot of Copy Number, BAF, Clonality, and Quality Across Chromosomes ‚Äî plot_cov","text":"Produces summary plot four panels: copy number, BAF, clonality, segment quality, faceted chromosome.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/plot_cov.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Multi-panel Plot of Copy Number, BAF, Clonality, and Quality Across Chromosomes ‚Äî plot_cov","text":"","code":"plot_cov(df_cov, df_ai, call_seg, whitelist, gender, prefix, purity)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/plot_cov.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Multi-panel Plot of Copy Number, BAF, Clonality, and Quality Across Chromosomes ‚Äî plot_cov","text":"df_cov Data frame tibble. Smoothed coverage data, must include columns seqnames, start, end, smoothed_bin_cnf. df_ai Data frame tibble. Smoothed AI data, must include columns seqnames, bin_start, smoothed_ai. call_seg Data frame tibble. Segment calls, must include columns seqnames, loc.start, loc.end, CN, MAF, ccf_final, FILTER. whitelist Data frame tibble. Whitelist regions, must include columns seqnames, start, end. gender Character. Sample gender (\"male\" \"female\"). prefix Character. Plot title output prefix. purity Numeric. Tumor purity (directly used plot, included compatibility).","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/plot_cov.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Multi-panel Plot of Copy Number, BAF, Clonality, and Quality Across Chromosomes ‚Äî plot_cov","text":"grob object (gridExtra::grid.arrange) representing combined plot.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/plot_cov.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Multi-panel Plot of Copy Number, BAF, Clonality, and Quality Across Chromosomes ‚Äî plot_cov","text":"","code":"# plot_cov(df_cov, df_ai, call_seg, whitelist, gender = \"female\", prefix = \"Sample1\", purity = 0.7)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/read_whitelist.html","id":null,"dir":"Reference","previous_headings":"","what":"Read and Process DRAGEN Whitelist Regions ‚Äî read_whitelist","title":"Read and Process DRAGEN Whitelist Regions ‚Äî read_whitelist","text":"Reads DRAGEN whitelist file returns detected regions GRanges-like segments copy number analysis.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/read_whitelist.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Read and Process DRAGEN Whitelist Regions ‚Äî read_whitelist","text":"","code":"read_whitelist(whitelist_file, gender)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/read_whitelist.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Read and Process DRAGEN Whitelist Regions ‚Äî read_whitelist","text":"whitelist_file Path whitelist file (CSV, header). gender Character. Sample gender (\"male\" \"female\").","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/read_whitelist.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Read and Process DRAGEN Whitelist Regions ‚Äî read_whitelist","text":"data frame columns: seqnames, start, end, width, strand.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/read_whitelist.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Read and Process DRAGEN Whitelist Regions ‚Äî read_whitelist","text":"\"male\", expects chromosome Y present; \"female\", expects chromosome Y absent. Splits regions cytoband, detects gaps, outputs non-gap regions.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/read_whitelist.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Read and Process DRAGEN Whitelist Regions ‚Äî read_whitelist","text":"","code":"# read_whitelist(\"whitelist.csv\", gender = \"male\")"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/reexports.html","id":null,"dir":"Reference","previous_headings":"","what":"Objects exported from other packages ‚Äî reexports","title":"Objects exported from other packages ‚Äî reexports","text":"objects imported packages. Follow links see documentation. magrittr %>%","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/rerunCalling.html","id":null,"dir":"Reference","previous_headings":"","what":"Rerun CNV Calling with User-Defined Purity and Size Factor ‚Äî rerunCalling","title":"Rerun CNV Calling with User-Defined Purity and Size Factor ‚Äî rerunCalling","text":"Allows user rerun copy number variant (CNV) calling using user-defined purity scale factor (size factor) parameters, specifying diploid region.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/rerunCalling.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Rerun CNV Calling with User-Defined Purity and Size Factor ‚Äî rerunCalling","text":"","code":"rerunCalling(   seg,   input,   models,   call,   gender,   dicovsf = NULL,   purity = NULL,   chromosome = NULL,   start = NULL,   end = NULL,   mode = \"model\",   out_file )"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/rerunCalling.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Rerun CNV Calling with User-Defined Purity and Size Factor ‚Äî rerunCalling","text":"seg Path segment file (e.g., *_final_call.tsv). input Path top likelihood row file. models Path model file. call Path final call file. gender Character. Sample gender (\"male\" \"female\"). dicovsf Character numeric. Desired scale factor, range (e.g., \"0.9:1.1\"). purity Character numeric. Desired purity, range (e.g., \"0.5:0.7\"). chromosome Character. Chromosome number diploid region (optional). start Integer. Start position diploid region (optional). end Integer. End position diploid region (optional). mode Character. Either \"model\" \"region\". out_file Output file path final calls.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/rerunCalling.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Rerun CNV Calling with User-Defined Purity and Size Factor ‚Äî rerunCalling","text":"Invisibly returns final call data frame.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/rerunCalling.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Rerun CNV Calling with User-Defined Purity and Size Factor ‚Äî rerunCalling","text":"function allows re-calling CNV segments user-specified purity /size factor (SF, scale factor) defining diploid region. supports \"model\" \"region\" rerun modes. result written out_file.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/rerunCalling.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Rerun CNV Calling with User-Defined Purity and Size Factor ‚Äî rerunCalling","text":"","code":"# rerun_cnv_calling( #   seg = \"sample_final_call.tsv\", #   input = \"sample_top_likelihood_calls.tsv\", #   models = \"sample_Models_likelihood.tsv\", #   call = \"sample_final_calls.tsv\", #   gender = \"male\", #   purity = \"0.5:0.7\", #   dicovsf = \"0.9:1.1\", #   mode = \"model\", #   out_file = \"sample_final_calls_rerun.tsv\" # )"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/round_ai.html","id":null,"dir":"Reference","previous_headings":"","what":"Round BAF Values into 20 Bins ‚Äî round_ai","title":"Round BAF Values into 20 Bins ‚Äî round_ai","text":"chromosome, rounds B-allele frequency (BAF, af) values 20 bins (increments 0.05).","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/round_ai.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Round BAF Values into 20 Bins ‚Äî round_ai","text":"","code":"round_ai(ai)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/round_ai.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Round BAF Values into 20 Bins ‚Äî round_ai","text":"ai list data frames tibbles, one per chromosome. must include columns af, contig, start, stop, allele1Count, allele2Count.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/round_ai.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Round BAF Values into 20 Bins ‚Äî round_ai","text":"data frame columns: contig, start, stop, allele1Count, allele2Count, norm_af.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/round_ai.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Round BAF Values into 20 Bins ‚Äî round_ai","text":"BAF values (af) rounded nearest 0.05. Output single data frame combining chromosomes.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/round_ai.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Round BAF Values into 20 Bins ‚Äî round_ai","text":"","code":"# ai_list <- list(chr1 = data.frame(af = runif(10), contig = \"1\", start = 1:10, stop = 11:20, allele1Count = 1:10, allele2Count = 11:20)) # round_ai(ai_list)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/roundcn.html","id":null,"dir":"Reference","previous_headings":"","what":"Round Copy Number to Integer Based on Call and Gender ‚Äî RoundCN","title":"Round Copy Number to Integer Based on Call and Gender ‚Äî RoundCN","text":"Round Copy Number Integer Based Call Gender","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/roundcn.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Round Copy Number to Integer Based on Call and Gender ‚Äî RoundCN","text":"","code":"RoundCN(gender, Chrom, Call, CNF)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/roundcn.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Round Copy Number to Integer Based on Call and Gender ‚Äî RoundCN","text":"gender Character. \"male\" \"female\". Chrom Character. Chromosome name. Call Character. CNV call. CNF Numeric. Corrected CNF.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/roundcn.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Round Copy Number to Integer Based on Call and Gender ‚Äî RoundCN","text":"Integer. Rounded copy number.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/runAIsegmentation.html","id":null,"dir":"Reference","previous_headings":"","what":"Run AI Segmentation Workflow ‚Äî RunAIsegmentation","title":"Run AI Segmentation Workflow ‚Äî RunAIsegmentation","text":"function executes full AI segmentation workflow, including reading input files, merging segments, BAF processing, writing results.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/runAIsegmentation.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Run AI Segmentation Workflow ‚Äî RunAIsegmentation","text":"","code":"RunAIsegmentation(   seg,   cov,   ai,   gender,   out_dir,   prefix,   ai_pon,   mergeai = 0.15,   mergecov = 0.2,   snpmin = 4,   minsnpcov = 20,   mergecovminsize = 5e+05,   maxgap = 2e+06,   snpnum = 20,   maxbinsize = 1e+06,   minbinsize = 5e+05,   aitype = \"gatk\",   segmethod = \"cbs\",   cbssmooth = \"no\" )"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/runAIsegmentation.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Run AI Segmentation Workflow ‚Äî RunAIsegmentation","text":"seg Path GATK segment file. cov Path GATK denoised coverage count file. ai Path BAF file allelic count file. gender Character, \"male\" \"female\"( available, set gender = \"unknown\" run Runcheckgender function ahead assign gender automatically) . out_dir Output directory path. prefix Output file prefix. ai_pon Path PON Rdata. AI panel normal generated PONAIprocess. mergeai Numeric, MAF difference threshold merging segments (default: 0.15). mergecov Numeric, CNV difference threshold merging segments (default: 0.2). snpmin Numeric, minimum SNPs MAF segmentation (default: 4). minsnpcov Numeric, minimum coverage SNPs included (default: 20). mergecovminsize Numeric, minimum size GATK segment merge (default: 500000). maxgap Maximum gap size inside bin. exceed start another bin.( default: 2000000) snpnum SNP number bin.( default: 20 ) maxbinsize Maximum bin size.( default: 1000000 ) minbinsize Minimum bin size.( default: 500000 ) aitype Character. Type allelic imbalance data: \"gatk\" \"\" \"dragen\" \"GATK\", input must include columns CONTIG, POSITION, ALT_COUNT, REF_COUNT, REF_NUCLEOTIDE, ALT_NUCLEOTIDE. \"dragen\", input must include columns contig, start, stop, refAllele, allele1, allele2, allele1Count, allele2Count, allele1AF, allele2AF. \"\", input must include columns CONTIG, POSITION, ALT_COUNT, REF_COUNT, REF_NUCLEOTIDE, ALT_NUCLEOTIDE. segmethod Character. Segmentation method use: \"merge\", perform stepwise merging; \"cbs\", perform CBS (circular binary segmentation). cbssmooth Character. using \"cbs\" segmentation method, set \"yes\" apply smoothing segmentation, \"\" skip smoothing.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/runAIsegmentation.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Run AI Segmentation Workflow ‚Äî RunAIsegmentation","text":"Invisibly returns output file path.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/runModelLikelihood.html","id":null,"dir":"Reference","previous_headings":"","what":"Run Model Likelihood and Copy Number Calling Workflow ‚Äî RunModelLikelihood","title":"Run Model Likelihood and Copy Number Calling Workflow ‚Äî RunModelLikelihood","text":"function runs complete workflow likelihood calculation model selection.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/runModelLikelihood.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Run Model Likelihood and Copy Number Calling Workflow ‚Äî RunModelLikelihood","text":"","code":"RunModelLikelihood(   seg,   out_dir,   prefix,   gender,   lambda = 1,   gamma = 1,   epsilon = 0.01,   modelminprobes = 20,   modelminAIsize = 5e+06,   minsf = 0.4,   callcov = 0.3,   thread = 4,   XploR_path = NULL,   ... )"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/runModelLikelihood.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Run Model Likelihood and Copy Number Calling Workflow ‚Äî RunModelLikelihood","text":"seg Path combined segment file. out_dir Output directory. prefix Output file prefix. gender Sample gender (\"male\" \"female\"). modelminprobes, modelminAIsize, callcov, thread, callcovcutoff, callaicutoff, minsnpcallaicutoff Numeric parameters workflow (see script RunCallikelihood details). XploR_path, Path XploR package, want install.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/runModelLikelihood.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Run Model Likelihood and Copy Number Calling Workflow ‚Äî RunModelLikelihood","text":"Invisibly returns output file paths.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/runPlotCNV.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot CNV Profile (Copy Number, BAF, Clonality, Quality) ‚Äî RunPlotCNV","title":"Plot CNV Profile (Copy Number, BAF, Clonality, Quality) ‚Äî RunPlotCNV","text":"Plots CNV profile using coverage, B-allele, segment, whitelist data.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/runPlotCNV.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot CNV Profile (Copy Number, BAF, Clonality, Quality) ‚Äî RunPlotCNV","text":"","code":"RunPlotCNV(   seg,   cr,   ballele,   ai_binsize = 1e+05,   cov_binsize = 1e+05,   whitelist,   gender = NULL,   out_dir,   prefix,   aitype )"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/runPlotCNV.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot CNV Profile (Copy Number, BAF, Clonality, Quality) ‚Äî RunPlotCNV","text":"seg Path GATK-processed segment file. cr Path GATK denoised CR file extension denoisedCR.tsv. ballele Path DRAGEN B-allele file. source B-allele file column chrom ref alt baf ai_binsize Numeric. Bin size AI plot (default 100000). cov_binsize Numeric. Bin size coverage plot (default 100000). whitelist Path whitelist file. gender Character. \"male\" \"female\". out_dir Output directory. prefix Sample ID output prefix. aitype Character. Type allelic imbalance data: \"gatk\" \"\" \"dragen\" \"GATK\", input must include columns CONTIG, POSITION, ALT_COUNT, REF_COUNT, REF_NUCLEOTIDE, ALT_NUCLEOTIDE. \"dragen\", input must include columns contig, start, stop, refAllele, allele1, allele2, allele1Count, allele2Count, allele1AF, allele2AF. \"\", input must include columns CONTIG, POSITION, ALT_COUNT, REF_COUNT, REF_NUCLEOTIDE, ALT_NUCLEOTIDE.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/runPlotCNV.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot CNV Profile (Copy Number, BAF, Clonality, Quality) ‚Äî RunPlotCNV","text":"Invisibly returns ggplot object.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/smooth_ai.html","id":null,"dir":"Reference","previous_headings":"","what":"Smooth AI Bins by Window Size and Downsampling ‚Äî smooth_ai","title":"Smooth AI Bins by Window Size and Downsampling ‚Äî smooth_ai","text":"Smooths allelic imbalance (AI) bins specified window size, keeping 30 data points per bin using frequency-based downsampling.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/smooth_ai.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Smooth AI Bins by Window Size and Downsampling ‚Äî smooth_ai","text":"","code":"smooth_ai(df, ai_binsize, gender)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/smooth_ai.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Smooth AI Bins by Window Size and Downsampling ‚Äî smooth_ai","text":"df Data frame tibble. Must include columns seqnames, start, norm_af. ai_binsize Numeric. Bin size (bases) smoothing. gender Character. Sample gender (\"male\" \"female\"). (Currently used function, included compatibility.)","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/smooth_ai.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Smooth AI Bins by Window Size and Downsampling ‚Äî smooth_ai","text":"data frame columns: seqnames, bin_start, bin_end, smoothed AI values.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/smooth_ai.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Smooth AI Bins by Window Size and Downsampling ‚Äî smooth_ai","text":"Splits data chromosome. bin, keeps 30 values using ai_bin_smooth.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/smooth_ai.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Smooth AI Bins by Window Size and Downsampling ‚Äî smooth_ai","text":"","code":"# smooth_ai(df, ai_binsize = 10000, gender = \"female\")"}]
