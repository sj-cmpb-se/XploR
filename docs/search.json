[{"path":"https://sj-cmpb-se.github.io/XploR/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2025 Meiling Jin Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Meiling Jin. Maintainer.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Jin M (2025). XploR: Large-Scale Allele-Specific CNV Detection Using Coverage Allelic Imbalance WES data. https://sj-cmpb-se.github.io/XploR/, https://github.com/sj-cmpb-se/XploR.","code":"@Manual{,   title = {XploR: Large-Scale Allele-Specific CNV Detection Using Coverage and Allelic Imbalance in WES data},   author = {Meiling Jin},   year = {2025},   note = {https://sj-cmpb-se.github.io/XploR/, https://github.com/sj-cmpb-se/XploR}, }"},{"path":"https://sj-cmpb-se.github.io/XploR/index.html","id":"features","dir":"","previous_headings":"","what":"Features","title":"Large-Scale Allele-Specific CNV Detection Using Coverage and Allelic Imbalance in WES data","text":"Exome-wide copy number segmentation allelic imbalance detection Purity ploidy estimation model selection BAF coverage smoothing, binning, quality control ISCN gene annotation CNV segments Interactive publication-ready visualization Batch command-line workflows high-throughput analysis","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Large-Scale Allele-Specific CNV Detection Using Coverage and Allelic Imbalance in WES data","text":"Install latest version GitHub using devtools:","code":"install.packages(\"devtools\") devtools::install_github(\"sj-cmpb-se/XploR\")"},{"path":"https://sj-cmpb-se.github.io/XploR/index.html","id":"example","dir":"","previous_headings":"","what":"Example","title":"Large-Scale Allele-Specific CNV Detection Using Coverage and Allelic Imbalance in WES data","text":"basic example run program:","code":"library(XploR)  #Example: Run main CNV workflow (see vignette for details) result <- runAIsegmentation(  seg = \"sample.seg\",    cov = \"sample.counts\",   ai = \"sample.tumor.baf.bedgraph.gz\",   gender = \"female\",   out_dir = \"results/\",   prefix = \"Sample1\" )  #Annotate segments with ISCN and gene information AnnotateSegments(   input = \"results/Sample1_GATK_DRAGEN_merge.tsv\",   out_dir = \"results/\",   prefix = \"Sample1\",   cytoband = \"data/cytoBand.txt\",   whitelist_edge = \"data/whitelist.txt\",   gene = \"data/gene_anno.txt\" )  # Plot results plot_cnv_profile(   seg = \"results/Sample1_CNV_annotation.tsv\",   coverage = \"sample.denoisedCR.tsv\",   ballele = \"sample.tumor.ballele.counts.gz\",   whitelist = \"data/whitelist.txt\",   gender = \"female\",   out_dir = \"results/\",   prefix = \"Sample1\" )"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/AddQualTag.html","id":null,"dir":"Reference","previous_headings":"","what":"Assign Quality Tag to a Segment Based on BAF GMM Metrics — AddQualTag","title":"Assign Quality Tag to a Segment Based on BAF GMM Metrics — AddQualTag","text":"Assigns quality tag (\"PASS\" \"FAILED\") segment based BAF GMM weight probe count thresholds.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/AddQualTag.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Assign Quality Tag to a Segment Based on BAF GMM Metrics — AddQualTag","text":"","code":"AddQualTag(MAF_gmm_weight, MAF_Probes, MAF_gmm_G, snpmin)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/AddQualTag.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Assign Quality Tag to a Segment Based on BAF GMM Metrics — AddQualTag","text":"MAF_gmm_weight Numeric. mixture weight prominent BAF GMM cluster. MAF_Probes Integer. number nonzero BAF probes segment. MAF_gmm_G Integer. Number BAF GMM clusters. snpmin Integer. minimum nonzero SNP count.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/AddQualTag.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Assign Quality Tag to a Segment Based on BAF GMM Metrics — AddQualTag","text":"Character. \"PASS\" segment passes quality checks, \"FAILED\" otherwise.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/AddQualTag.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Assign Quality Tag to a Segment Based on BAF GMM Metrics — AddQualTag","text":"segment marked \"PASS\" BAF GMM weight least 0.35 probe count least twice minimum SNP count (snpmin). Otherwise, marked \"FAILED\".","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/AddQualTag.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Assign Quality Tag to a Segment Based on BAF GMM Metrics — AddQualTag","text":"","code":"AddQualTag(MAF_gmm_weight = 0.4, MAF_Probes = 20, MAF_gmm_G = 2, snpmin = 7) #> [1] \"PASS\" AddQualTag(MAF_gmm_weight = 0.2, MAF_Probes = 10, MAF_gmm_G = 1, snpmin = 7) #> [1] \"FAILED\""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/AnnotateGene.html","id":null,"dir":"Reference","previous_headings":"","what":"Annotate Segments with Overlapping Genes — AnnotateGene","title":"Annotate Segments with Overlapping Genes — AnnotateGene","text":"segment, identifies overlapping genes adds gene names number overlapping genes segment data.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/AnnotateGene.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Annotate Segments with Overlapping Genes — AnnotateGene","text":"","code":"AnnotateGene(gene, segment)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/AnnotateGene.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Annotate Segments with Overlapping Genes — AnnotateGene","text":"gene Character. Path gene annotation file (tab-delimited, columns: chrom, loc.start, loc.end, Gene). segment Data frame. Segment data columns chrom, loc.start, loc.end.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/AnnotateGene.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Annotate Segments with Overlapping Genes — AnnotateGene","text":"data frame original segment columns plus Gene (comma-separated gene names) Gene_count.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/AnnotateGene.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Annotate Segments with Overlapping Genes — AnnotateGene","text":"","code":"# segment <- data.frame(chrom = \"1\", loc.start = 1000, loc.end = 2000) # AnnotateGene(\"genes.txt\", segment)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/AnnotateSegments.html","id":null,"dir":"Reference","previous_headings":"","what":"Annotate CNV Segments with Cytoband and Gene Information — AnnotateSegments","title":"Annotate CNV Segments with Cytoband and Gene Information — AnnotateSegments","text":"Annotates CNV segments cytoband gene overlap information.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/AnnotateSegments.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Annotate CNV Segments with Cytoband and Gene Information — AnnotateSegments","text":"","code":"AnnotateSegments(input, out_dir, prefix, cytoband, whitelist_edge, gene)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/AnnotateSegments.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Annotate CNV Segments with Cytoband and Gene Information — AnnotateSegments","text":"input Path merged segment file (TSV). out_dir Output directory. prefix Output file prefix. cytoband Path cytoband annotation file (TSV). whitelist_edge Path detectable edge file cytoband annotation. gene Path gene annotation file.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/AnnotateSegments.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Annotate CNV Segments with Cytoband and Gene Information — AnnotateSegments","text":"Invisibly returns annotated data frame cytoband gene annotation columns.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/AnnotateSegments.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Annotate CNV Segments with Cytoband and Gene Information — AnnotateSegments","text":"segment, function calculates gaps segment boundaries detectable p q arm region start/end sites (using cytoband whitelist edge files). acrocentric chromosomes, q arm boundaries considered. Based size gaps, function determines event type returns: cytoband range (combination start stop cytoband), p-arm q-arm event, , event spans whole chromosome, just chromosome name (chromosome-level event). Gene overlap information also added segment.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/AnnotateSegments.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Annotate CNV Segments with Cytoband and Gene Information — AnnotateSegments","text":"","code":"AnnotateSegments(   input = \"sample_CNV_final.tsv\",   out_dir = \"results/\",   prefix = \"Sample1\",   cytoband = \"data/cytoBand.txt\",   whitelist_edge = \"data/whitelist.txt\",   gene = \"data/gene_anno.txt\" ) #> Warning: cannot open file 'data/whitelist.txt': No such file or directory #> Error in file(file, \"rt\"): cannot open the connection"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/AssignPriors.html","id":null,"dir":"Reference","previous_headings":"","what":"Assign Priors to Major/Minor Allele Combinations Based on Biological Difficulty — AssignPriors","title":"Assign Priors to Major/Minor Allele Combinations Based on Biological Difficulty — AssignPriors","text":"Assigns prior probabilities major/minor allele combinations using exponential decay model incorporates biological plausibility.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/AssignPriors.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Assign Priors to Major/Minor Allele Combinations Based on Biological Difficulty — AssignPriors","text":"","code":"AssignPriors(combinations, lambda)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/AssignPriors.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Assign Priors to Major/Minor Allele Combinations Based on Biological Difficulty — AssignPriors","text":"combinations Data frame. Output GenerateCombinations(), columns major, minor, total_cn. lambda Numeric. Decay rate parameter exponential prior.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/AssignPriors.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Assign Priors to Major/Minor Allele Combinations Based on Biological Difficulty — AssignPriors","text":"data frame input columns plus: Bio\\_diff Assigned biological difficulty score prior Normalized prior probability combination","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/AssignPriors.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Assign Priors to Major/Minor Allele Combinations Based on Biological Difficulty — AssignPriors","text":"function assigns biological difficulty score combination. unlisted combinations, score set according rules based total_cn, major, minor. prior calculated \\(\\exp(-\\lambda \\times \\text{Bio\\_diff})\\) normalized sum 1.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/AssignPriors.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Assign Priors to Major/Minor Allele Combinations Based on Biological Difficulty — AssignPriors","text":"","code":"combos <- GenerateCombinations(3) #> Error in expand.grid(major = 0:total_cn, minor = 0:total_cn) %>% subset(major >=     minor & major + minor == total_cn) %>% dplyr::mutate(total_cn = major +     minor): could not find function \"%>%\" AssignPriors(combos, lambda = 0.5) #> Error in combinations %>% dplyr::left_join(bio_diff, by = c(\"major\", \"minor\")) %>%     dplyr::rowwise() %>% dplyr::mutate(Bio_diff = ifelse(is.na(Bio_diff),     ifelse(minor == 0, total_cn + 1, ifelse(major == minor, total_cn,         total_cn - 1)), Bio_diff)) %>% dplyr::mutate(Bio_diff_prior = exp(-lambda *     Bio_diff)) %>% dplyr::ungroup %>% dplyr::mutate(prior = Bio_diff_prior/sum(Bio_diff_prior,     na.rm = T)) %>% dplyr::select(-Bio_diff_prior): could not find function \"%>%\""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CalMedian.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate Median Coverage for a Genomic Region — CalMedian","title":"Calculate Median Coverage for a Genomic Region — CalMedian","text":"Calculate Median Coverage Genomic Region","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CalMedian.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate Median Coverage for a Genomic Region — CalMedian","text":"","code":"CalMedian(chrom, start, end, cov)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CalMedian.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate Median Coverage for a Genomic Region — CalMedian","text":"chrom Chromosome name (character) start Start position (numeric) end End position (numeric) cov Data frame recording coverage columns CONTIG, START, END, COUNT","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CalMedian.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate Median Coverage for a Genomic Region — CalMedian","text":"Median coverage (numeric)","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CalSM.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate Segment Mean Adjusted by Scale Factor — CalSM","title":"Calculate Segment Mean Adjusted by Scale Factor — CalSM","text":"Calculate Segment Mean Adjusted Scale Factor","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CalSM.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate Segment Mean Adjusted by Scale Factor — CalSM","text":"","code":"CalSM(Segcov, max_L_mu, gender, Chromosome)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CalSM.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate Segment Mean Adjusted by Scale Factor — CalSM","text":"Segcov Numeric. observed segment coverage. max_L_mu Numeric. scale factor (mu). gender Character. \"male\" \"female\". Chromosome Character. Chromosome name (e.g., \"1\", \"X\", \"Y\").","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CalSM.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate Segment Mean Adjusted by Scale Factor — CalSM","text":"Numeric. adjusted segment mean (log2 ratio).","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CalSM.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Calculate Segment Mean Adjusted by Scale Factor — CalSM","text":"","code":"CalSM(Segcov = 150, max_L_mu = 1, gender = \"female\", Chromosome = \"1\") #> [1] 0.5849625"},{"path":[]},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CalSegmentLikelihood.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate Marginal Likelihood for a Single Segment — CalSegmentLikelihood","text":"","code":"CalSegmentLikelihood(C_i, B_i, mu, rho, sigma_C, k, lambda, gamma, epsilon)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CalSegmentLikelihood.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate Marginal Likelihood for a Single Segment — CalSegmentLikelihood","text":"C_i Numeric. Integer copy number segment. B_i Numeric. Observed B-allele frequency (BAF) segment. mu Numeric. Mutation multiplicity (percent, e.g., 100 means 100\\ rhoNumeric. Tumor purity (fraction 0 1). sigma_CNumeric. directly used function, included compatibility. kNumeric. Beta distribution concentration parameter. lambdaNumeric. Exponential decay parameter prior. gammaNumeric. Weight prior likelihood calculation. epsilonNumeric. Small value avoid log(0) zero parameters beta. data frame columns: major Major allele count minor Minor allele count total_cn Total copy number ccf Cancer cell fraction Bio_diff Biological difference prior Prior probability expected_baf Expected BAF baf_ll BAF log-likelihood weighted_prior Weighted prior exp_baf_ll Expected BAF log-likelihood exp_prior Expected prior BAF_likelihood BAF likelihood Segcov Segment coverage BAF Observed BAF mu Mutation multiplicity rho Tumor purity","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CalbaselineCov.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate Baseline Coverage — CalbaselineCov","title":"Calculate Baseline Coverage — CalbaselineCov","text":"Calculate Baseline Coverage","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CalbaselineCov.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate Baseline Coverage — CalbaselineCov","text":"","code":"CalbaselineCov(chrom, cr, count)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CalbaselineCov.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate Baseline Coverage — CalbaselineCov","text":"chrom Chromosome cr Segment mean count Coverage count","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CalbaselineCov.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate Baseline Coverage — CalbaselineCov","text":"Baseline coverage (numeric)","code":""},{"path":[]},{"path":"https://sj-cmpb-se.github.io/XploR/reference/Calccf.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate Cancer Cell Fraction (CCF) — Calccf","text":"","code":"Calccf(total_cn, mu, rho, C_i)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/Calccf.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate Cancer Cell Fraction (CCF) — Calccf","text":"total_cn Numeric. total copy number segment. mu Numeric. Mutation multiplicity (percent, e.g., 100 means 100\\ rhoNumeric. Tumor purity (fraction 0 1). C_iNumeric. Integer copy number mutation. Numeric. estimated cancer cell fraction (CCF), Inf -Inf values capped 1 0.01, respectively.   Computes cancer cell fraction (CCF) based total copy number, mutation multiplicity, tumor purity, integer copy number.   formula : ccf = ((C_i * 2 / (mu * 100)) - ((1 - rho) * 2) - (rho * 2)) / (rho * (total_cn - 2))  CCF -Inf, returns 0.01; Inf, returns 1; otherwise returns computed value.   Calccf(total_cn = 4, mu = 100, rho = 0.6, C_i = 2)","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CallMerge.html","id":null,"dir":"Reference","previous_headings":"","what":"Merge Segments or AI Rows by Chromosome — CallMerge","title":"Merge Segments or AI Rows by Chromosome — CallMerge","text":"function splits input data chromosome merges segments AI rows within chromosome using either MergeAIRow MergeSegRow.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CallMerge.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Merge Segments or AI Rows by Chromosome — CallMerge","text":"","code":"CallMerge(data, AIorSeg, tmp_baf, snpmin, mergeai, mergecov)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CallMerge.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Merge Segments or AI Rows by Chromosome — CallMerge","text":"data data frame tibble containing segment AI information. Must include Chromosome column. AIorSeg Character string, either \"AI\" merge AI rows \"Seg\" merge segments. tmp_baf data frame use MergeAIRow. used AIorSeg == \"Seg\". snpmin Numeric. Minimum SNP count required segment considered separate segment. mergeai Numeric. Threshold difference MAF (gmm_mean) adjacent segments allow merging.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CallMerge.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Merge Segments or AI Rows by Chromosome — CallMerge","text":"data frame tibble merged segments AI rows chromosome.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CallMerge.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Merge Segments or AI Rows by Chromosome — CallMerge","text":"Uses MergeAIRow AIorSeg == \"AI\", otherwise MergeSegRow.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CallWTModel.html","id":null,"dir":"Reference","previous_headings":"","what":"Assign Copy Number Call With Model (Major/Minor) — CallWTModel","title":"Assign Copy Number Call With Model (Major/Minor) — CallWTModel","text":"Assign Copy Number Call Model (Major/Minor)","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CallWTModel.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Assign Copy Number Call With Model (Major/Minor) — CallWTModel","text":"","code":"CallWTModel(minor, major, CNF_correct, Chromosome, gender)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CallWTModel.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Assign Copy Number Call With Model (Major/Minor) — CallWTModel","text":"minor Integer. Minor allele copy number. major Integer. Major allele copy number. CNF_correct Numeric. Corrected CNF. Chromosome Character. Chromosome name. gender Character. \"male\" \"female\".","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CallWTModel.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Assign Copy Number Call With Model (Major/Minor) — CallWTModel","text":"Character. Copy number call: \"GAIN\", \"LOSS\", \"REF\", \"GAINLOH\", \"CNLOH\".","code":""},{"path":[]},{"path":"https://sj-cmpb-se.github.io/XploR/reference/Callikelihood.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate Likelihood for Each \\(\\mu\\) and \\(\\rho\\) Combination — Callikelihood","text":"","code":"Callikelihood(mu, rho, data, sigma_C, lambda, gamma, epsilon)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/Callikelihood.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate Likelihood for Each \\(\\mu\\) and \\(\\rho\\) Combination — Callikelihood","text":"mu Numeric. Mutation multiplicity (percent, e.g., 100 means 100\\ rhoNumeric. Tumor purity (fraction 0 1). dataData frame tibble. Must include columns: Segcov, BAF, index, Tag, k. sigma_CNumeric. Parameter segment likelihood (passed CalSegmentLikelihood). lambdaNumeric. Exponential decay parameter prior. gammaNumeric. Weight prior likelihood calculation. epsilonNumeric. Small value avoid log(0) zero parameters beta. data frame segment likelihoods columns CalSegmentLikelihood, plus index Tag.   segment data, computes BAF likelihood across major/minor allele combinations given mutation multiplicity (\\(\\mu\\)) tumor purity (\\(\\rho\\)).   segment, calls CalSegmentLikelihood filters combinations ccf > 1.2. one combination major minor zero, sets BAF_likelihood 1.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CallwoModel.html","id":null,"dir":"Reference","previous_headings":"","what":"Assign Copy Number Call Without Model — CallwoModel","title":"Assign Copy Number Call Without Model — CallwoModel","text":"Assign Copy Number Call Without Model","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CallwoModel.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Assign Copy Number Call Without Model — CallwoModel","text":"","code":"CallwoModel(   chromosome,   CNF_correct,   MAF_correct,   MAF_gmm_G,   MAF_Probes,   MAF_gmm_weight,   opt )"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CallwoModel.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Assign Copy Number Call Without Model — CallwoModel","text":"chromosome Character. Chromosome name. CNF_correct Numeric. Corrected CNF. MAF_correct Numeric. Corrected MAF. MAF_gmm_G Integer. Number GMM clusters. MAF_Probes Integer. Number probes used MAF. MAF_gmm_weight Numeric. GMM weight. opt List. Must include gender, callcovcutoff, callaicutoff, minsnpcallaicutoff.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CallwoModel.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Assign Copy Number Call Without Model — CallwoModel","text":"Character. Copy number call: \"GAIN\", \"LOSS\", \"REF\", \"GAINLOH\", \"CNLOH\".","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CcfLOH.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate Cancer Cell Fraction (CCF) from Allelic Imbalance (LOH) — CcfLOH","title":"Calculate Cancer Cell Fraction (CCF) from Allelic Imbalance (LOH) — CcfLOH","text":"Estimates cancer cell fraction (CCF) based minor major allele copy numbers, tumor purity, observed B-allele frequency (BAF).","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CcfLOH.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate Cancer Cell Fraction (CCF) from Allelic Imbalance (LOH) — CcfLOH","text":"","code":"CcfLOH(minor, major, rho, BAF)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CcfLOH.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate Cancer Cell Fraction (CCF) from Allelic Imbalance (LOH) — CcfLOH","text":"minor Numeric. Minor allele copy number. major Numeric. Major allele copy number. rho Numeric. Tumor purity (fraction 0 1). BAF Numeric. Observed B-allele frequency.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CcfLOH.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate Cancer Cell Fraction (CCF) from Allelic Imbalance (LOH) — CcfLOH","text":"Numeric. estimated cancer cell fraction (CCF), Inf replaced 1, -Inf NA replaced 0.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CcfLOH.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Calculate Cancer Cell Fraction (CCF) from Allelic Imbalance (LOH) — CcfLOH","text":"expected BAF calculated BAF_ex = minor / (minor + major). formula CCF : ccf = (BAF - 0.5) / ((BAF_ex - 0.5) * rho)  CCF Inf, returns 1; -Inf NA, returns 0.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CcfLOH.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Calculate Cancer Cell Fraction (CCF) from Allelic Imbalance (LOH) — CcfLOH","text":"","code":"CcfLOH(minor = 1, major = 2, rho = 0.7, BAF = 0.6) #> [1] -0.8571429"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CheckGender.html","id":null,"dir":"Reference","previous_headings":"","what":"Check and Adjust Gender in GATK Segmentation Data — CheckGender","title":"Check and Adjust Gender in GATK Segmentation Data — CheckGender","text":"Check Adjust Gender GATK Segmentation Data","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CheckGender.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Check and Adjust Gender in GATK Segmentation Data — CheckGender","text":"","code":"CheckGender(cov, seg, gender)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CheckGender.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Check and Adjust Gender in GATK Segmentation Data — CheckGender","text":"cov Coverage data frame seg Segmentation data frame gender Expected gender (character, \"male\" \"female\")","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CheckGender.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Check and Adjust Gender in GATK Segmentation Data — CheckGender","text":"Modified segmentation seg data frame gender information","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/Checkmode.html","id":null,"dir":"Reference","previous_headings":"","what":"Check and Set Mode-Specific Options — Checkmode","title":"Check and Set Mode-Specific Options — Checkmode","text":"Checks required options 'model' 'region' mode sets defaults needed.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/Checkmode.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Check and Set Mode-Specific Options — Checkmode","text":"","code":"Checkmode(opt, call)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/Checkmode.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Check and Set Mode-Specific Options — Checkmode","text":"opt List options. Must include mode (either \"model\" \"region\"), possibly purity, dicovsf, chromosome. call Data frame tibble. Segment call data, required estimating coverage scale factor region mode.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/Checkmode.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Check and Set Mode-Specific Options — Checkmode","text":"(potentially modified) opt list.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/Checkmode.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Check and Set Mode-Specific Options — Checkmode","text":"mode == \"model\": requires least one purity dicovsf. mode == \"region\": requires chromosome; dicovsf missing, estimated call.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/Checkmode.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Check and Set Mode-Specific Options — Checkmode","text":"","code":"# opt <- list(mode = \"model\", purity = NULL, dicovsf = NULL) # Checkmode(opt, call)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/ClusterAdjacent.html","id":null,"dir":"Reference","previous_headings":"","what":"Cluster Adjacent Values Based on a Threshold — ClusterAdjacent","title":"Cluster Adjacent Values Based on a Threshold — ClusterAdjacent","text":"Groups adjacent values clusters difference less specified threshold, computes mean total weight cluster.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/ClusterAdjacent.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Cluster Adjacent Values Based on a Threshold — ClusterAdjacent","text":"","code":"ClusterAdjacent(values, weights, threshold = 0.01)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/ClusterAdjacent.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Cluster Adjacent Values Based on a Threshold — ClusterAdjacent","text":"values Numeric vector values cluster (e.g., means GMM components). weights Numeric vector weights corresponding values. threshold Numeric value specifying maximum allowed difference adjacent values grouped cluster. Default 0.01.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/ClusterAdjacent.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Cluster Adjacent Values Based on a Threshold — ClusterAdjacent","text":"list two elements: means Numeric vector cluster means. weights Numeric vector aggregated cluster weights.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/ClusterAdjacent.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Cluster Adjacent Values Based on a Threshold — ClusterAdjacent","text":"","code":"ClusterAdjacent(c(0.1, 0.11, 0.5), c(0.3, 0.4, 0.3)) #> $means #> [1] 0.105 0.500 #>  #> $weights #> [1] 0.7 0.3 #>"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/ClusterModels.html","id":null,"dir":"Reference","previous_headings":"","what":"Cluster and Select the Best Models Based on Likelihood and Copy Number Distance — ClusterModels","title":"Cluster and Select the Best Models Based on Likelihood and Copy Number Distance — ClusterModels","text":"Clusters models total likelihood, diploid nondiploid distance integer copy number, selects best (mu, rho) model.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/ClusterModels.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Cluster and Select the Best Models Based on Likelihood and Copy Number Distance — ClusterModels","text":"","code":"ClusterModels(models_dis)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/ClusterModels.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Cluster and Select the Best Models Based on Likelihood and Copy Number Distance — ClusterModels","text":"models_dis data frame tibble model metrics, including columns: total_log_likelihood, diploid_distance_to_integer, nondiploid_distance_to_integer, ploidy, mu, rho, diploid_n, etc.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/ClusterModels.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Cluster and Select the Best Models Based on Likelihood and Copy Number Distance — ClusterModels","text":"list : Final_mu Best model's mutation multiplicity. Final_rho Best model's tumor purity. total_distance_to_integer Total distance integer copy number best model. total_likelihood Total log-likelihood best model. models full, clustered, sorted model data frame.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/ClusterModels.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Cluster and Select the Best Models Based on Likelihood and Copy Number Distance — ClusterModels","text":"Models clustered using change point detection likelihood distance metrics. best model selected series sort criteria.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/ClusterModels.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Cluster and Select the Best Models Based on Likelihood and Copy Number Distance — ClusterModels","text":"","code":"# models_dis <- ... # output from SelectModelByDis # ClusterModels(models_dis)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CorrectBAF.html","id":null,"dir":"Reference","previous_headings":"","what":"Correct MAF Values Using a Scaling Factor — CorrectBAF","title":"Correct MAF Values Using a Scaling Factor — CorrectBAF","text":"Applies scaling factor MAF values.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CorrectBAF.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Correct MAF Values Using a Scaling Factor — CorrectBAF","text":"","code":"CorrectBAF(baf, baf_scale)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CorrectBAF.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Correct MAF Values Using a Scaling Factor — CorrectBAF","text":"baf data frame tibble numeric column named baf. baf_scale Numeric. scaling factor applied MAF values.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CorrectBAF.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Correct MAF Values Using a Scaling Factor — CorrectBAF","text":"data frame tibble corrected baf column.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CorrectGender.html","id":null,"dir":"Reference","previous_headings":"","what":"Correct Copy Ratio File if GATK and Pipeline Gender Disagree — CorrectGender","title":"Correct Copy Ratio File if GATK and Pipeline Gender Disagree — CorrectGender","text":"Adjusts X chromosome log2 copy ratio coverage data gender assigned GATK pipeline match.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CorrectGender.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Correct Copy Ratio File if GATK and Pipeline Gender Disagree — CorrectGender","text":"","code":"CorrectGender(cov, seg)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CorrectGender.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Correct Copy Ratio File if GATK and Pipeline Gender Disagree — CorrectGender","text":"cov Data frame tibble. Coverage data, must include columns CONTIG LOG2_COPY_RATIO. seg Data frame tibble. Segmentation data, must include columns gatk_gender pipeline_gender.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CorrectGender.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Correct Copy Ratio File if GATK and Pipeline Gender Disagree — CorrectGender","text":"corrected coverage data frame tibble.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CorrectGender.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Correct Copy Ratio File if GATK and Pipeline Gender Disagree — CorrectGender","text":"GATK gender \"male\" pipeline gender \"female\", subtracts 1 X chromosome log2 copy ratio. GATK gender \"female\" pipeline gender \"male\", adds 1 X chromosome log2 copy ratio. Otherwise, returns input coverage unchanged.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CorrectGender.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Correct Copy Ratio File if GATK and Pipeline Gender Disagree — CorrectGender","text":"","code":"# CorrectGender(cov, seg)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CorrectPurity.html","id":null,"dir":"Reference","previous_headings":"","what":"Correct CNF and MAF According to Purity — CorrectPurity","title":"Correct CNF and MAF According to Purity — CorrectPurity","text":"Correct CNF MAF According Purity","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CorrectPurity.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Correct CNF and MAF According to Purity — CorrectPurity","text":"","code":"CorrectPurity(chromosome, cov_segmentmean, MAF_observe, gender, purity)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CorrectPurity.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Correct CNF and MAF According to Purity — CorrectPurity","text":"chromosome Character. Chromosome name. cov_segmentmean Numeric. Segment mean (log2 ratio). MAF_observe Numeric. Observed minor allele frequency. gender Character. \"male\" \"female\". purity Numeric. Tumor purity (fraction 0 1).","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CorrectPurity.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Correct CNF and MAF According to Purity — CorrectPurity","text":"list CNF_correct MAF_correct.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CoverageQC.html","id":null,"dir":"Reference","previous_headings":"","what":"Summarise BAF QC from CNV Segment Annotation — CoverageQC","title":"Summarise BAF QC from CNV Segment Annotation — CoverageQC","text":"Summarises number size \"PASS\" segments per chromosome CNV annotation file.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CoverageQC.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summarise BAF QC from CNV Segment Annotation — CoverageQC","text":"","code":"CoverageQC(annofile)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CoverageQC.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Summarise BAF QC from CNV Segment Annotation — CoverageQC","text":"annofile Path CNV annotation file (e.g., *_CNV_annotation.tsv).","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/CoverageQC.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Summarise BAF QC from CNV Segment Annotation — CoverageQC","text":"Invisibly returns summary data frame.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/EstimateBAFbyGMM.html","id":null,"dir":"Reference","previous_headings":"","what":"Estimate BAF Cluster Mean and Weight Using Gaussian Mixture Modeling — EstimateBAFbyGMM","title":"Estimate BAF Cluster Mean and Weight Using Gaussian Mixture Modeling — EstimateBAFbyGMM","text":"Fits Gaussian mixture model (GMM) B-allele frequency (BAF) values returns prominent cluster's mean weight. Clusters similar means (within threshold) merged. insufficient values nearly variance, simple mean returned.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/EstimateBAFbyGMM.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Estimate BAF Cluster Mean and Weight Using Gaussian Mixture Modeling — EstimateBAFbyGMM","text":"","code":"EstimateBAFbyGMM(baf_values)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/EstimateBAFbyGMM.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Estimate BAF Cluster Mean and Weight Using Gaussian Mixture Modeling — EstimateBAFbyGMM","text":"baf_values Numeric vector BAF values.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/EstimateBAFbyGMM.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Estimate BAF Cluster Mean and Weight Using Gaussian Mixture Modeling — EstimateBAFbyGMM","text":"Named numeric vector elements: gmm_mean mean prominent cluster (capped 0.5). gmm_weight mixture weight prominent cluster. gmm_G Number clusters merging adjacent means.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/EstimateBAFbyGMM.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Estimate BAF Cluster Mean and Weight Using Gaussian Mixture Modeling — EstimateBAFbyGMM","text":"Uses Mclust Gaussian mixture modeling ClusterAdjacent merge similar clusters.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/EstimateBAFshift.html","id":null,"dir":"Reference","previous_headings":"","what":"Estimate MAF Shift Scaling Factor — EstimateBAFshift","title":"Estimate MAF Shift Scaling Factor — EstimateBAFshift","text":"Estimates scaling factor correct MAF shift.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/EstimateBAFshift.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Estimate MAF Shift Scaling Factor — EstimateBAFshift","text":"","code":"EstimateBAFshift(baf)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/EstimateBAFshift.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Estimate MAF Shift Scaling Factor — EstimateBAFshift","text":"baf data frame tibble least baf column (numeric MAF values).","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/EstimateBAFshift.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Estimate MAF Shift Scaling Factor — EstimateBAFshift","text":"Numeric. estimated MAF scaling factor, NA enough SNPs.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/EstimateBAFshift.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Estimate MAF Shift Scaling Factor — EstimateBAFshift","text":"Uses Mclust Gaussian mixture modeling.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/EstimateCovSF.html","id":null,"dir":"Reference","previous_headings":"","what":"Estimate Coverage Scale Factor for a Chromosome or Region — EstimateCovSF","title":"Estimate Coverage Scale Factor for a Chromosome or Region — EstimateCovSF","text":"Estimates coverage scale factor (covsf) specified chromosome region, based segment mean probe count.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/EstimateCovSF.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Estimate Coverage Scale Factor for a Chromosome or Region — EstimateCovSF","text":"","code":"EstimateCovSF(opt, seg)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/EstimateCovSF.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Estimate Coverage Scale Factor for a Chromosome or Region — EstimateCovSF","text":"opt List options. Must include chromosome; may include start end (numeric). seg Data frame tibble. Segment data, must include columns Chromosome, Start, End, Segment_Mean, Num_Probes.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/EstimateCovSF.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Estimate Coverage Scale Factor for a Chromosome or Region — EstimateCovSF","text":"Numeric. estimated coverage scale factor (covsf) specified region.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/EstimateCovSF.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Estimate Coverage Scale Factor for a Chromosome or Region — EstimateCovSF","text":"chromosome defined, uses entire chromosome. start defined, uses regions start end (end provided). end defined, uses regions chromosome start end.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/EstimateCovSF.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Estimate Coverage Scale Factor for a Chromosome or Region — EstimateCovSF","text":"","code":"# opt <- list(chromosome = \"3\", start = NULL, end = NULL) # EstimateCovSF(opt, seg)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/EstimateMAFbyGMM.html","id":null,"dir":"Reference","previous_headings":"","what":"Estimate MAF Cluster Mean and Weight Using Gaussian Mixture Modeling — EstimateMAFbyGMM","title":"Estimate MAF Cluster Mean and Weight Using Gaussian Mixture Modeling — EstimateMAFbyGMM","text":"Fits Gaussian mixture model (GMM) Minor allele frequency (MAF) values returns prominent cluster's mean weight. Clusters similar means (within threshold) merged. insufficient values nearly variance, simple mean returned.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/EstimateMAFbyGMM.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Estimate MAF Cluster Mean and Weight Using Gaussian Mixture Modeling — EstimateMAFbyGMM","text":"","code":"EstimateMAFbyGMM(baf_values)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/EstimateMAFbyGMM.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Estimate MAF Cluster Mean and Weight Using Gaussian Mixture Modeling — EstimateMAFbyGMM","text":"baf_values Numeric vector MAF values.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/EstimateMAFbyGMM.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Estimate MAF Cluster Mean and Weight Using Gaussian Mixture Modeling — EstimateMAFbyGMM","text":"Named numeric vector elements: gmm_mean mean prominent cluster (capped 0.5). gmm_weight mixture weight prominent cluster. gmm_G Number clusters merging adjacent means.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/EstimateMAFbyGMM.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Estimate MAF Cluster Mean and Weight Using Gaussian Mixture Modeling — EstimateMAFbyGMM","text":"Uses Mclust Gaussian mixture modeling.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/EstimateMinPurity.html","id":null,"dir":"Reference","previous_headings":"","what":"Estimate Minimum Tumor Purity from BAF Data — EstimateMinPurity","title":"Estimate Minimum Tumor Purity from BAF Data — EstimateMinPurity","text":"Estimates minimum tumor purity based lowest B-allele frequency (BAF) among segments tagged \"Include\".","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/EstimateMinPurity.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Estimate Minimum Tumor Purity from BAF Data — EstimateMinPurity","text":"","code":"EstimateMinPurity(df)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/EstimateMinPurity.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Estimate Minimum Tumor Purity from BAF Data — EstimateMinPurity","text":"df data frame tibble containing least columns BAF Tag.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/EstimateMinPurity.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Estimate Minimum Tumor Purity from BAF Data — EstimateMinPurity","text":"Numeric. estimated minimum tumor purity, 0 suitable segments found.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/EstimateMinPurity.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Estimate Minimum Tumor Purity from BAF Data — EstimateMinPurity","text":"rows Tag == \"Include\" considered. minimum BAF less 0.4, minimum purity estimated max((0.5 - min\\_BAF) / 0.5 - 0.05, 0). Otherwise, returns 0.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/EstimateMinPurity.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Estimate Minimum Tumor Purity from BAF Data — EstimateMinPurity","text":"","code":"df <- data.frame(BAF = c(0.3, 0.45, 0.5), Tag = c(\"Include\", \"Exclude\", \"Include\")) EstimateMinPurity(df) #> Error in df %>% dplyr::filter(Tag == \"Include\") %>% dplyr::arrange(BAF): could not find function \"%>%\""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/EstimatePurityCov.html","id":null,"dir":"Reference","previous_headings":"","what":"Estimate Tumor Purity from Coverage and Segmentation Data — EstimatePurityCov","title":"Estimate Tumor Purity from Coverage and Segmentation Data — EstimatePurityCov","text":"Estimates tumor purity fitting coverage BAF segmentation data across range purity values, selecting purity best matches integer copy number models.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/EstimatePurityCov.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Estimate Tumor Purity from Coverage and Segmentation Data — EstimatePurityCov","text":"","code":"EstimatePurityCov(seg)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/EstimatePurityCov.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Estimate Tumor Purity from Coverage and Segmentation Data — EstimatePurityCov","text":"seg data frame tibble segment data, columns: Chromosome, Segment_Mean, MAF, MAF_gmm_G, MAF_Probes, MAF_gmm_weight, size, etc. opt list options, must include gender.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/EstimatePurityCov.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Estimate Tumor Purity from Coverage and Segmentation Data — EstimatePurityCov","text":"list elements: dis_df Data frame model fit statistics purity. Final_model List Final_mu Final_rho (selected purity). min_dis Minimum distance integer copy numbers. seg_call Segment calls selected purity. Model_source String, always \"Coverage\".","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/EstimatePurityCov.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Estimate Tumor Purity from Coverage and Segmentation Data — EstimatePurityCov","text":"function fits models sequence purity values, applies segment correction calling, selects purity best fit integer copy number.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/EstimateSFVariance.html","id":null,"dir":"Reference","previous_headings":"","what":"Estimate Standard Deviation of a Numeric Vector — EstimateSFVariance","title":"Estimate Standard Deviation of a Numeric Vector — EstimateSFVariance","text":"Calculates standard deviation (sigma) sample variance numeric vector.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/EstimateSFVariance.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Estimate Standard Deviation of a Numeric Vector — EstimateSFVariance","text":"","code":"EstimateSFVariance(x)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/EstimateSFVariance.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Estimate Standard Deviation of a Numeric Vector — EstimateSFVariance","text":"x Numeric vector.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/EstimateSFVariance.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Estimate Standard Deviation of a Numeric Vector — EstimateSFVariance","text":"Numeric. estimated standard deviation x.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/EstimateSFVariance.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Estimate Standard Deviation of a Numeric Vector — EstimateSFVariance","text":"function computes sample variance using var(x) returns square root.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/EstimateSFVariance.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Estimate Standard Deviation of a Numeric Vector — EstimateSFVariance","text":"","code":"EstimateSFVariance(c(1, 2, 3, 4, 5)) #> [1] 1.581139"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/ExtractCall.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract Final Calls for a Given (mu, rho) Model — ExtractCall","title":"Extract Final Calls for a Given (mu, rho) Model — ExtractCall","text":"given (mu, rho) combination, joins segment call results segment metadata returns final calls.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/ExtractCall.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract Final Calls for a Given (mu, rho) Model — ExtractCall","text":"","code":"ExtractCall(df, max_L_mu, max_L_rho, seg)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/ExtractCall.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract Final Calls for a Given (mu, rho) Model — ExtractCall","text":"df Data frame tibble. Contains segment call results, including columns mu, rho, index. max_L_mu Numeric. selected value mutation multiplicity (mu). max_L_rho Numeric. selected value tumor purity (rho). seg Data frame tibble. Segment metadata, must include column index.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/ExtractCall.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extract Final Calls for a Given (mu, rho) Model — ExtractCall","text":"data frame tibble final calls given (mu, rho) model, joined segment metadata.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/ExtractCall.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Extract Final Calls for a Given (mu, rho) Model — ExtractCall","text":"","code":"# ExtractCall(df, max_L_mu = 1, max_L_rho = 0.7, seg)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/FindTier1Models.html","id":null,"dir":"Reference","previous_headings":"","what":"Find the ","title":"Find the ","text":"Identifies first major drop (\"elbow\") sorted vector values, using smoothed difference approach.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/FindTier1Models.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Find the ","text":"","code":"FindTier1Models(values, fold)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/FindTier1Models.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Find the ","text":"values Numeric vector. Typically sorted (e.g., decreasing likelihoods scores). fold Numeric. Multiplicative factor median drop define significant elbow (e.g., 1.5).","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/FindTier1Models.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Find the ","text":"Integer. index first major drop (\"elbow\") values vector.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/FindTier1Models.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Find the ","text":"Uses rolling mean negative differences smooth noise find first drop exceeding fold times median drop. drop found, uses geometric \"elbow\" method fallback.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/FindTier1Models.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Find the ","text":"","code":"set.seed(1) vals <- sort(runif(20, 0, 10), decreasing = TRUE) FindTier1Models(vals, fold = 1.5) #> [1] 11"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/FixsegmentMean.html","id":null,"dir":"Reference","previous_headings":"","what":"Fix Segment Mean Based on Gender Discrepancy — FixsegmentMean","title":"Fix Segment Mean Based on Gender Discrepancy — FixsegmentMean","text":"Fix Segment Mean Based Gender Discrepancy","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/FixsegmentMean.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fix Segment Mean Based on Gender Discrepancy — FixsegmentMean","text":"","code":"FixsegmentMean(sm, gatkgender, pipeline_gender)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/FixsegmentMean.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Fix Segment Mean Based on Gender Discrepancy — FixsegmentMean","text":"sm Segment mean gatkgender Gender GATK pipeline_gender Gender clinical info","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/FixsegmentMean.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Fix Segment Mean Based on Gender Discrepancy — FixsegmentMean","text":"Adjusted segment mean","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/GenerateCombinations.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate All Major/Minor Allele Combinations for a Given Total Copy Number — GenerateCombinations","title":"Generate All Major/Minor Allele Combinations for a Given Total Copy Number — GenerateCombinations","text":"Generates valid combinations major minor allele copy numbers sum specified total copy number, constraint major >= minor.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/GenerateCombinations.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate All Major/Minor Allele Combinations for a Given Total Copy Number — GenerateCombinations","text":"","code":"GenerateCombinations(total_cn)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/GenerateCombinations.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate All Major/Minor Allele Combinations for a Given Total Copy Number — GenerateCombinations","text":"total_cn Integer. total copy number.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/GenerateCombinations.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate All Major/Minor Allele Combinations for a Given Total Copy Number — GenerateCombinations","text":"data frame columns: major Major allele copy number. minor Minor allele copy number. total_cn Sum major minor (equals input total_cn).","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/GenerateCombinations.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Generate All Major/Minor Allele Combinations for a Given Total Copy Number — GenerateCombinations","text":"","code":"GenerateCombinations(3) #> Error in expand.grid(major = 0:total_cn, minor = 0:total_cn) %>% subset(major >=     minor & major + minor == total_cn) %>% dplyr::mutate(total_cn = major +     minor): could not find function \"%>%\""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/Groupvalues.html","id":null,"dir":"Reference","previous_headings":"","what":"Group Values by Change Points in the Mean — Groupvalues","title":"Group Values by Change Points in the Mean — Groupvalues","text":"Uses changepoint package detect change points mean numeric vector assigns group IDs accordingly.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/Groupvalues.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Group Values by Change Points in the Mean — Groupvalues","text":"","code":"Groupvalues(x)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/Groupvalues.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Group Values by Change Points in the Mean — Groupvalues","text":"x Numeric vector.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/Groupvalues.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Group Values by Change Points in the Mean — Groupvalues","text":"integer vector length x, element indicates group assignment based detected change points.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/Groupvalues.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Group Values by Change Points in the Mean — Groupvalues","text":"Uses cpt.mean changepoint package PELT method MBIC penalty detect change points mean.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/Groupvalues.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Group Values by Change Points in the Mean — Groupvalues","text":"","code":"# Example with a simulated change in mean set.seed(123) x <- c(rnorm(50, 0), rnorm(50, 3)) group_id <- Groupvalues(x) table(group_id) #> group_id #>  1  2  #> 50 50"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/MergeAICheck.html","id":null,"dir":"Reference","previous_headings":"","what":"Check Whether Two AI Segments Should Be Merged — MergeAICheck","title":"Check Whether Two AI Segments Should Be Merged — MergeAICheck","text":"function determines whether two adjacent AI (allelic imbalance) segments merged, based difference GMM means quality thresholds.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/MergeAICheck.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Check Whether Two AI Segments Should Be Merged — MergeAICheck","text":"","code":"MergeAICheck(cur_row, next_row, mergeai, snpmin)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/MergeAICheck.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Check Whether Two AI Segments Should Be Merged — MergeAICheck","text":"cur_row data frame row (list tibble row) representing current segment. Must include relevant columns (e.g., gmm_mean, gmm_weight, nonzero_count). next_row data frame row (list tibble row) representing next segment. Must include relevant columns (e.g., gmm_mean, gmm_weight, nonzero_count). mergeai Numeric. Threshold difference MAF (gmm_mean) adjacent segments allow merging. snpmin Numeric. Minimum SNP count required segment considered separate segment.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/MergeAICheck.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Check Whether Two AI Segments Should Be Merged — MergeAICheck","text":"Logical value: TRUE two segments merged, FALSE otherwise.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/MergeAIRow.html","id":null,"dir":"Reference","previous_headings":"","what":"Merge Adjacent AI Segments Based on Similarity Criteria — MergeAIRow","title":"Merge Adjacent AI Segments Based on Similarity Criteria — MergeAIRow","text":"Iteratively merges adjacent rows data frame AI segments meet criteria defined MergeAICheck. merged segments, MAF values re-estimated segment information updated.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/MergeAIRow.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Merge Adjacent AI Segments Based on Similarity Criteria — MergeAIRow","text":"","code":"MergeAIRow(df, mergeai, snpmin, tmp_baf)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/MergeAIRow.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Merge Adjacent AI Segments Based on Similarity Criteria — MergeAIRow","text":"df data frame tibble AI segments, columns Chromosome, bin, Start, End, snp_count, each_baf, etc. mergeai Numeric. Threshold difference MAF (gmm_mean) adjacent segments allow merging. snpmin Numeric. Minimum SNP count required segment considered separate segment. tmp_baf data frame tibble containing BAF values genomic coordinates (must include Chromosome, Start, End, baf).","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/MergeAIRow.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Merge Adjacent AI Segments Based on Similarity Criteria — MergeAIRow","text":"data frame tibble merged AI segments, updated BAF estimates, segment information.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/MergeAIRow.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Merge Adjacent AI Segments Based on Similarity Criteria — MergeAIRow","text":"function uses MergeAICheck determine two adjacent segments merged. merged segments, BAF values re-estimated using EstimateBAFbyGMM.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/MergeSegCheck.html","id":null,"dir":"Reference","previous_headings":"","what":"Check Whether Two Segments Should Be Merged (Copy Number) — MergeSegCheck","title":"Check Whether Two Segments Should Be Merged (Copy Number) — MergeSegCheck","text":"Determines whether two adjacent copy number segments merged based difference segment means whether calls identical.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/MergeSegCheck.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Check Whether Two Segments Should Be Merged (Copy Number) — MergeSegCheck","text":"","code":"MergeSegCheck(cur_row, next_row, mergecov)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/MergeSegCheck.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Check Whether Two Segments Should Be Merged (Copy Number) — MergeSegCheck","text":"cur_row data frame row (list tibble row) representing current segment. Must Segment_Mean Call. next_row data frame row (list tibble row) representing next segment. Must Segment_Mean Call. mergecov Numeric threshold segment mean difference","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/MergeSegCheck.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Check Whether Two Segments Should Be Merged (Copy Number) — MergeSegCheck","text":"Logical value: TRUE two segments merged, FALSE otherwise.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/MergeSegRow.html","id":null,"dir":"Reference","previous_headings":"","what":"Merge Adjacent Copy Number Segments Based on Similarity Criteria — MergeSegRow","title":"Merge Adjacent Copy Number Segments Based on Similarity Criteria — MergeSegRow","text":"Iteratively merges adjacent rows data frame copy number segments meet criteria defined MergeSegCheck. merged segments, segment greater number probes provides call, segment mean, count, baseline coverage.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/MergeSegRow.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Merge Adjacent Copy Number Segments Based on Similarity Criteria — MergeSegRow","text":"","code":"MergeSegRow(df, mergecov)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/MergeSegRow.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Merge Adjacent Copy Number Segments Based on Similarity Criteria — MergeSegRow","text":"df data frame tibble copy number segments, columns Sample, Chromosome, Start, End, Num_Probes, Call, Segment_Mean, etc. mergecov Numeric threshold merging segment mean value.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/MergeSegRow.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Merge Adjacent Copy Number Segments Based on Similarity Criteria — MergeSegRow","text":"data frame tibble merged segments updated segment information.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/MergeSegRow.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Merge Adjacent Copy Number Segments Based on Similarity Criteria — MergeSegRow","text":"function uses MergeSegCheck determine two adjacent segments merged.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/ModelSource.html","id":null,"dir":"Reference","previous_headings":"","what":"Determine Model Source Based on BAF and Coverage Information — ModelSource","title":"Determine Model Source Based on BAF and Coverage Information — ModelSource","text":"Determines whether model source segment \"Coverage\", \"Diploid\", \"Coverage + BAF\", based BAF segment mean values.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/ModelSource.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Determine Model Source Based on BAF and Coverage Information — ModelSource","text":"","code":"ModelSource(seg_df, opt)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/ModelSource.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Determine Model Source Based on BAF and Coverage Information — ModelSource","text":"seg_df data frame tibble containing segment information, including columns: size, FILTER, MAF_Probes, MAF, Segment_Mean. opt list options, must include modelminprobes (minimum number probes model decision).","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/ModelSource.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Determine Model Source Based on BAF and Coverage Information — ModelSource","text":"Character. One \"Coverage\", \"Diploid\", \"Coverage + BAF\".","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/ModelSource.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Determine Model Source Based on BAF and Coverage Information — ModelSource","text":"segments sufficient probes minimum BAF > 0.4 maximum absolute segment mean >= 0.2, returns \"Coverage\". segments sufficient probes minimum BAF > 0.4 maximum absolute segment mean < 0.2, returns \"Diploid\". Otherwise, returns \"Coverage + BAF\".","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/ModelSource.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Determine Model Source Based on BAF and Coverage Information — ModelSource","text":"","code":"# seg_df must have columns: size, FILTER, MAF_Probes, MAF, Segment_Mean # opt <- list(modelminprobes = 7) # ModelSource(seg_df, opt)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/ParseParm.html","id":null,"dir":"Reference","previous_headings":"","what":"Parse Purity and Scale Factor Parameters for Model Selection — ParseParm","title":"Parse Purity and Scale Factor Parameters for Model Selection — ParseParm","text":"Parses user-specified purity scale factor (dicovsf) options, selects matching models, returns best match.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/ParseParm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Parse Purity and Scale Factor Parameters for Model Selection — ParseParm","text":"","code":"ParseParm(opt, models)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/ParseParm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Parse Purity and Scale Factor Parameters for Model Selection — ParseParm","text":"opt List options. May include purity (numeric range \"min:max\") dicovsf (numeric range \"min:max\"). models Data frame tibble. Must include columns rho, mu, total_distance_to_integer, total_log_likelihood.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/ParseParm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Parse Purity and Scale Factor Parameters for Model Selection — ParseParm","text":"list : final_purity Selected purity value. final_sf Selected scale factor (mu) value.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/ParseParm.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Parse Purity and Scale Factor Parameters for Model Selection — ParseParm","text":"opt$purity opt$dicovsf ranges (e.g., \"0.6:0.8\"), selects models range. Otherwise, selects model(s) closest specified value. Returns model minimal distance integer maximal likelihood.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/ParseParm.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Parse Purity and Scale Factor Parameters for Model Selection — ParseParm","text":"","code":"# opt <- list(purity = \"0.6:0.8\", dicovsf = NULL) # ParseParm(opt, models)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/PlotCovDisCN.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot Coverage Distance to Integer Copy Number vs. Purity — PlotCovDisCN","title":"Plot Coverage Distance to Integer Copy Number vs. Purity — PlotCovDisCN","text":"Plots distance integer copy number (dis_integer_CN) purity (rho) highlights minimum distance.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/PlotCovDisCN.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot Coverage Distance to Integer Copy Number vs. Purity — PlotCovDisCN","text":"","code":"PlotCovDisCN(dis, opt, purity, min_dis)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/PlotCovDisCN.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot Coverage Distance to Integer Copy Number vs. Purity — PlotCovDisCN","text":"dis Data frame tibble. Must include columns rho dis_integer_CN. opt List options. Must include out_dir prefix. purity Numeric. selected purity value highlight. min_dis Numeric. minimum distance integer copy number highlight.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/PlotCovDisCN.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot Coverage Distance to Integer Copy Number vs. Purity — PlotCovDisCN","text":"Invisibly returns ggplot object (FALSE plotting failed).","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/PlotCovDisCN.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot Coverage Distance to Integer Copy Number vs. Purity — PlotCovDisCN","text":"","code":"# PlotCovDisCN(dis, opt, purity = 0.7, min_dis = 2)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/PlotLikelihoodAndDistance.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot Model Likelihood and Distance Clusters as an Interactive Heatmap — PlotLikelihoodAndDistance","title":"Plot Model Likelihood and Distance Clusters as an Interactive Heatmap — PlotLikelihoodAndDistance","text":"Plots interactive heatmap total likelihood cluster assignments, best model highlighted, saves HTML file.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/PlotLikelihoodAndDistance.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot Model Likelihood and Distance Clusters as an Interactive Heatmap — PlotLikelihoodAndDistance","text":"","code":"PlotLikelihoodAndDistance(df, Final_model, opt)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/PlotLikelihoodAndDistance.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot Model Likelihood and Distance Clusters as an Interactive Heatmap — PlotLikelihoodAndDistance","text":"df Data frame tibble. Must include columns mu, rho, total_likelihood_cluster, diploid_distance_cluster, nondiploid_distance_cluster. Final_model List. Output ClusterModels, must include Final_mu Final_rho. opt List options. Must include out_dir prefix.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/PlotLikelihoodAndDistance.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot Model Likelihood and Distance Clusters as an Interactive Heatmap — PlotLikelihoodAndDistance","text":"Invisibly returns interactive plotly object (FALSE plotting failed).","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/PlotLikelihoodAndDistance.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot Model Likelihood and Distance Clusters as an Interactive Heatmap — PlotLikelihoodAndDistance","text":"","code":"# PlotLikelihoodAndDistance(df, Final_model, opt)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/PlotModel.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot Model Total Log-Likelihoods as a Heatmap — PlotModel","title":"Plot Model Total Log-Likelihoods as a Heatmap — PlotModel","text":"Plots heatmap total log-likelihoods (mu, rho) combinations highlights selected model.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/PlotModel.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot Model Total Log-Likelihoods as a Heatmap — PlotModel","text":"","code":"PlotModel(data, opt, max_L_mu, max_L_rho)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/PlotModel.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot Model Total Log-Likelihoods as a Heatmap — PlotModel","text":"data Data frame tibble. Must include columns rho, mu, total_log_likelihood_before_refine. opt List options. Must include out_dir prefix. max_L_mu Numeric. selected value mutation multiplicity (mu) highlight. max_L_rho Numeric. selected value tumor purity (rho) highlight.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/PlotModel.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot Model Total Log-Likelihoods as a Heatmap — PlotModel","text":"Invisibly returns ggplot object (FALSE plotting failed).","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/PlotModel.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot Model Total Log-Likelihoods as a Heatmap — PlotModel","text":"","code":"# PlotModel(data, opt, max_L_mu = 1, max_L_rho = 0.7)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/PlotModelDot.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot Model Total Log-Likelihoods as a Dot Plot — PlotModelDot","title":"Plot Model Total Log-Likelihoods as a Dot Plot — PlotModelDot","text":"Plots total log-likelihood model dot plot marks tier 1 index vertical line.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/PlotModelDot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot Model Total Log-Likelihoods as a Dot Plot — PlotModelDot","text":"","code":"PlotModelDot(models, opt, tier1_index)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/PlotModelDot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot Model Total Log-Likelihoods as a Dot Plot — PlotModelDot","text":"models Data frame tibble. Must include total_log_likelihood column. opt List options. Must include out_dir prefix. tier1_index Integer. index (rank) tier 1 model highlight.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/PlotModelDot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot Model Total Log-Likelihoods as a Dot Plot — PlotModelDot","text":"Invisibly returns ggplot object (FALSE plotting failed).","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/PlotModelDot.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot Model Total Log-Likelihoods as a Dot Plot — PlotModelDot","text":"","code":"# PlotModelDot(models, opt, tier1_index = 10)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/RefineCalls.html","id":null,"dir":"Reference","previous_headings":"","what":"Refine Segment Calls According to the Final Model — RefineCalls","title":"Refine Segment Calls According to the Final Model — RefineCalls","text":"Refines values calls segment based selected (mu, rho) model, adjusting segment mean, purity, copy number calls.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/RefineCalls.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Refine Segment Calls According to the Final Model — RefineCalls","text":"","code":"RefineCalls(df, max_L_mu, max_L_rho, opt)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/RefineCalls.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Refine Segment Calls According to the Final Model — RefineCalls","text":"df Data frame tibble. Segment call data, must include columns used refinement. max_L_mu Numeric. selected value mutation multiplicity (mu). max_L_rho Numeric. selected value tumor purity (rho). opt List options, must include gender.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/RefineCalls.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Refine Segment Calls According to the Final Model — RefineCalls","text":"data frame tibble refined segment calls, ordered chromosome start position.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/RefineCalls.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Refine Segment Calls According to the Final Model — RefineCalls","text":"","code":"# RefineCalls(df, max_L_mu = 1, max_L_rho = 0.7, opt)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/RefineCallsSecond.html","id":null,"dir":"Reference","previous_headings":"","what":"Second Refinement of Segment Calls for Cov/AI Profile Mismatches — RefineCallsSecond","title":"Second Refinement of Segment Calls for Cov/AI Profile Mismatches — RefineCallsSecond","text":"refines segment calls segments coverage profile allelic imbalance (AI) profile match, considering alternative copy number states likelihood results.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/RefineCallsSecond.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Second Refinement of Segment Calls for Cov/AI Profile Mismatches — RefineCallsSecond","text":"","code":"RefineCallsSecond(df, results, final_mu, final_rho, opt)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/RefineCallsSecond.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Second Refinement of Segment Calls for Cov/AI Profile Mismatches — RefineCallsSecond","text":"df Data frame tibble. Refined segment calls (see RefineCalls), must include columns col_name. results Data frame tibble. likelihood results possible copy number states, must include columns rho, mu, index, total_cn, etc. final_mu Numeric. selected value mutation multiplicity (mu). final_rho Numeric. selected value tumor purity (rho). opt List options, must include gender callcov.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/RefineCallsSecond.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Second Refinement of Segment Calls for Cov/AI Profile Mismatches — RefineCallsSecond","text":"data frame tibble refined segment calls, including new columns ccf_COV, ccf_final, CN_mix.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/RefineCallsSecond.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Second Refinement of Segment Calls for Cov/AI Profile Mismatches — RefineCallsSecond","text":"","code":"# RefineCallsSecond(df, results, final_mu = 1, final_rho = 0.7, opt)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/RefineTier1Models.html","id":null,"dir":"Reference","previous_headings":"","what":"Refine Tier 1 Models and Their Segment Calls — RefineTier1Models","title":"Refine Tier 1 Models and Their Segment Calls — RefineTier1Models","text":"candidate (mu, rho) model tier1, extracts refines segment calls, computes fit statistics, returns list calls model summaries.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/RefineTier1Models.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Refine Tier 1 Models and Their Segment Calls — RefineTier1Models","text":"","code":"RefineTier1Models(   tier1,   results,   top_likelihood_rows,   likelihood_min,   seg,   opt )"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/RefineTier1Models.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Refine Tier 1 Models and Their Segment Calls — RefineTier1Models","text":"tier1 Data frame tibble. row candidate model columns mu rho. results Data frame tibble. full set segment likelihoods/results. top_likelihood_rows Data frame tibble. Top likelihood calls segment. likelihood_min Numeric. minimum likelihood value use penalty. seg Data frame tibble. Segment information. opt List options. Must include modelminAIsize modelminprobes.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/RefineTier1Models.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Refine Tier 1 Models and Their Segment Calls — RefineTier1Models","text":"list length equal nrow(tier1). element list : calls Refined segment calls model. model Summary statistics model (data.frame).","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/RefineTier1Models.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Refine Tier 1 Models and Their Segment Calls — RefineTier1Models","text":"(mu, rho) combination, extracts refines calls, computes distances integer copy number, ploidy, likelihoods, summarizes results.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/RunCallikelihood.html","id":null,"dir":"Reference","previous_headings":"","what":"Run Likelihood Calculation Across All Purity/Mu Combinations — RunCallikelihood","title":"Run Likelihood Calculation Across All Purity/Mu Combinations — RunCallikelihood","text":"combination purity mutation multiplicity purity_sf, computes segment likelihoods segments data.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/RunCallikelihood.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Run Likelihood Calculation Across All Purity/Mu Combinations — RunCallikelihood","text":"","code":"RunCallikelihood(purity_sf, data, sigma_C, opt)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/RunCallikelihood.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Run Likelihood Calculation Across All Purity/Mu Combinations — RunCallikelihood","text":"purity_sf Data frame tibble columns mu rho (mutation multiplicity tumor purity combinations). data Data frame tibble segment data (see Callikelihood required columns). sigma_C Numeric. Parameter segment likelihood (passed Callikelihood). opt List options. Must include lambda, gamma, epsilon.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/RunCallikelihood.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Run Likelihood Calculation Across All Purity/Mu Combinations — RunCallikelihood","text":"data frame likelihoods segment (mu, rho) combination.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/RunCallikelihood.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Run Likelihood Calculation Across All Purity/Mu Combinations — RunCallikelihood","text":"function iterates rows purity_sf, calling Callikelihood combination.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/SearchBreakpoint.html","id":null,"dir":"Reference","previous_headings":"","what":"Search for Breakpoints within a Segment Using MAF Data — SearchBreakpoint","title":"Search for Breakpoints within a Segment Using MAF Data — SearchBreakpoint","text":"Refines breakpoints within segment using MAF data. enough informative MAF sites present, segment may split finer regions based MAF clustering merging.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/SearchBreakpoint.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Search for Breakpoints within a Segment Using MAF Data — SearchBreakpoint","text":"","code":"SearchBreakpoint(seg_row, baf, mergeai, snpmin, minaisize, aibinsize)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/SearchBreakpoint.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Search for Breakpoints within a Segment Using MAF Data — SearchBreakpoint","text":"seg_row data frame row (list tibble row) representing single segment. Must columns: Sample, Chromosome, Start, End, Num_Probes, Segment_Mean, Segment_Mean_raw, Count, Baseline_cov, gatk_gender, pipeline_gender, size. baf data frame tibble containing MAF data. Must include columns: Chromosome, Start, End, baf. mergeai Numeric. Threshold difference MAF (gmm_mean) adjacent segments allow merging. snpmin Numeric. Minimum SNP count required segment considered separate segment. minaisize Numeric, smallest AI segment size (default: 1000000). aibinsize Numeric, AI bin size (default: 500000).","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/SearchBreakpoint.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Search for Breakpoints within a Segment Using MAF Data — SearchBreakpoint","text":"data frame refined segment(s), including updated breakpoints, MAF metrics, BreakpointSource column indicating whether breakpoints post-processed GATK.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/SegmentMeanToOriCov.html","id":null,"dir":"Reference","previous_headings":"","what":"Convert Segment Mean to Original Coverage — SegmentMeanToOriCov","title":"Convert Segment Mean to Original Coverage — SegmentMeanToOriCov","text":"Calculates original coverage segment based segment mean (log2 ratio), gender, chromosome, assumed diploid coverage.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/SegmentMeanToOriCov.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Convert Segment Mean to Original Coverage — SegmentMeanToOriCov","text":"","code":"SegmentMeanToOriCov(SM, gender, chromosome, diploid_cov)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/SegmentMeanToOriCov.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Convert Segment Mean to Original Coverage — SegmentMeanToOriCov","text":"SM Numeric. segment mean (log2 ratio) CNV analysis. gender Character. Sample gender, either \"male\" \"female\". chromosome Character factor. Chromosome name (e.g., \"1\", \"2\", ..., \"X\", \"Y\"). diploid_cov Numeric. expected coverage diploid region (e.g., 100).","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/SegmentMeanToOriCov.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Convert Segment Mean to Original Coverage — SegmentMeanToOriCov","text":"Numeric. estimated original coverage segment.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/SegmentMeanToOriCov.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Convert Segment Mean to Original Coverage — SegmentMeanToOriCov","text":"males sex chromosomes (\"X\" \"Y\"), diploid coverage halved. cases, segment mean scaled full diploid coverage.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/SegmentMeanToOriCov.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Convert Segment Mean to Original Coverage — SegmentMeanToOriCov","text":"","code":"SegmentMeanToOriCov(SM = 0, gender = \"male\", chromosome = \"X\", diploid_cov = 100) #> [1] 50 SegmentMeanToOriCov(SM = 0.5, gender = \"female\", chromosome = \"3\", diploid_cov = 100) #> [1] 141.4214"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/SelectCallpersegment.html","id":null,"dir":"Reference","previous_headings":"","what":"Select the Most Likely Call per Segment — SelectCallpersegment","title":"Select the Most Likely Call per Segment — SelectCallpersegment","text":"segment, selects allele combination (major/minor) highest BAF likelihood, special handling subclonal events cases minor allele zero.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/SelectCallpersegment.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Select the Most Likely Call per Segment — SelectCallpersegment","text":"","code":"SelectCallpersegment(results)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/SelectCallpersegment.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Select the Most Likely Call per Segment — SelectCallpersegment","text":"results data frame tibble containing possible calls segment, columns including: Segcov, BAF, mu, rho, index, major, minor, ccf, BAF_likelihood, Bio_diff, baf_ll, cov_diff, etc.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/SelectCallpersegment.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Select the Most Likely Call per Segment — SelectCallpersegment","text":"data frame tibble likely call per segment, including log_BAF_likelihood column.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/SelectCallpersegment.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Select the Most Likely Call per Segment — SelectCallpersegment","text":"Assigns minimum likelihood cases BAF_likelihood zero. possible subclonal events present, compares top two likelihoods may select second subclonal event. segments minor == 0, call refined using coverage difference.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/SelectFinalModel.html","id":null,"dir":"Reference","previous_headings":"","what":"Select the Final Copy Number Model and Write Results — SelectFinalModel","title":"Select the Final Copy Number Model and Write Results — SelectFinalModel","text":"Selects best model (mu, rho) based total log-likelihood distance integer copy number, refines segment calls, writes results output files.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/SelectFinalModel.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Select the Final Copy Number Model and Write Results — SelectFinalModel","text":"","code":"SelectFinalModel(   top_likelihood_rows,   groupinfo,   opt,   model_purity,   model_source )"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/SelectFinalModel.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Select the Final Copy Number Model and Write Results — SelectFinalModel","text":"top_likelihood_rows Data frame tibble. Top likelihood calls segment, including columns mu, rho, log_BAF_likelihood, major, minor, Tag, etc. groupinfo Data frame tibble. Information estimating minimum purity (see EstimateMinPurity). opt List options, must include modelminAIsize, minsf, out_dir, prefix. model_purity used directly function included compatibility. model_source Character string describing model source (e.g., \"Coverage\", \"Coverage + BAF\").","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/SelectFinalModel.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Select the Final Copy Number Model and Write Results — SelectFinalModel","text":"list : Final_model final selected model (see ClusterModels). models full model table (refinement).","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/SelectFinalModel.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Select the Final Copy Number Model and Write Results — SelectFinalModel","text":"Refines calls models several selection clustering steps. Writes model table final calls output files.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/SelectModelByDis.html","id":null,"dir":"Reference","previous_headings":"","what":"Select Model by Distance to Integer Copy Number — SelectModelByDis","title":"Select Model by Distance to Integer Copy Number — SelectModelByDis","text":"candidate model tier1, evaluates mean distance integer copy number diploid non-diploid segments, returns summary table sorted total distance.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/SelectModelByDis.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Select Model by Distance to Integer Copy Number — SelectModelByDis","text":"","code":"SelectModelByDis(tier1, df, seg, opt)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/SelectModelByDis.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Select Model by Distance to Integer Copy Number — SelectModelByDis","text":"tier1 Data frame tibble. row candidate model columns mu, rho, total_log_likelihood, segments_n. df Data frame tibble. segment call likelihoods (see ExtractCall). seg Data frame tibble. Segment information. opt List options passed RefineCalls.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/SelectModelByDis.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Select Model by Distance to Integer Copy Number — SelectModelByDis","text":"data frame one row per model, including columns: mu Mutation multiplicity. rho Tumor purity. total_log_likelihood Total log-likelihood model. segments_n Number segments. diploid_n Number diploid segments. diploid_distance_to_integer Mean distance integer CN diploid segments. nondiploid_n Number non-diploid segments. nondiploid_distance_to_integer Mean distance integer CN non-diploid segments. total_distance_to_integer Sum diploid non-diploid mean distances.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/SummarizeMapQC.html","id":null,"dir":"Reference","previous_headings":"","what":"Summarise QC Tables for a Sample — SummarizeMapQC","title":"Summarise QC Tables for a Sample — SummarizeMapQC","text":"Reads summarizes mapping coverage QC metrics sample, writes summary table.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/SummarizeMapQC.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summarise QC Tables for a Sample — SummarizeMapQC","text":"","code":"SummarizeMapQC(input_dir, prefix, output_dir)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/SummarizeMapQC.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Summarise QC Tables for a Sample — SummarizeMapQC","text":"input_dir Path directory containing QC files. prefix Sample ID file prefix. output_dir Output directory.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/SummarizeMapQC.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Summarise QC Tables for a Sample — SummarizeMapQC","text":"Invisibly returns QC summary data frame.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/ai_bin_smooth.html","id":null,"dir":"Reference","previous_headings":"","what":"Smooth AI Bin Values by Downsampling to Mode Proportions — ai_bin_smooth","title":"Smooth AI Bin Values by Downsampling to Mode Proportions — ai_bin_smooth","text":"length input vector greater 30, returns vector 30 values sampled according observed frequency unique value (mode smoothing). Otherwise, returns vector unchanged.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/ai_bin_smooth.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Smooth AI Bin Values by Downsampling to Mode Proportions — ai_bin_smooth","text":"","code":"ai_bin_smooth(x)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/ai_bin_smooth.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Smooth AI Bin Values by Downsampling to Mode Proportions — ai_bin_smooth","text":"x Numeric character vector. Typically vector rounded AI (e.g., BAF) values.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/ai_bin_smooth.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Smooth AI Bin Values by Downsampling to Mode Proportions — ai_bin_smooth","text":"numeric vector, either unchanged (length <= 30) length <= 30, values sampled according observed frequencies.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/ai_bin_smooth.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Smooth AI Bin Values by Downsampling to Mode Proportions — ai_bin_smooth","text":"","code":"set.seed(1) x <- sample(c(0.1, 0.2, 0.3, 0.4), 100, replace = TRUE) ai_bin_smooth(x) #>  [1] 0.2 0.2 0.2 0.2 0.2 0.2 0.2 0.2 0.2 0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.3 0.3 #> [20] 0.3 0.3 0.3 0.3 0.3 0.4 0.4 0.4 0.4 0.4 0.4"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/band_plottable_female.html","id":null,"dir":"Reference","previous_headings":"","what":"Non blacklist region for each cytobands binned by 300nt for female. — band_plottable_female","title":"Non blacklist region for each cytobands binned by 300nt for female. — band_plottable_female","text":"File used plot CNV profile keep non-blacklist region.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/band_plottable_female.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Non blacklist region for each cytobands binned by 300nt for female. — band_plottable_female","text":"","code":"band_plottable_female"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/band_plottable_female.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Non blacklist region for each cytobands binned by 300nt for female. — band_plottable_female","text":"data frame columns: cytoband cytoband name (character). coordinates coordinates binned 300nt (integer).","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/band_plottable_female.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Non blacklist region for each cytobands binned by 300nt for female. — band_plottable_female","text":"DRAGEN","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/band_plottable_male.html","id":null,"dir":"Reference","previous_headings":"","what":"Non blacklist region for each cytobands binned by 300nt for male. — band_plottable_male","title":"Non blacklist region for each cytobands binned by 300nt for male. — band_plottable_male","text":"File used plot CNV profile keep non-blacklist region.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/band_plottable_male.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Non blacklist region for each cytobands binned by 300nt for male. — band_plottable_male","text":"","code":"band_plottable_male"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/band_plottable_male.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Non blacklist region for each cytobands binned by 300nt for male. — band_plottable_male","text":"data frame columns: cytoband cytoband name (character). coordinates coordinates binned 300nt (integer).","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/band_plottable_male.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Non blacklist region for each cytobands binned by 300nt for male. — band_plottable_male","text":"DRAGEN","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/binbaf.html","id":null,"dir":"Reference","previous_headings":"","what":"Bin MAF Data and Estimate MAF Metrics per Bin — binbaf","title":"Bin MAF Data and Estimate MAF Metrics per Bin — binbaf","text":"Bins input MAF data fixed-size windows calculates summary metrics (e.g., estimated MAF, nonzero counts) bin.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/binbaf.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Bin MAF Data and Estimate MAF Metrics per Bin — binbaf","text":"","code":"binbaf(data, bin_size)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/binbaf.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Bin MAF Data and Estimate MAF Metrics per Bin — binbaf","text":"data data frame tibble containing least Chromosome, End, baf columns. bin_size Numeric. bin size use (e.g., 1e6 1Mb bins).","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/binbaf.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Bin MAF Data and Estimate MAF Metrics per Bin — binbaf","text":"tibble one row per bin columns: Chromosome Chromosome identifier. bin Bin start coordinate. Start Minimum End value bin. End Maximum End value bin. Estimated_baf List column GMM-based BAF estimation results. nonzero_count Number nonzero BAF values bin. each_baf Semicolon-separated string nonzero BAF values bin. gmm_mean, gmm_weight, gmm_G Unnested BAF GMM metrics.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/blacklist_table.html","id":null,"dir":"Reference","previous_headings":"","what":"Non mapable regions of the genome — blacklist_table","title":"Non mapable regions of the genome — blacklist_table","text":"table listing genomic intervals known problematic mapping.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/blacklist_table.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Non mapable regions of the genome — blacklist_table","text":"","code":"blacklist_table"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/blacklist_table.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Non mapable regions of the genome — blacklist_table","text":"data frame columns: chrom Chromosome name (character). start Start coordinate (integer). end End coordinate (integer). tag ignored (character).","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/blacklist_table.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Non mapable regions of the genome — blacklist_table","text":"DRAGEN4.2 CNV output *.cnv.excluded_intervals.bed.gz file","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/calculate_gaps.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate Gaps Between Segment and Cytoband-Defined Chromosome Landmarks — calculate_gaps","title":"Calculate Gaps Between Segment and Cytoband-Defined Chromosome Landmarks — calculate_gaps","text":"Calculates distances (gaps) segment's start end positions defined start end sites p q arms chromosome. acrocentric chromosomes, q arm start end sites considered.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/calculate_gaps.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate Gaps Between Segment and Cytoband-Defined Chromosome Landmarks — calculate_gaps","text":"","code":"calculate_gaps(   Chrom,   Start,   End,   p_chromStart,   p_chromEnd,   q_chromStart,   q_chromEnd )"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/calculate_gaps.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate Gaps Between Segment and Cytoband-Defined Chromosome Landmarks — calculate_gaps","text":"Chrom Character. Chromosome name (e.g., \"1\", \"X\"). Start Numeric. Segment start position (base pair). End Numeric. Segment end position (base pair). p_chromStart Numeric. Start position p arm detectable region. p_chromEnd Numeric. End position p arm detectable region. q_chromStart Numeric. Start position q arm detectable region. q_chromEnd Numeric. End position q arm detectable region.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/calculate_gaps.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate Gaps Between Segment and Cytoband-Defined Chromosome Landmarks — calculate_gaps","text":"named list elements: p_gap_to_tel Gap segment start p arm telomere (NA). p_gap_to_cen Gap segment end p arm centromere (NA). q_gap_to_tel Gap segment end q arm telomere (NA). q_gap_to_cen Gap segment start q arm centromere (NA).","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/calculate_gaps.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Calculate Gaps Between Segment and Cytoband-Defined Chromosome Landmarks — calculate_gaps","text":"acrocentric chromosomes, p arm calculations omitted q arm start/end sites considered.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/calculate_gaps.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Calculate Gaps Between Segment and Cytoband-Defined Chromosome Landmarks — calculate_gaps","text":"","code":"# calculate_gaps(\"1\", 10000, 50000, 0, 25000, 25001, 100000)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/categorize_K.html","id":null,"dir":"Reference","previous_headings":"","what":"Categorize Beta Distribution K Values — categorize_K","title":"Categorize Beta Distribution K Values — categorize_K","text":"Categorizes numeric K value (e.g., beta distribution) bins based sample quantiles.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/categorize_K.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Categorize Beta Distribution K Values — categorize_K","text":"","code":"categorize_K(K)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/categorize_K.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Categorize Beta Distribution K Values — categorize_K","text":"K Numeric vector. K values categorize.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/categorize_K.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Categorize Beta Distribution K Values — categorize_K","text":"Integer vector categories, possible values 50, 100, 200, 300, corresponding increasing quantile bins.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/categorize_K.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Categorize Beta Distribution K Values — categorize_K","text":"function computes quantiles K (using default quartiles), assigns value category: 50: lowest quantile 100: 2nd quantile 200: 3rd quantile 300: highest quantile","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/categorize_K.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Categorize Beta Distribution K Values — categorize_K","text":"","code":"set.seed(1) K <- rbeta(100, 2, 5) categorize_K(K) #>   [1]  50 200  50 200  50 200 300 100 300 200  50  50 300 100 100 300 300 300 #>  [19] 300 300 200  50 300 100 100  50 100 200 300 100 200 100  50 100 100 100 #>  [37] 300 100 100 300 200  50  50 200 300 100 300 200 200  50 100  50 300 100 #>  [55] 100 300 200  50 200  50 200 200  50 300  50  50 200 100 200 200  50 100 #>  [73] 100 300  50 300 200 300 100 200 200 100 300 300 300 200  50 100  50 100 #>  [91]  50 200  50 200  50 300 300 200  50 100"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/clean_homalt.html","id":null,"dir":"Reference","previous_headings":"","what":"Clean Homozygous AI Bins Based on LOH Segments — clean_homalt","title":"Clean Homozygous AI Bins Based on LOH Segments — clean_homalt","text":"Removes homozygous allelic imbalance (AI) bins overlap LOH (loss heterozygosity) segments.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/clean_homalt.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Clean Homozygous AI Bins Based on LOH Segments — clean_homalt","text":"","code":"clean_homalt(rounded_ai, call_seg)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/clean_homalt.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Clean Homozygous AI Bins Based on LOH Segments — clean_homalt","text":"rounded_ai Data frame tibble. AI data, must include columns contig, start, stop, allele1Count, allele2Count. call_seg Data frame tibble. Segment calls, must include columns chrom, loc.start, loc.end, MAF.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/clean_homalt.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Clean Homozygous AI Bins Based on LOH Segments — clean_homalt","text":"data frame AI bins, homozygous bins outside LOH regions removed.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/clean_homalt.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Clean Homozygous AI Bins Based on LOH Segments — clean_homalt","text":"","code":"# clean_homalt(rounded_ai, call_seg)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/correct_purity.html","id":null,"dir":"Reference","previous_headings":"","what":"Correct Copy Ratio and Calculate CNF for Purity and Scale Factor — correct_purity","title":"Correct Copy Ratio and Calculate CNF for Purity and Scale Factor — correct_purity","text":"Adjusts log2 copy ratio computes copy number fraction (CNF) region, given sample purity scale factor.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/correct_purity.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Correct Copy Ratio and Calculate CNF for Purity and Scale Factor — correct_purity","text":"","code":"correct_purity(cov, gender, purity, sf)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/correct_purity.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Correct Copy Ratio and Calculate CNF for Purity and Scale Factor — correct_purity","text":"cov Data frame tibble. Coverage data, must include columns CONTIG LOG2_COPY_RATIO. gender Character. Sample gender (\"male\" \"female\"). purity Numeric. Tumor purity (fraction 0 1). sf Numeric. Scale factor diploid coverage.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/correct_purity.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Correct Copy Ratio and Calculate CNF for Purity and Scale Factor — correct_purity","text":"coverage data frame tibble additional columns Segcov, updated LOG2_COPY_RATIO, CNF.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/correct_purity.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Correct Copy Ratio and Calculate CNF for Purity and Scale Factor — correct_purity","text":"Adjusts log2 copy ratio using scale factor. Calculates CNF differently sex chromosomes males.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/correct_purity.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Correct Copy Ratio and Calculate CNF for Purity and Scale Factor — correct_purity","text":"","code":"# correct_purity(cov, gender = \"female\", purity = 0.7, sf = 1)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/cov_bin.html","id":null,"dir":"Reference","previous_headings":"","what":"Bin and Smooth Copy Number Data from Coverage File — cov_bin","title":"Bin and Smooth Copy Number Data from Coverage File — cov_bin","text":"Splits coverage data chromosome, bins 300bp windows, computes smoothed copy number values using larger window size.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/cov_bin.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Bin and Smooth Copy Number Data from Coverage File — cov_bin","text":"","code":"cov_bin(cov, cov_binsize)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/cov_bin.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Bin and Smooth Copy Number Data from Coverage File — cov_bin","text":"cov Data frame tibble. Must include columns CONTIG, START, END, CNF. cov_binsize Numeric. Bin size (bases) smoothing (e.g., 10000 10kb).","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/cov_bin.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Bin and Smooth Copy Number Data from Coverage File — cov_bin","text":"data frame columns: CONTIG, bin_start, bin_norm_id, smoothed CNF values.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/cov_bin.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Bin and Smooth Copy Number Data from Coverage File — cov_bin","text":"Bins generated every 300bp within region. Smoothed copy number computed median CNF within larger (cov_binsize) window.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/cov_bin.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Bin and Smooth Copy Number Data from Coverage File — cov_bin","text":"","code":"# cov_bin(cov, cov_binsize = 10000)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/cytoband_table.html","id":null,"dir":"Reference","previous_headings":"","what":"Cytoband reference table — cytoband_table","title":"Cytoband reference table — cytoband_table","text":"dataset contains cytoband annotations human genome.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/cytoband_table.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Cytoband reference table — cytoband_table","text":"","code":"cytoband_table"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/cytoband_table.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Cytoband reference table — cytoband_table","text":"data frame columns: chrom Chromosome name (character). start Start coordinate (integer). end End coordinate (integer). band Cytoband name (character). gieStain Giemsa stain (character).","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/cytoband_table.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Cytoband reference table — cytoband_table","text":"UCSC Table Browser","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/edge_table.html","id":null,"dir":"Reference","previous_headings":"","what":"Detectable Edge table for cytoband annotation follows the 5MB rule. — edge_table","title":"Detectable Edge table for cytoband annotation follows the 5MB rule. — edge_table","text":"Detectable Edge table cytoband annotation follows 5MB rule.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/edge_table.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Detectable Edge table for cytoband annotation follows the 5MB rule. — edge_table","text":"","code":"edge_table"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/edge_table.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Detectable Edge table for cytoband annotation follows the 5MB rule. — edge_table","text":"data frame columns: Chrom Chromosome name (character). p_chromStart P arm chromosome Start coordinates (integer). p_chromEnd P arm chromosome End coordinates (integer). p_first_name P arm first cytoband name (character). p_last_name P arm last cytoband name (character). q_chromStart Q arm chromosome Start coordinates (integer). q_chromEnd Q arm chromosome End coordinates (integer). q_first_name Q arm first cytoband name (character). q_last_name Q arm last cytoband name (character).","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/edge_table.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Detectable Edge table for cytoband annotation follows the 5MB rule. — edge_table","text":"Internal analysis","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/findcytoband.html","id":null,"dir":"Reference","previous_headings":"","what":"Find Cytoband Name for Genomic Position — findcytoband","title":"Find Cytoband Name for Genomic Position — findcytoband","text":"Returns cytoband name given chromosome position searching cytoband annotation data frame.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/findcytoband.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Find Cytoband Name for Genomic Position — findcytoband","text":"","code":"findcytoband(cytoband, chrom, pos)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/findcytoband.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Find Cytoband Name for Genomic Position — findcytoband","text":"cytoband Data frame. Cytoband annotation columns chrom, chromStart, chromEnd, name. chrom Character. Chromosome name (e.g., \"1\", \"X\"). pos Numeric character. Genomic position (base pair).","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/findcytoband.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Find Cytoband Name for Genomic Position — findcytoband","text":"Character. cytoband name(s) containing position.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/findcytoband.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Find Cytoband Name for Genomic Position — findcytoband","text":"","code":"# cytoband <- data.frame(chrom = \"1\", chromStart = 1, chromEnd = 1000000, name = \"p36.33\") # findcytoband(cytoband, chrom = \"1\", pos = 500000)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/gene_annotation.html","id":null,"dir":"Reference","previous_headings":"","what":"RefSeq gene annotations — gene_annotation","title":"RefSeq gene annotations — gene_annotation","text":"RefSeq annotations including gene names start end.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/gene_annotation.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"RefSeq gene annotations — gene_annotation","text":"","code":"gene_annotation"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/gene_annotation.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"RefSeq gene annotations — gene_annotation","text":"data frame columns: chrom Chromosome name (character). start Start coordinate (integer). end End coordinate (integer). genesymbl Gene name (character).","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/gene_annotation.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"RefSeq gene annotations — gene_annotation","text":"RefSeq","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/generate_ISCN.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate Cytoband-Based Annotation String for a CNV Segment — generate_ISCN","title":"Generate Cytoband-Based Annotation String for a CNV Segment — generate_ISCN","text":"Returns cytoband-based annotation string CNV segment, based segment's position proximity p q arm detectable region boundaries.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/generate_ISCN.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate Cytoband-Based Annotation String for a CNV Segment — generate_ISCN","text":"","code":"generate_ISCN(   chrom,   Start,   End,   CNF,   CN,   p_chromStart,   p_chromEnd,   p_first_name,   p_last_name,   q_chromStart,   q_chromEnd,   q_first_name,   q_last_name,   p_gap_to_tel,   p_gap_to_cen,   q_gap_to_tel,   q_gap_to_cen,   cytoband )"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/generate_ISCN.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate Cytoband-Based Annotation String for a CNV Segment — generate_ISCN","text":"chrom Character. Chromosome name. Start, End Numeric. Segment start end positions (base pairs). CNF Numeric. Fractional copy number. CN Integer. Integer copy number. p_chromStart, p_chromEnd Numeric. p-arm detectable region start end positions. p_first_name, p_last_name Character. Cytoband names p-arm start end. q_chromStart, q_chromEnd Numeric. q-arm detectable region start end positions. q_first_name, q_last_name Character. Cytoband names q-arm start end. p_gap_to_tel, p_gap_to_cen, q_gap_to_tel, q_gap_to_cen Numeric. Gaps segment detectable region boundaries (calculate_gaps). cytoband Data frame. Cytoband annotation table.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/generate_ISCN.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate Cytoband-Based Annotation String for a CNV Segment — generate_ISCN","text":"Character. cytoband-based annotation string segment.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/generate_ISCN.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Generate Cytoband-Based Annotation String for a CNV Segment — generate_ISCN","text":"function determines annotation follows: segment start end cytoband, returns single-band range. segment spans multiple cytobands, returns range start end cytoband. segment close p-arm telomere centromere (p-arm boundaries), returns p-arm event . segment close q-arm centromere telomere (q-arm boundaries), returns q-arm event (chromosome-level event acrocentric chromosomes). segment close p-arm q-arm telomeres (covers whole chromosome), returns chromosome-level event. gap size smaller 5MB defined \"close\". acrocentric chromosomes, q-arm boundaries considered. annotation string determined size gaps segment p/q arm detectable region boundaries cytoband names segment start end. Events reported cytoband range, p-arm , q-arm , chromosome-level event.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/generate_ISCN.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Generate Cytoband-Based Annotation String for a CNV Segment — generate_ISCN","text":"","code":"# generate_ISCN(\"1\", 10000, 50000, 2.1, 2, 0, 25000, \"p36.33\", \"p11.2\", #               25001, 100000, \"q11.1\", \"q44\", 1000, 1000, 1000, 1000, cytoband)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/keep_whitelist_ai.html","id":null,"dir":"Reference","previous_headings":"","what":"Keep Only AI Bins in Whitelisted Regions — keep_whitelist_ai","title":"Keep Only AI Bins in Whitelisted Regions — keep_whitelist_ai","text":"Filters AI (allelic imbalance) bins include overlapping whitelisted regions.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/keep_whitelist_ai.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Keep Only AI Bins in Whitelisted Regions — keep_whitelist_ai","text":"","code":"keep_whitelist_ai(rounded_ai, whitelist)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/keep_whitelist_ai.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Keep Only AI Bins in Whitelisted Regions — keep_whitelist_ai","text":"rounded_ai Data frame tibble. Rounded AI data, must include columns contig, start, stop. whitelist Data frame tibble. Whitelist regions, must include columns seqnames, start, end.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/keep_whitelist_ai.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Keep Only AI Bins in Whitelisted Regions — keep_whitelist_ai","text":"data frame AI bins overlap whitelisted regions.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/keep_whitelist_ai.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Keep Only AI Bins in Whitelisted Regions — keep_whitelist_ai","text":"","code":"# keep_whitelist_ai(rounded_ai, whitelist)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/keep_whitelist_cov.html","id":null,"dir":"Reference","previous_headings":"","what":"Keep Only Coverage Bins in Whitelisted Regions — keep_whitelist_cov","title":"Keep Only Coverage Bins in Whitelisted Regions — keep_whitelist_cov","text":"Filters smoothed coverage bins include overlapping whitelisted regions.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/keep_whitelist_cov.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Keep Only Coverage Bins in Whitelisted Regions — keep_whitelist_cov","text":"","code":"keep_whitelist_cov(smooth_cov, whitelist)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/keep_whitelist_cov.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Keep Only Coverage Bins in Whitelisted Regions — keep_whitelist_cov","text":"smooth_cov Data frame tibble. Smoothed coverage data, must include columns CONTIG, bin_start, bin_end. whitelist Data frame tibble. Whitelist regions, must include columns seqnames, start, end.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/keep_whitelist_cov.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Keep Only Coverage Bins in Whitelisted Regions — keep_whitelist_cov","text":"data frame smoothed coverage bins overlap whitelisted regions.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/keep_whitelist_cov.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Keep Only Coverage Bins in Whitelisted Regions — keep_whitelist_cov","text":"","code":"# keep_whitelist_cov(smooth_cov, whitelist)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/plot_cov.html","id":null,"dir":"Reference","previous_headings":"","what":"Multi-panel Plot of Copy Number, BAF, Clonality, and Quality Across Chromosomes — plot_cov","title":"Multi-panel Plot of Copy Number, BAF, Clonality, and Quality Across Chromosomes — plot_cov","text":"Produces summary plot four panels: copy number, BAF, clonality, segment quality, faceted chromosome.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/plot_cov.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Multi-panel Plot of Copy Number, BAF, Clonality, and Quality Across Chromosomes — plot_cov","text":"","code":"plot_cov(df_cov, df_ai, call_seg, whitelist, gender, prefix, purity)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/plot_cov.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Multi-panel Plot of Copy Number, BAF, Clonality, and Quality Across Chromosomes — plot_cov","text":"df_cov Data frame tibble. Smoothed coverage data, must include columns seqnames, start, end, smoothed_bin_cnf. df_ai Data frame tibble. Smoothed AI data, must include columns seqnames, bin_start, smoothed_ai. call_seg Data frame tibble. Segment calls, must include columns seqnames, loc.start, loc.end, CN, MAF, ccf_final, FILTER. whitelist Data frame tibble. Whitelist regions, must include columns seqnames, start, end. gender Character. Sample gender (\"male\" \"female\"). prefix Character. Plot title output prefix. purity Numeric. Tumor purity (directly used plot, included compatibility).","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/plot_cov.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Multi-panel Plot of Copy Number, BAF, Clonality, and Quality Across Chromosomes — plot_cov","text":"grob object (gridExtra::grid.arrange) representing combined plot.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/plot_cov.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Multi-panel Plot of Copy Number, BAF, Clonality, and Quality Across Chromosomes — plot_cov","text":"","code":"# plot_cov(df_cov, df_ai, call_seg, whitelist, gender = \"female\", prefix = \"Sample1\", purity = 0.7)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/read_whitelist.html","id":null,"dir":"Reference","previous_headings":"","what":"Read and Process DRAGEN Whitelist Regions — read_whitelist","title":"Read and Process DRAGEN Whitelist Regions — read_whitelist","text":"Reads DRAGEN whitelist file returns detected regions GRanges-like segments copy number analysis.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/read_whitelist.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Read and Process DRAGEN Whitelist Regions — read_whitelist","text":"","code":"read_whitelist(whitelist_file, gender)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/read_whitelist.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Read and Process DRAGEN Whitelist Regions — read_whitelist","text":"whitelist_file Path whitelist file (CSV, header). gender Character. Sample gender (\"male\" \"female\").","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/read_whitelist.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Read and Process DRAGEN Whitelist Regions — read_whitelist","text":"data frame columns: seqnames, start, end, width, strand.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/read_whitelist.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Read and Process DRAGEN Whitelist Regions — read_whitelist","text":"\"male\", expects chromosome Y present; \"female\", expects chromosome Y absent. Splits regions cytoband, detects gaps, outputs non-gap regions.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/read_whitelist.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Read and Process DRAGEN Whitelist Regions — read_whitelist","text":"","code":"# read_whitelist(\"whitelist.csv\", gender = \"male\")"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/rerunCalling.html","id":null,"dir":"Reference","previous_headings":"","what":"Rerun CNV Calling with User-Defined Purity and Size Factor — rerunCalling","title":"Rerun CNV Calling with User-Defined Purity and Size Factor — rerunCalling","text":"Allows user rerun copy number variant (CNV) calling using user-defined purity scale factor (size factor) parameters, specifying diploid region.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/rerunCalling.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Rerun CNV Calling with User-Defined Purity and Size Factor — rerunCalling","text":"","code":"rerunCalling(   seg,   input,   models,   call,   gender,   dicovsf = NULL,   purity = NULL,   chromosome = NULL,   start = NULL,   end = NULL,   mode = \"model\",   out_file )"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/rerunCalling.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Rerun CNV Calling with User-Defined Purity and Size Factor — rerunCalling","text":"seg Path segment file (e.g., *_final_call.tsv). input Path top likelihood row file. models Path model file. call Path final call file. gender Character. Sample gender (\"male\" \"female\"). dicovsf Character numeric. Desired scale factor, range (e.g., \"0.9:1.1\"). purity Character numeric. Desired purity, range (e.g., \"0.5:0.7\"). chromosome Character. Chromosome number diploid region (optional). start Integer. Start position diploid region (optional). end Integer. End position diploid region (optional). mode Character. Either \"model\" \"region\". out_file Output file path final calls.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/rerunCalling.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Rerun CNV Calling with User-Defined Purity and Size Factor — rerunCalling","text":"Invisibly returns final call data frame.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/rerunCalling.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Rerun CNV Calling with User-Defined Purity and Size Factor — rerunCalling","text":"function allows re-calling CNV segments user-specified purity /size factor (SF, scale factor) defining diploid region. supports \"model\" \"region\" rerun modes. result written out_file.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/rerunCalling.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Rerun CNV Calling with User-Defined Purity and Size Factor — rerunCalling","text":"","code":"# rerun_cnv_calling( #   seg = \"sample_final_call.tsv\", #   input = \"sample_top_likelihood_calls.tsv\", #   models = \"sample_Models_likelihood.tsv\", #   call = \"sample_final_calls.tsv\", #   gender = \"male\", #   purity = \"0.5:0.7\", #   dicovsf = \"0.9:1.1\", #   mode = \"model\", #   out_file = \"sample_final_calls_rerun.tsv\" # )"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/round_ai.html","id":null,"dir":"Reference","previous_headings":"","what":"Round BAF Values into 20 Bins — round_ai","title":"Round BAF Values into 20 Bins — round_ai","text":"chromosome, rounds B-allele frequency (BAF, af) values 20 bins (increments 0.05).","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/round_ai.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Round BAF Values into 20 Bins — round_ai","text":"","code":"round_ai(ai)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/round_ai.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Round BAF Values into 20 Bins — round_ai","text":"ai list data frames tibbles, one per chromosome. must include columns af, contig, start, stop, allele1Count, allele2Count.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/round_ai.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Round BAF Values into 20 Bins — round_ai","text":"data frame columns: contig, start, stop, allele1Count, allele2Count, norm_af.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/round_ai.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Round BAF Values into 20 Bins — round_ai","text":"BAF values (af) rounded nearest 0.05. Output single data frame combining chromosomes.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/round_ai.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Round BAF Values into 20 Bins — round_ai","text":"","code":"# ai_list <- list(chr1 = data.frame(af = runif(10), contig = \"1\", start = 1:10, stop = 11:20, allele1Count = 1:10, allele2Count = 11:20)) # round_ai(ai_list)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/roundcn.html","id":null,"dir":"Reference","previous_headings":"","what":"Round Copy Number to Integer Based on Call and Gender — roundcn","title":"Round Copy Number to Integer Based on Call and Gender — roundcn","text":"Round Copy Number Integer Based Call Gender","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/roundcn.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Round Copy Number to Integer Based on Call and Gender — roundcn","text":"","code":"roundcn(gender, Chrom, Call, CNF)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/roundcn.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Round Copy Number to Integer Based on Call and Gender — roundcn","text":"gender Character. \"male\" \"female\". Chrom Character. Chromosome name. Call Character. CNV call. CNF Numeric. Corrected CNF.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/roundcn.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Round Copy Number to Integer Based on Call and Gender — roundcn","text":"Integer. Rounded copy number.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/runAIsegmentation.html","id":null,"dir":"Reference","previous_headings":"","what":"Run AI Segmentation Workflow — runAIsegmentation","title":"Run AI Segmentation Workflow — runAIsegmentation","text":"function executes full AI segmentation workflow, including reading input files, merging segments, BAF processing, writing results.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/runAIsegmentation.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Run AI Segmentation Workflow — runAIsegmentation","text":"","code":"runAIsegmentation(   seg,   cov,   ai,   gender,   out_dir,   prefix,   aibinsize = 5e+05,   mergeai = 0.2,   mergecov = 0.2,   minaisize = 1e+06,   snpmin = 7,   minsnpcallaicutoff = 10,   mergecovminsize = 5e+05 )"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/runAIsegmentation.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Run AI Segmentation Workflow — runAIsegmentation","text":"seg Path GATK segment file. cov Path GATK coverage count file. ai Path DRAGEN BAF bedgraph file. gender Character, \"male\" \"female\". out_dir Output directory path. prefix Output file prefix. aibinsize Numeric, AI bin size (default: 500000). mergeai Numeric, BAF difference threshold merging segments (default: 0.2). mergecov Numeric, CNV difference threshold merging segments (default: 0.2). minaisize Numeric, smallest AI segment size (default: 1000000). snpmin Numeric, minimum SNPs BAF segmentation (default: 7). minsnpcallaicutoff Numeric, minimum SNPs reliable CNLOH/GAINLOH (default: 10). mergecovminsize Numeric, minimum size GATK segment merge (default: 500000).","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/runAIsegmentation.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Run AI Segmentation Workflow — runAIsegmentation","text":"Invisibly returns output file path.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/runModelLikelihood.html","id":null,"dir":"Reference","previous_headings":"","what":"Run Model Likelihood and Copy Number Calling Workflow — runModelLikelihood","title":"Run Model Likelihood and Copy Number Calling Workflow — runModelLikelihood","text":"function runs complete workflow likelihood calculation model selection.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/runModelLikelihood.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Run Model Likelihood and Copy Number Calling Workflow — runModelLikelihood","text":"","code":"runModelLikelihood(   seg,   out_dir,   prefix,   gender,   lambda = 1,   gamma = 1,   epsilon = 0.01,   modelminprobes = 20,   modelminAIsize = 5e+06,   minsf = 0.4,   callcov = 0.3,   thread = 4,   diploidweight = 0.5,   ... )"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/runModelLikelihood.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Run Model Likelihood and Copy Number Calling Workflow — runModelLikelihood","text":"seg Path combined segment file. out_dir Output directory. prefix Output file prefix. gender Sample gender (\"male\" \"female\"). lambda, gamma, epsilon, modelminprobes, modelminAIsize, minsf, callcov, thread, diploidweight, ratio Numeric parameters workflow (see script details). ... Additional arguments (reserved future use).","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/runModelLikelihood.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Run Model Likelihood and Copy Number Calling Workflow — runModelLikelihood","text":"Invisibly returns output file paths.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/runPlotCNV.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot CNV Profile (Copy Number, BAF, Clonality, Quality) — runPlotCNV","title":"Plot CNV Profile (Copy Number, BAF, Clonality, Quality) — runPlotCNV","text":"Plots CNV profile using coverage, B-allele, segment, whitelist data.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/runPlotCNV.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot CNV Profile (Copy Number, BAF, Clonality, Quality) — runPlotCNV","text":"","code":"runPlotCNV(   seg,   coverage,   ballele,   ai_binsize = 1e+05,   cov_binsize = 1e+05,   whitelist,   gender = \"female\",   out_dir,   prefix )"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/runPlotCNV.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot CNV Profile (Copy Number, BAF, Clonality, Quality) — runPlotCNV","text":"seg Path GATK-processed segment file. coverage Path coverage file. ballele Path DRAGEN B-allele file. ai_binsize Numeric. Bin size AI plot (default 100000). cov_binsize Numeric. Bin size coverage plot (default 100000). whitelist Path whitelist file. gender Character. \"male\" \"female\". out_dir Output directory. prefix Sample ID output prefix.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/runPlotCNV.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot CNV Profile (Copy Number, BAF, Clonality, Quality) — runPlotCNV","text":"Invisibly returns ggplot object.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/smooth_ai.html","id":null,"dir":"Reference","previous_headings":"","what":"Smooth AI Bins by Window Size and Downsampling — smooth_ai","title":"Smooth AI Bins by Window Size and Downsampling — smooth_ai","text":"Smooths allelic imbalance (AI) bins specified window size, keeping 30 data points per bin using frequency-based downsampling.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/smooth_ai.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Smooth AI Bins by Window Size and Downsampling — smooth_ai","text":"","code":"smooth_ai(df, ai_binsize, gender)"},{"path":"https://sj-cmpb-se.github.io/XploR/reference/smooth_ai.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Smooth AI Bins by Window Size and Downsampling — smooth_ai","text":"df Data frame tibble. Must include columns seqnames, start, norm_af. ai_binsize Numeric. Bin size (bases) smoothing. gender Character. Sample gender (\"male\" \"female\"). (Currently used function, included compatibility.)","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/smooth_ai.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Smooth AI Bins by Window Size and Downsampling — smooth_ai","text":"data frame columns: seqnames, bin_start, bin_end, smoothed AI values.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/smooth_ai.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Smooth AI Bins by Window Size and Downsampling — smooth_ai","text":"Splits data chromosome. bin, keeps 30 values using ai_bin_smooth.","code":""},{"path":"https://sj-cmpb-se.github.io/XploR/reference/smooth_ai.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Smooth AI Bins by Window Size and Downsampling — smooth_ai","text":"","code":"# smooth_ai(df, ai_binsize = 10000, gender = \"female\")"}]
