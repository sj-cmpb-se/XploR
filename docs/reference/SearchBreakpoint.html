<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Refine Breakpoints Within a Segment Using MAF Data — SearchBreakpoint • XploR</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Refine Breakpoints Within a Segment Using MAF Data — SearchBreakpoint"><meta name="description" content="Refines breakpoints within a segment using minor allele frequency (MAF) data. If enough informative MAF sites are present, the segment is binned and can be split into finer regions using either stepwise merging or CBS (circular binary segmentation). Optionally, PON-based bias correction is applied to the resulting segments."><meta property="og:description" content="Refines breakpoints within a segment using minor allele frequency (MAF) data. If enough informative MAF sites are present, the segment is binned and can be split into finer regions using either stepwise merging or CBS (circular binary segmentation). Optionally, PON-based bias correction is applied to the resulting segments."><meta property="og:image" content="https://sj-cmpb-se.github.io/XploR/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">XploR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/sj-cmpb-se/XploR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Refine Breakpoints Within a Segment Using MAF Data</h1>
      <small class="dont-index">Source: <a href="https://github.com/sj-cmpb-se/XploR/blob/HEAD/R/AIsegmentation.R" class="external-link"><code>R/AIsegmentation.R</code></a></small>
      <div class="d-none name"><code>SearchBreakpoint.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Refines breakpoints within a segment using minor allele frequency (MAF) data. If enough informative MAF sites are present, the segment is binned and can be split into finer regions using either stepwise merging or CBS (circular binary segmentation). Optionally, PON-based bias correction is applied to the resulting segments.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">SearchBreakpoint</span><span class="op">(</span></span>
<span>  <span class="va">seg_row</span>,</span>
<span>  <span class="va">maf</span>,</span>
<span>  <span class="va">pon_ref</span>,</span>
<span>  <span class="va">gender</span>,</span>
<span>  mergeai <span class="op">=</span> <span class="fl">0.15</span>,</span>
<span>  snpmin <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  maxgap <span class="op">=</span> <span class="fl">1e+06</span>,</span>
<span>  snpnum <span class="op">=</span> <span class="fl">20</span>,</span>
<span>  maxbinsize <span class="op">=</span> <span class="fl">1e+06</span>,</span>
<span>  minbinsize <span class="op">=</span> <span class="fl">5e+05</span>,</span>
<span>  minsnpcov <span class="op">=</span> <span class="fl">20</span>,</span>
<span>  segmethod <span class="op">=</span> <span class="st">"cbs"</span>,</span>
<span>  cbssmooth <span class="op">=</span> <span class="st">"no"</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-seg-row">seg_row<a class="anchor" aria-label="anchor" href="#arg-seg-row"></a></dt>
<dd><p>Data frame row (list or tibble row) representing a single segment. Must have columns: Sample, Chromosome, Start, End, Num_Probes, Segment_Mean, Segment_Mean_raw, Count, Baseline_cov, gatk_gender, pipeline_gender, size.</p></dd>


<dt id="arg-maf">maf<a class="anchor" aria-label="anchor" href="#arg-maf"></a></dt>
<dd><p>Data frame or tibble containing MAF data. Must include columns: Chromosome, Pos, maf.</p></dd>


<dt id="arg-pon-ref">pon_ref<a class="anchor" aria-label="anchor" href="#arg-pon-ref"></a></dt>
<dd><p>Data frame. Panel of normal reference for bias correction (required for bias correction step).</p></dd>


<dt id="arg-gender">gender<a class="anchor" aria-label="anchor" href="#arg-gender"></a></dt>
<dd><p>Character. If <code>"female"</code>, the X chromosome will also be proceed.</p></dd>


<dt id="arg-mergeai">mergeai<a class="anchor" aria-label="anchor" href="#arg-mergeai"></a></dt>
<dd><p>Numeric. Threshold for the difference in MAF (gmm_mean) between adjacent segments to allow merging under <code>"merge"</code> mode segmentation.</p></dd>


<dt id="arg-snpmin">snpmin<a class="anchor" aria-label="anchor" href="#arg-snpmin"></a></dt>
<dd><p>Numeric. Minimum SNP count required for a segment to be considered as a separate segment under <code>"merge"</code> mode segmentation.</p></dd>


<dt id="arg-maxgap">maxgap<a class="anchor" aria-label="anchor" href="#arg-maxgap"></a></dt>
<dd><p>Numeric. Maximum allowed gap between SNPs within a bin.</p></dd>


<dt id="arg-snpnum">snpnum<a class="anchor" aria-label="anchor" href="#arg-snpnum"></a></dt>
<dd><p>Integer. Target number of SNPs per bin.</p></dd>


<dt id="arg-maxbinsize">maxbinsize<a class="anchor" aria-label="anchor" href="#arg-maxbinsize"></a></dt>
<dd><p>Numeric. Maximum allowed bin size (bp).</p></dd>


<dt id="arg-minbinsize">minbinsize<a class="anchor" aria-label="anchor" href="#arg-minbinsize"></a></dt>
<dd><p>Numeric. Minimum allowed bin size (bp). The minimum segment size under <code>"merge"</code> mode is 2*minbinsize.</p></dd>


<dt id="arg-minsnpcov">minsnpcov<a class="anchor" aria-label="anchor" href="#arg-minsnpcov"></a></dt>
<dd><p>Integer. Minimum coverage of SNP sites to be included.</p></dd>


<dt id="arg-segmethod">segmethod<a class="anchor" aria-label="anchor" href="#arg-segmethod"></a></dt>
<dd><p>Character. Segmentation method to use: if <code>"merge"</code>, perform stepwise merging; if <code>"cbs"</code>, perform CBS (circular binary segmentation).</p></dd>


<dt id="arg-cbssmooth">cbssmooth<a class="anchor" aria-label="anchor" href="#arg-cbssmooth"></a></dt>
<dd><p>Character. If using the <code>"cbs"</code> segmentation method, set to <code>"yes"</code> to apply smoothing before segmentation, or <code>"no"</code> to skip smoothing.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A data frame with the refined segment(s), including updated breakpoints, MAF metrics, and a <code>BreakpointSource</code> column indicating whether breakpoints were post-processed or from GATK.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The function first bins the MAF data within the segment. If <code>segmethod = "merge"</code>, segments are merged stepwise based on the MAF difference and SNP count. If <code>segmethod = "cbs"</code>, CBS segmentation is performed on the binned MAF values, with optional smoothing. After segmentation, bias correction using the panel of normal can be applied. The function returns refined segments with updated metrics and a <code>BreakpointSource</code> label.</p>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Meiling Jin.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

