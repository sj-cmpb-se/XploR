% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/Modeling.R
\name{SelectFinalModel}
\alias{SelectFinalModel}
\title{Select the Final Copy Number Model and Write Results}
\usage{
SelectFinalModel(
  top_likelihood_rows,
  groupinfo,
  opt,
  model_purity,
  model_source
)
}
\arguments{
\item{top_likelihood_rows}{Data frame or tibble. Top likelihood calls for each segment, including columns \code{mu}, \code{rho}, \code{log_BAF_likelihood}, \code{major}, \code{minor}, \code{Tag}, etc.}

\item{groupinfo}{Data frame or tibble. Information for estimating minimum purity (see \code{\link{EstimateMinPurity}}).}

\item{opt}{List of options, must include \code{modelminAIsize}, \code{minsf}, \code{out_dir}, \code{prefix}.}

\item{model_purity}{Not used directly in this function but included for compatibility.}

\item{model_source}{Character string describing the model source (e.g., "Coverage", "Coverage + BAF").}
}
\value{
A list with:
  \item{Final_model}{The final selected model (see \code{\link{ClusterModels}}).}
  \item{models}{The full model table (before and after refinement).}
}
\description{
Selects the best model (mu, rho) based on total log-likelihood and distance to integer copy number, refines segment calls, and writes results to output files.
}
\details{
- Refines calls and models through several selection and clustering steps.
- Writes the model table and final calls to output files.
}
