% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/Modeling.R
\name{SelectCallpersegment}
\alias{SelectCallpersegment}
\title{Select the Most Likely Call per Segment}
\usage{
SelectCallpersegment(results)
}
\arguments{
\item{results}{A data frame or tibble containing all possible calls for each segment, with columns including:
\code{Segcov}, \code{BAF}, \code{mu}, \code{rho}, \code{index}, \code{major}, \code{minor}, \code{ccf},
\code{BAF_likelihood}, \code{Bio_diff}, \code{baf_ll}, \code{cov_diff}, etc.}
}
\value{
A data frame or tibble with the most likely call per segment, including a \code{log_BAF_likelihood} column.
}
\description{
For each segment, selects the allele combination (major/minor) with the highest BAF likelihood,
with special handling for subclonal events and cases where minor allele is zero.
}
\details{
- Assigns a minimum likelihood for cases where \code{BAF_likelihood} is zero.
- If possible subclonal events are present, compares top two likelihoods and may select the second as a subclonal event.
- For segments where \code{minor == 0}, the call is refined using coverage difference.
}
