% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/runRerun.R
\name{RerunCNV}
\alias{RerunCNV}
\title{Rerun CNV Calling with User-Defined Purity and Size Factor or Diploid Region}
\usage{
RerunCNV(
  seg,
  input,
  models,
  call,
  gender,
  callcov = 0.3,
  dicovsf = NULL,
  purity = NULL,
  chromosome = NULL,
  start = NULL,
  end = NULL,
  mode = NULL,
  out_file
)
}
\arguments{
\item{seg}{Character. Path to the AI segment file (e.g., \code{*_GATK_AI_segment.tsv}).}

\item{input}{Character. Path to the top likelihood row file (e.g., \code{*_top_likelihood_calls.tsv}).}

\item{models}{Character. Path to the model likelihood file (e.g., \code{*_Models_likelihood.tsv}).}

\item{call}{Character. Path to the final call file.}

\item{gender}{Character. Sample gender, either \code{"male"} or \code{"female"}.}

\item{callcov}{Numeric. Subclonal events calling cutoff based on coverage.}

\item{dicovsf}{Numeric or character. Desired scale factor or range (e.g., \code{0.9}, \code{"0.9:1.1"}). Optional.}

\item{purity}{Numeric or character. Desired purity or range (e.g., \code{0.5}, \code{"0.5:0.7"}). Optional.}

\item{chromosome}{Character. Chromosome for diploid region (e.g., \code{"1"}, \code{"X"}). Optional.}

\item{start}{Integer. Start position for diploid region. Optional.}

\item{end}{Integer. End position for diploid region. Optional.}

\item{mode}{Character. Rerun mode: either \code{"model"} or \code{"region"}.}

\item{out_file}{Character. Output file path for the final calls.}
}
\value{
Invisibly returns the final call data frame.
}
\description{
Allows users to rerun copy number variant (CNV) calling with custom purity and scale factor (size factor) values, or by specifying a diploid region for normalization.
}
\details{
When \code{mode = "region"}, \code{chromosome} must be set. If only \code{chromosome} and \code{start} are provided, the region spans from \code{start} to the end of the chromosome. If only \code{chromosome} and \code{end} are provided, the region spans from the start of the chromosome to \code{end}. If both \code{start} and \code{end} are given, the user-defined region is used.

When \code{mode = "model"}, at least one of \code{dicovsf} or \code{purity} must be set. Both can be specified as single values or as ranges (e.g., "0.9:1.1").

This function enables re-calling of CNV segments using user-specified purity and/or size factor (SF), or by defining a diploid region for normalization. It supports both "model" and "region" rerun modes. The resulting calls are written to \code{out_file}.
}
\examples{
\dontrun{
# Rerun using a specific purity and size factor
RerunCNV(
  seg = "sample_GATK_AI_segment.tsv",
  input = "sample_top_likelihood_calls.tsv",
  models = "sample_Models_likelihood.tsv",
  call = "sample_final_call.tsv",
  gender = "female",
  dicovsf = "0.95:1.05",
  purity = "0.6:0.8",
  mode = "model",
  out_file = "sample_final_call_refined.tsv"
)

# Rerun using a user-defined diploid region
RerunCNV(
  seg = "sample_GATK_AI_segment.tsv",
  input = "sample_top_likelihood_calls.tsv",
  models = "sample_Models_likelihood.tsv",
  call = "sample_final_call.tsv",
  gender = "male",
  chromosome = "3",
  start = 1e6,
  end = 5e7,
  mode = "region",
  out_file = "sample_final_call_refined.tsv"
)
}

}
