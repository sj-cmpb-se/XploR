% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/AIponprocess.R
\name{EstimateTheta}
\alias{EstimateTheta}
\title{Estimate Beta-Binomial Over-Dispersion Parameter (Theta)}
\usage{
EstimateTheta(normals_dt, pon_ref, n_bins)
}
\arguments{
\item{normals_dt}{Data frame or tibble. Panel of normal data.}

\item{pon_ref}{Data frame or tibble. Reference PoN data.}

\item{n_bins}{Integer. Number of depth strata to use.}
}
\value{
Returns a list with elements:
\item{theta_table}{Data frame with columns \code{depth_bin} and \code{theta} (per-stratum estimates).}
\item{breaks}{Numeric vector of depth quantile breakpoints.}
}
\description{
Estimates the over-dispersion parameter (\code{theta}) for a beta-binomial model stratified by sequencing depth, using panel of normal (PoN) BAF data.
}
\details{
The function compares observed BAF variance to expected binomial variance across bins and depths, and estimates theta as:
\deqn{\theta = \frac{\mathrm{Var}(p)}{\mathrm{E}[p(1-p)/d]} - 1}{theta = (Var(p) / E[p(1-p)/d] - 1) / (median depth - 1)}
where \eqn{p} is the observed BAF, and \eqn{d} is the median depth.
}
