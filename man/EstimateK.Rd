% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/AIsegmentation.R
\name{EstimateK}
\alias{EstimateK}
\title{Estimate Beta-Binomial K Parameter for Each Segment}
\usage{
EstimateK(result, theta_fit, maf)
}
\arguments{
\item{result}{Data frame. Segment-level results, must include columns \code{Chromosome}, \code{Start}, and \code{End}.}

\item{theta_fit}{List or data frame. Fitted dispersion model, must include \code{breaks} (numeric vector of depth bin edges) and \code{theta_table} (data frame with columns \code{depth_bin} and \code{theta}).}

\item{maf}{Data frame. Allelic count data for all SNPs, must include columns \code{chr}, \code{Pos}, \code{ref_count}, and \code{alt_count}.}
}
\value{
The input \code{result} data frame with additional columns:
\item{depth}{Median SNP depth for the segment.}
\item{depth_bin}{Depth bin index for the segment.}
\item{theta}{Estimated dispersion parameter for the segment.}
\item{K}{Estimated beta-binomial concentration parameter for the segment.}
}
\description{
Calculates the beta-binomial concentration parameter (\code{K}) for each segment based on local sequencing depth and a fitted dispersion model.
}
\details{
For each segment, the function extracts all SNPs within the segment boundaries from the \code{maf} data, calculates the median depth, assigns a depth bin according to \code{theta_fit$breaks}, joins the corresponding theta value from \code{theta_fit$theta_table}, and computes \code{K} using the formula \eqn{K = \frac{\text{depth}}{1 + \text{depth} \cdot \theta} - 1}.
}
