% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/Modeling.R
\name{CalSegmentLikelihood}
\alias{CalSegmentLikelihood}
\title{Calculate Marginal Likelihood for a Single Segment}
\usage{
CalSegmentLikelihood(C_i, B_i, mu, rho, sigma_C, k, lambda, gamma, epsilon)
}
\arguments{
\item{C_i}{Numeric. Integer copy number for the segment.}

\item{B_i}{Numeric. Observed B-allele frequency (BAF) for the segment.}

\item{mu}{Numeric. Mutation multiplicity (percent, e.g., 100 means 100\%).}

\item{rho}{Numeric. Tumor purity (fraction between 0 and 1).}

\item{sigma_C}{Numeric. Not directly used in this function, but included for compatibility.}

\item{k}{Numeric. Beta distribution concentration parameter.}

\item{lambda}{Numeric. Exponential decay parameter for the prior.}

\item{gamma}{Numeric. Weight for the prior in the likelihood calculation.}

\item{epsilon}{Numeric. Small value to avoid log(0) and zero parameters in beta.}
}
\value{
A data frame with all valid (major, minor) combinations and columns:
  \item{major, minor, total_cn, ccf, Bio_diff, prior, expected_baf, baf_ll, weighted_prior, exp_baf_ll, exp_prior, BAF_likelihood, Segcov, BAF, mu, rho}
}
\description{
Computes the marginal likelihood for a segment given copy number, BAF, purity, and model parameters.
Considers all possible major/minor allele combinations for the segment, assigns priors, and computes likelihoods under a beta-binomial model.
}
\details{
The function explores all possible (major, minor) combinations for the given segment, assigns priors based on biological plausibility, and computes the likelihood of observing the segment's BAF under a beta-binomial model.
}
